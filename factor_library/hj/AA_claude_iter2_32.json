{
  "metadata": {
    "created_at": "2026-01-22T23:28:22.496922",
    "last_updated": "2026-01-22T23:28:22.496928",
    "total_factors": 32,
    "version": "1.0",
    "note": "AA_claude iter2, factors 33-64"
  },
  "factors": {
    "7cc35b3405f4f219": {
      "factor_id": "7cc35b3405f4f219",
      "factor_name": "Intraday_Support_Volatility_Filter_5D",
      "factor_expression": "ZSCORE(0 - REGRESI($close, SEQUENCE(5), 5)) / (ZSCORE(TS_STD($close, 5)) + 2.0)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(0 - REGRESI($close, SEQUENCE(5), 5)) / (ZSCORE(TS_STD($close, 5)) + 2.0)\" # Your output factor expression will be filled in here\n    name = \"Intraday_Support_Volatility_Filter_5D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor targets reversal signals by identifying stocks with significant price drops relative to their recent range that also show strong intraday recovery (lower shadow) under low-volatility conditions. It uses Z-score normalization for the residual and standard deviation to ensure cross-sectional comparability.",
      "factor_formulation": "Factor = ZSCORE(-REGRESI(close, SEQUENCE(5), 5)) / (ZSCORE(TS_STD(close, 5)) + 2)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The interaction between price trend deviation (RESI5), intraday support strength (KLOW), and historical volatility (STD5) can predict short-term reversals by identifying exhausted trends with underlying buying pressure.\n                Concise Observation: Price deviations from a linear trend often indicate overextension, while lower shadows represent intraday rejection of lower prices, and low standard deviation suggests the selling pressure is not chaotic but reaching a climax.\n                Concise Justification: Combining trend residuals with candlestick geometry (lower shadows) filters out falling knives by ensuring that intraday buyers are actively supporting the price at the local bottom.\n                Concise Knowledge: If a stock exhibits a significant negative residual from its 5-day trend (RESI5) while simultaneously showing a long lower shadow (KLOW) and low absolute price volatility (STD5), it is likely to experience a short-term price rebound.\n                concise Specification: Calculate the 5-day linear regression residual of the close price, the length of the lower shadow relative to the candle body, and the 5-day standard deviation of close prices to identify high-probability reversal signals.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:11:30.405739"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1759019028641508,
        "ICIR": 0.0236353021600603,
        "1day.excess_return_without_cost.std": 0.004376676578246,
        "1day.excess_return_with_cost.annualized_return": 0.0012708484265691,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002045187049871,
        "1day.excess_return_without_cost.annualized_return": 0.0486754517869527,
        "1day.excess_return_with_cost.std": 0.0043787187001225,
        "Rank IC": 0.0175149917790621,
        "IC": 0.0031928105318175,
        "1day.excess_return_without_cost.max_drawdown": -0.1216413219613064,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7209033733658031,
        "1day.pa": 0.0,
        "l2.valid": 0.996453433465564,
        "Rank ICIR": 0.1291233059927132,
        "l2.train": 0.9929672052970844,
        "1day.excess_return_with_cost.information_ratio": 0.0188130076076706,
        "1day.excess_return_with_cost.mean": 5.339699271299072e-06
      },
      "feedback": {
        "observations": "The current experiment tested three variations of the 'Trend Exhaustion Reversal' hypothesis. While the core concept of combining price deviation (REGRESI) with intraday support (shadows) is theoretically sound, the current implementations failed to surpass the SOTA metrics. The 'Trend_Exhaustion_Reversal_5D' factor using RANK-based interaction and 'Intraday_Support_Volatility_Filter_5D' using Z-score normalization both showed positive IC (0.003193) and annualized returns (0.048675), but they remain inferior to the SOTA Information Ratio (0.972 vs 0.720) and Max Drawdown (-0.072 vs -0.121). The results suggest that the linear combination or simple division of these components may not be capturing the non-linear nature of trend exhaustion effectively.",
        "hypothesis_evaluation": "The hypothesis that interaction between RESI, KLOW, and STD can predict reversals is partially supported by the positive returns, but the current mathematical formulations are likely too noisy. Specifically, using the raw lower shadow length normalized by volatility (TS_STD) or range (MAX(high-low)) might be introducing too much idiosyncratic noise. The 'volatility filter' in the second factor actually diluted the signal compared to the SOTA, suggesting that low volatility might not be a 'filter' but rather a separate regime that needs a different handling logic.",
        "decision": false,
        "reason": "The current factors used a 5-day window for both the regression and the volatility. However, trend exhaustion often happens on a faster scale. By comparing the intraday range (high-low) to the 20-day average range (ATR-like), we can identify 'exhaustion gaps' or 'blow-off bottoms'. Furthermore, replacing the simple RANK multiplication with a conditional logic or a non-linear transformation (like Sigmoid or Tanh) of the residual might better isolate the 'extreme' cases where reversals are most likely to occur, rather than applying a linear rank to the entire cross-section."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "d96d8eeb2da44f1e94be33f6e6a501c6",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/d96d8eeb2da44f1e94be33f6e6a501c6/result.h5"
      }
    },
    "888714788f423420": {
      "factor_id": "888714788f423420",
      "factor_name": "Shadow_Strength_Trend_Deviation_5D",
      "factor_expression": "((MIN($open, $close) - $low) / (MAX($high - $low, 1e-8))) * SIGN(0 - REGRESI($close, SEQUENCE(5), 5))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"((MIN($open, $close) - $low) / (MAX($high - $low, 1e-8))) * SIGN(0 - REGRESI($close, SEQUENCE(5), 5))\" # Your output factor expression will be filled in here\n    name = \"Shadow_Strength_Trend_Deviation_5D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the strength of the lower shadow relative to the daily range, weighted by the degree of downward trend deviation. It captures the 'rejection' of lower prices when the stock is technically overextended to the downside.",
      "factor_formulation": "Factor = (MIN(open, close) - low) / (MAX(high - low, 1e-8)) * SIGN(-REGRESI(close, SEQUENCE(5), 5))",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The interaction between price trend deviation (RESI5), intraday support strength (KLOW), and historical volatility (STD5) can predict short-term reversals by identifying exhausted trends with underlying buying pressure.\n                Concise Observation: Price deviations from a linear trend often indicate overextension, while lower shadows represent intraday rejection of lower prices, and low standard deviation suggests the selling pressure is not chaotic but reaching a climax.\n                Concise Justification: Combining trend residuals with candlestick geometry (lower shadows) filters out falling knives by ensuring that intraday buyers are actively supporting the price at the local bottom.\n                Concise Knowledge: If a stock exhibits a significant negative residual from its 5-day trend (RESI5) while simultaneously showing a long lower shadow (KLOW) and low absolute price volatility (STD5), it is likely to experience a short-term price rebound.\n                concise Specification: Calculate the 5-day linear regression residual of the close price, the length of the lower shadow relative to the candle body, and the 5-day standard deviation of close prices to identify high-probability reversal signals.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:11:30.405739"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1759019028641508,
        "ICIR": 0.0236353021600603,
        "1day.excess_return_without_cost.std": 0.004376676578246,
        "1day.excess_return_with_cost.annualized_return": 0.0012708484265691,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002045187049871,
        "1day.excess_return_without_cost.annualized_return": 0.0486754517869527,
        "1day.excess_return_with_cost.std": 0.0043787187001225,
        "Rank IC": 0.0175149917790621,
        "IC": 0.0031928105318175,
        "1day.excess_return_without_cost.max_drawdown": -0.1216413219613064,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7209033733658031,
        "1day.pa": 0.0,
        "l2.valid": 0.996453433465564,
        "Rank ICIR": 0.1291233059927132,
        "l2.train": 0.9929672052970844,
        "1day.excess_return_with_cost.information_ratio": 0.0188130076076706,
        "1day.excess_return_with_cost.mean": 5.339699271299072e-06
      },
      "feedback": {
        "observations": "The current experiment tested three variations of the 'Trend Exhaustion Reversal' hypothesis. While the core concept of combining price deviation (REGRESI) with intraday support (shadows) is theoretically sound, the current implementations failed to surpass the SOTA metrics. The 'Trend_Exhaustion_Reversal_5D' factor using RANK-based interaction and 'Intraday_Support_Volatility_Filter_5D' using Z-score normalization both showed positive IC (0.003193) and annualized returns (0.048675), but they remain inferior to the SOTA Information Ratio (0.972 vs 0.720) and Max Drawdown (-0.072 vs -0.121). The results suggest that the linear combination or simple division of these components may not be capturing the non-linear nature of trend exhaustion effectively.",
        "hypothesis_evaluation": "The hypothesis that interaction between RESI, KLOW, and STD can predict reversals is partially supported by the positive returns, but the current mathematical formulations are likely too noisy. Specifically, using the raw lower shadow length normalized by volatility (TS_STD) or range (MAX(high-low)) might be introducing too much idiosyncratic noise. The 'volatility filter' in the second factor actually diluted the signal compared to the SOTA, suggesting that low volatility might not be a 'filter' but rather a separate regime that needs a different handling logic.",
        "decision": false,
        "reason": "The current factors used a 5-day window for both the regression and the volatility. However, trend exhaustion often happens on a faster scale. By comparing the intraday range (high-low) to the 20-day average range (ATR-like), we can identify 'exhaustion gaps' or 'blow-off bottoms'. Furthermore, replacing the simple RANK multiplication with a conditional logic or a non-linear transformation (like Sigmoid or Tanh) of the residual might better isolate the 'extreme' cases where reversals are most likely to occur, rather than applying a linear rank to the entire cross-section."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "a9c89630399d4f71b293c8589556c367",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/a9c89630399d4f71b293c8589556c367/result.h5"
      }
    },
    "6dfe7b199efa3eb6": {
      "factor_id": "6dfe7b199efa3eb6",
      "factor_name": "Composite_Trend_Liquidity_Factor",
      "factor_expression": "RANK(DELAY($close, 60) / ($close + 1e-8)) * RANK(TS_CORR($close, LOG($volume + 1), 20)) * RANK(1 / (TS_STD($volume, 5) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK($close / (DELAY($close, 60) + 1e-9)) * RANK(TS_CORR($close, LOG($volume + 1e-9), 20)) * RANK(INV(TS_STD($volume, 5) + 1e-9))\" # Your output factor expression will be filled in here\n    name = \"Composite_Trend_Liquidity_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor combines long-term price momentum (ROC60), price-volume correlation (20 days), and the inverse of short-term volume volatility (5 days). It identifies stocks where a long-term trend is supported by consistent liquidity and positive price-volume confirmation, filtering out erratic speculative spikes.",
      "factor_formulation": "\\text{RANK}(\\frac{\\text{close}_{t-60}}{\\text{close}_t}) \\times \\text{RANK}(\\text{TS_CORR}(\\text{close}, \\text{LOG}(\\text{volume} + 1), 20)) \\times \\text{RANK}(\\frac{1}{\\text{TS_STD}(\\text{volume}, 5)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A composite factor combining long-term price momentum (ROC60), price-volume correlation (CORR20), and short-term volume volatility (VSTD5) can effectively predict asset returns by identifying stocks with stable liquidity and significant trend reversals.\n                Concise Observation: Market participants often react to long-term price trends, but the reliability of these trends is heavily influenced by the underlying volume structure and the consistency of liquidity as measured by volume standard deviation.\n                Concise Justification: ROC60 captures the mean-reversion potential of oversold assets, CORR20 identifies whether price movements are supported by volume (liquidity confirmation), and VSTD5 filters for assets with steady institutional interest rather than erratic speculative spikes.\n                Concise Knowledge: If a stock exhibits a low 60-day price ratio (long-term decline) combined with a positive price-volume correlation and low volume volatility, it is more likely to experience a mean-reverting recovery; conversely, high volume volatility suggests unstable capital flows.\n                concise Specification: The factor is defined as the product of ROC60 (Price_t-60 / Price_t), the 20-day correlation between Close and Log(Volume+1), and the inverse of the 5-day Volume Standard Deviation, applied cross-sectionally.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:15:12.186373"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1738291410528238,
        "ICIR": 0.0332235529304159,
        "1day.excess_return_without_cost.std": 0.0050952451490776,
        "1day.excess_return_with_cost.annualized_return": 0.0079247219321142,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.000233449136343,
        "1day.excess_return_without_cost.annualized_return": 0.0555608944496491,
        "1day.excess_return_with_cost.std": 0.0050972896486133,
        "Rank IC": 0.0226566225829021,
        "IC": 0.0050509790134663,
        "1day.excess_return_without_cost.max_drawdown": -0.124708977803598,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7068311261268861,
        "1day.pa": 0.0,
        "l2.valid": 0.9968939749013248,
        "Rank ICIR": 0.1522691582364969,
        "l2.train": 0.9941969362853708,
        "1day.excess_return_with_cost.information_ratio": 0.1007757969160998,
        "1day.excess_return_with_cost.mean": 3.329715097526994e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of a composite factor combining long-term price momentum, price-volume correlation, and volume volatility. The 'Current Result' (representing the best of the newly implemented factors) achieved a higher annualized return (0.055561 vs 0.052010) compared to the SOTA, but showed a significant deterioration in the Information Ratio (0.706831 vs 0.972561) and Max Drawdown (-0.124709 vs -0.072585). The IC also slightly decreased. This suggests that while the current implementation captures higher raw alpha, it does so with significantly higher volatility and risk, likely due to the aggressive nature of the 'Volume_Confirmed_Reversal_Filter' or the multiplicative structure of the 'Composite_Trend_Liquidity_Factor'.",
        "hypothesis_evaluation": "The hypothesis that combining long-term momentum with price-volume correlation and volume stability can predict returns is supported by the improvement in annualized return. However, the current implementation lacks robustness, as evidenced by the high drawdown and lower Information Ratio. The 'reversal' aspect (using close_t-60 / close_t) seems to introduce significant noise. The transition from rank-based multiplication to Z-score addition in 'Stable_Recovery_Momentum_Z' was a step toward better risk control, but still hasn't surpassed the SOTA's risk-adjusted performance.",
        "decision": true,
        "reason": "The current factors use TS_STD(volume, 5), which might be too sensitive to short-term noise. Replacing this with a ratio of short-term volume to long-term average volume (e.g., volume_5d / volume_20d) can better identify 'quiet' accumulation versus 'erratic' spikes. Furthermore, using a divergence measure (e.g., the difference between price rank and volume rank) rather than correlation may more accurately capture the 'confirmation' logic while maintaining a lower symbol length and fewer free parameters, addressing potential complexity issues before they arise."
      },
      "cache_location": null
    },
    "286c951a5871771a": {
      "factor_id": "286c951a5871771a",
      "factor_name": "Stable_Recovery_Momentum_Z",
      "factor_expression": "ZSCORE(TS_PCTCHANGE($close, 60)) + ZSCORE(TS_CORR($close, $volume, 20)) - ZSCORE(TS_STD($volume, 5))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_PCTCHANGE($close, 60)) + ZSCORE(TS_CORR($close, $volume, 20)) - ZSCORE(TS_STD($volume, 5))\" # Your output factor expression will be filled in here\n    name = \"Stable_Recovery_Momentum_Z\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A cross-sectionally standardized version of the trend-liquidity hypothesis. It targets mean-reversion by focusing on assets with low price ratios (oversold), high price-volume alignment, and low volume noise to ensure the recovery is driven by steady institutional accumulation.",
      "factor_formulation": "\\text{ZSCORE}(\\text{TS_PCTCHANGE}(\\text{close}, 60)) + \\text{ZSCORE}(\\text{TS_CORR}(\\text{close}, \\text{volume}, 20)) - \\text{ZSCORE}(\\text{TS_STD}(\\text{volume}, 5))",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A composite factor combining long-term price momentum (ROC60), price-volume correlation (CORR20), and short-term volume volatility (VSTD5) can effectively predict asset returns by identifying stocks with stable liquidity and significant trend reversals.\n                Concise Observation: Market participants often react to long-term price trends, but the reliability of these trends is heavily influenced by the underlying volume structure and the consistency of liquidity as measured by volume standard deviation.\n                Concise Justification: ROC60 captures the mean-reversion potential of oversold assets, CORR20 identifies whether price movements are supported by volume (liquidity confirmation), and VSTD5 filters for assets with steady institutional interest rather than erratic speculative spikes.\n                Concise Knowledge: If a stock exhibits a low 60-day price ratio (long-term decline) combined with a positive price-volume correlation and low volume volatility, it is more likely to experience a mean-reverting recovery; conversely, high volume volatility suggests unstable capital flows.\n                concise Specification: The factor is defined as the product of ROC60 (Price_t-60 / Price_t), the 20-day correlation between Close and Log(Volume+1), and the inverse of the 5-day Volume Standard Deviation, applied cross-sectionally.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:15:12.186373"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1738291410528238,
        "ICIR": 0.0332235529304159,
        "1day.excess_return_without_cost.std": 0.0050952451490776,
        "1day.excess_return_with_cost.annualized_return": 0.0079247219321142,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.000233449136343,
        "1day.excess_return_without_cost.annualized_return": 0.0555608944496491,
        "1day.excess_return_with_cost.std": 0.0050972896486133,
        "Rank IC": 0.0226566225829021,
        "IC": 0.0050509790134663,
        "1day.excess_return_without_cost.max_drawdown": -0.124708977803598,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7068311261268861,
        "1day.pa": 0.0,
        "l2.valid": 0.9968939749013248,
        "Rank ICIR": 0.1522691582364969,
        "l2.train": 0.9941969362853708,
        "1day.excess_return_with_cost.information_ratio": 0.1007757969160998,
        "1day.excess_return_with_cost.mean": 3.329715097526994e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of a composite factor combining long-term price momentum, price-volume correlation, and volume volatility. The 'Current Result' (representing the best of the newly implemented factors) achieved a higher annualized return (0.055561 vs 0.052010) compared to the SOTA, but showed a significant deterioration in the Information Ratio (0.706831 vs 0.972561) and Max Drawdown (-0.124709 vs -0.072585). The IC also slightly decreased. This suggests that while the current implementation captures higher raw alpha, it does so with significantly higher volatility and risk, likely due to the aggressive nature of the 'Volume_Confirmed_Reversal_Filter' or the multiplicative structure of the 'Composite_Trend_Liquidity_Factor'.",
        "hypothesis_evaluation": "The hypothesis that combining long-term momentum with price-volume correlation and volume stability can predict returns is supported by the improvement in annualized return. However, the current implementation lacks robustness, as evidenced by the high drawdown and lower Information Ratio. The 'reversal' aspect (using close_t-60 / close_t) seems to introduce significant noise. The transition from rank-based multiplication to Z-score addition in 'Stable_Recovery_Momentum_Z' was a step toward better risk control, but still hasn't surpassed the SOTA's risk-adjusted performance.",
        "decision": true,
        "reason": "The current factors use TS_STD(volume, 5), which might be too sensitive to short-term noise. Replacing this with a ratio of short-term volume to long-term average volume (e.g., volume_5d / volume_20d) can better identify 'quiet' accumulation versus 'erratic' spikes. Furthermore, using a divergence measure (e.g., the difference between price rank and volume rank) rather than correlation may more accurately capture the 'confirmation' logic while maintaining a lower symbol length and fewer free parameters, addressing potential complexity issues before they arise."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "57f13467e2864d1096c71715079442a9",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/57f13467e2864d1096c71715079442a9/result.h5"
      }
    },
    "b31beef46e249e8b": {
      "factor_id": "b31beef46e249e8b",
      "factor_name": "Volume_Confirmed_Reversal_Filter",
      "factor_expression": "(DELAY($close, 60) / ($close + 1e-8)) * TS_CORR($close, $volume, 20) / (1 + TS_RANK(TS_STD($volume, 5), 20))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(DELAY($close, 60) / ($close + 1e-8)) * TS_CORR($close, $volume, 20) / (1 + TS_RANK(TS_STD($volume, 5), 20))\" # Your output factor expression will be filled in here\n    name = \"Volume_Confirmed_Reversal_Filter\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor specifically identifies potential trend reversals by multiplying the 60-day price decline magnitude with the 20-day price-volume correlation, scaled by the inverse of volume volatility. It uses TS_RANK for the volume volatility component to normalize the liquidity stability across different stocks.",
      "factor_formulation": "\\frac{(\\text{close}_{t-60} / \\text{close}_t) \\times \\text{TS_CORR}(\\text{close}, \\text{volume}, 20)}{1 + \\text{TS_RANK}(\\text{TS_STD}(\\text{volume}, 5), 20)}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A composite factor combining long-term price momentum (ROC60), price-volume correlation (CORR20), and short-term volume volatility (VSTD5) can effectively predict asset returns by identifying stocks with stable liquidity and significant trend reversals.\n                Concise Observation: Market participants often react to long-term price trends, but the reliability of these trends is heavily influenced by the underlying volume structure and the consistency of liquidity as measured by volume standard deviation.\n                Concise Justification: ROC60 captures the mean-reversion potential of oversold assets, CORR20 identifies whether price movements are supported by volume (liquidity confirmation), and VSTD5 filters for assets with steady institutional interest rather than erratic speculative spikes.\n                Concise Knowledge: If a stock exhibits a low 60-day price ratio (long-term decline) combined with a positive price-volume correlation and low volume volatility, it is more likely to experience a mean-reverting recovery; conversely, high volume volatility suggests unstable capital flows.\n                concise Specification: The factor is defined as the product of ROC60 (Price_t-60 / Price_t), the 20-day correlation between Close and Log(Volume+1), and the inverse of the 5-day Volume Standard Deviation, applied cross-sectionally.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:15:12.186373"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1738291410528238,
        "ICIR": 0.0332235529304159,
        "1day.excess_return_without_cost.std": 0.0050952451490776,
        "1day.excess_return_with_cost.annualized_return": 0.0079247219321142,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.000233449136343,
        "1day.excess_return_without_cost.annualized_return": 0.0555608944496491,
        "1day.excess_return_with_cost.std": 0.0050972896486133,
        "Rank IC": 0.0226566225829021,
        "IC": 0.0050509790134663,
        "1day.excess_return_without_cost.max_drawdown": -0.124708977803598,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7068311261268861,
        "1day.pa": 0.0,
        "l2.valid": 0.9968939749013248,
        "Rank ICIR": 0.1522691582364969,
        "l2.train": 0.9941969362853708,
        "1day.excess_return_with_cost.information_ratio": 0.1007757969160998,
        "1day.excess_return_with_cost.mean": 3.329715097526994e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of a composite factor combining long-term price momentum, price-volume correlation, and volume volatility. The 'Current Result' (representing the best of the newly implemented factors) achieved a higher annualized return (0.055561 vs 0.052010) compared to the SOTA, but showed a significant deterioration in the Information Ratio (0.706831 vs 0.972561) and Max Drawdown (-0.124709 vs -0.072585). The IC also slightly decreased. This suggests that while the current implementation captures higher raw alpha, it does so with significantly higher volatility and risk, likely due to the aggressive nature of the 'Volume_Confirmed_Reversal_Filter' or the multiplicative structure of the 'Composite_Trend_Liquidity_Factor'.",
        "hypothesis_evaluation": "The hypothesis that combining long-term momentum with price-volume correlation and volume stability can predict returns is supported by the improvement in annualized return. However, the current implementation lacks robustness, as evidenced by the high drawdown and lower Information Ratio. The 'reversal' aspect (using close_t-60 / close_t) seems to introduce significant noise. The transition from rank-based multiplication to Z-score addition in 'Stable_Recovery_Momentum_Z' was a step toward better risk control, but still hasn't surpassed the SOTA's risk-adjusted performance.",
        "decision": true,
        "reason": "The current factors use TS_STD(volume, 5), which might be too sensitive to short-term noise. Replacing this with a ratio of short-term volume to long-term average volume (e.g., volume_5d / volume_20d) can better identify 'quiet' accumulation versus 'erratic' spikes. Furthermore, using a divergence measure (e.g., the difference between price rank and volume rank) rather than correlation may more accurately capture the 'confirmation' logic while maintaining a lower symbol length and fewer free parameters, addressing potential complexity issues before they arise."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "17e4b9d650d5494ab18ceecc94691222",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/17e4b9d650d5494ab18ceecc94691222/result.h5"
      }
    },
    "bc2718d6e4e4982b": {
      "factor_id": "bc2718d6e4e4982b",
      "factor_name": "Liquidity_Grab_Reversal_3D",
      "factor_expression": "-1 * REGRESI($close, SEQUENCE(3), 3) * ((MIN($open, $close) - $low) / (TS_MEAN($high - $low, 10) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"-1 * REGRESI($close, SEQUENCE(3), 3) * ((MIN($open, $close) - $low) / (TS_MEAN($high - $low, 10) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Grab_Reversal_3D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies short-term price reversals by detecting 'liquidity grabs' where the lower shadow is exceptionally large relative to the 10-day average intraday range, conditioned on a sharp 3-day negative price deviation (regression residual).",
      "factor_formulation": "LGR = -REGRESI(close, SEQUENCE(3), 3) \\times \\frac{\\min(open, close) - low}{TS\\_MEAN(high - low, 10)}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term price reversals are most effectively captured by identifying 'Intraday Liquidity Grabs' where the lower shadow length significantly exceeds the 10-day average intraday range, conditioned on a sharp 3-day negative price deviation.\n                Concise Observation: Previous 5-day windows for regression and volatility were too slow to capture rapid exhaustion, and linear RANK combinations failed to isolate the extreme 'blow-off' events that drive high-conviction reversals.\n                Concise Justification: Normalizing the lower shadow by a longer-term (10-day) average range (ATR-like) provides a more stable 'volatility-adjusted' signal of price rejection, while shortening the regression window to 3 days focuses on the immediate momentum collapse.\n                Concise Knowledge: If a stock's intraday price rejection (lower shadow) is exceptionally large relative to its historical average range (ATR), it indicates a liquidity grab; when this occurs following a short-term trend exhaustion (3-day residual), the probability of a sharp reversal increases.\n                concise Specification: Calculate the 3-day linear regression residual of close prices (RESI3); calculate the lower shadow (min(open, close) - low) and normalize it by the 10-day average of (high - low); the factor is the product of the negative RESI3 and the normalized shadow.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:17:06.944713"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1613232959917939,
        "ICIR": 0.011622124438239,
        "1day.excess_return_without_cost.std": 0.0041718251225816,
        "1day.excess_return_with_cost.annualized_return": -0.0038123491354997,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001824484550188,
        "1day.excess_return_without_cost.annualized_return": 0.0434227322944835,
        "1day.excess_return_with_cost.std": 0.0041737404935396,
        "Rank IC": 0.0163443390783264,
        "IC": 0.0015928456780813,
        "1day.excess_return_without_cost.max_drawdown": -0.1074675413743412,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6746873594422088,
        "1day.pa": 0.0,
        "l2.valid": 0.9964062393180816,
        "Rank ICIR": 0.1182547566213726,
        "l2.train": 0.9940329841730474,
        "1day.excess_return_with_cost.information_ratio": -0.0592077755897106,
        "1day.excess_return_with_cost.mean": -1.6018273678570537e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Intraday Liquidity Grab' hypothesis, focusing on the interaction between a 3-day negative price deviation (regression residual) and the relative size of the lower shadow. While the logic is sound, the performance metrics (IC: 0.0016, IR: 0.675) are significantly lower than the SOTA (IC: 0.0058, IR: 0.973). The 'Exhaustion_Shadow_ZScore_10D' using cross-sectional ranking was the most robust implementation among the three, but it still failed to capture the signal effectively compared to the previous SOTA approach.",
        "hypothesis_evaluation": "The hypothesis that short-term reversals are captured by the interaction of price residuals and lower shadows is partially supported but lacks sufficient predictive power in its current form. The low IC suggests that the 'Liquidity Grab' signal might be too sparse or noisy when normalized by a simple 10-day average range. The linear multiplication of the residual and the shadow length might be creating extreme outliers that degrade the model's performance.",
        "decision": false,
        "reason": "The current factors rely solely on price action (shadows and residuals). Adding a volume component will help distinguish between a 'passive' price drop and an 'active' liquidity grab where high-volume buying pressure creates the lower shadow. Furthermore, using ATR (Average True Range) for normalization instead of a simple high-low range provides a more robust volatility measure, and adding an RSI filter ensures the signal is only active during true exhaustion phases, reducing false positives."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "1180a3872e444725b5be86c5ad7bae42",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/1180a3872e444725b5be86c5ad7bae42/result.h5"
      }
    },
    "0d625cfc112df6ff": {
      "factor_id": "0d625cfc112df6ff",
      "factor_name": "Exhaustion_Shadow_ZScore_10D",
      "factor_expression": "RANK(-1 * REGRESI($close, SEQUENCE(3), 3)) * RANK((MIN($open, $close) - $low) / (TS_MEAN($high - $low, 10) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(-1 * REGRESI($close, SEQUENCE(3), 3)) * RANK((MIN($open, $close) - $low) / (TS_MEAN($high - $low, 10) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Exhaustion_Shadow_ZScore_10D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "Focuses on identifying extreme price rejection events by cross-sectionally ranking the interaction between the 3-day price momentum collapse and the volatility-normalized lower shadow. It uses the 10-day average range to stabilize the intraday signal.",
      "factor_formulation": "ESZ = RANK(-REGRESI(close, SEQUENCE(3), 3)) \\times RANK(\\frac{MIN(open, close) - low}{TS\\_MEAN(high - low, 10)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term price reversals are most effectively captured by identifying 'Intraday Liquidity Grabs' where the lower shadow length significantly exceeds the 10-day average intraday range, conditioned on a sharp 3-day negative price deviation.\n                Concise Observation: Previous 5-day windows for regression and volatility were too slow to capture rapid exhaustion, and linear RANK combinations failed to isolate the extreme 'blow-off' events that drive high-conviction reversals.\n                Concise Justification: Normalizing the lower shadow by a longer-term (10-day) average range (ATR-like) provides a more stable 'volatility-adjusted' signal of price rejection, while shortening the regression window to 3 days focuses on the immediate momentum collapse.\n                Concise Knowledge: If a stock's intraday price rejection (lower shadow) is exceptionally large relative to its historical average range (ATR), it indicates a liquidity grab; when this occurs following a short-term trend exhaustion (3-day residual), the probability of a sharp reversal increases.\n                concise Specification: Calculate the 3-day linear regression residual of close prices (RESI3); calculate the lower shadow (min(open, close) - low) and normalize it by the 10-day average of (high - low); the factor is the product of the negative RESI3 and the normalized shadow.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:17:06.944713"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1613232959917939,
        "ICIR": 0.011622124438239,
        "1day.excess_return_without_cost.std": 0.0041718251225816,
        "1day.excess_return_with_cost.annualized_return": -0.0038123491354997,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001824484550188,
        "1day.excess_return_without_cost.annualized_return": 0.0434227322944835,
        "1day.excess_return_with_cost.std": 0.0041737404935396,
        "Rank IC": 0.0163443390783264,
        "IC": 0.0015928456780813,
        "1day.excess_return_without_cost.max_drawdown": -0.1074675413743412,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6746873594422088,
        "1day.pa": 0.0,
        "l2.valid": 0.9964062393180816,
        "Rank ICIR": 0.1182547566213726,
        "l2.train": 0.9940329841730474,
        "1day.excess_return_with_cost.information_ratio": -0.0592077755897106,
        "1day.excess_return_with_cost.mean": -1.6018273678570537e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Intraday Liquidity Grab' hypothesis, focusing on the interaction between a 3-day negative price deviation (regression residual) and the relative size of the lower shadow. While the logic is sound, the performance metrics (IC: 0.0016, IR: 0.675) are significantly lower than the SOTA (IC: 0.0058, IR: 0.973). The 'Exhaustion_Shadow_ZScore_10D' using cross-sectional ranking was the most robust implementation among the three, but it still failed to capture the signal effectively compared to the previous SOTA approach.",
        "hypothesis_evaluation": "The hypothesis that short-term reversals are captured by the interaction of price residuals and lower shadows is partially supported but lacks sufficient predictive power in its current form. The low IC suggests that the 'Liquidity Grab' signal might be too sparse or noisy when normalized by a simple 10-day average range. The linear multiplication of the residual and the shadow length might be creating extreme outliers that degrade the model's performance.",
        "decision": false,
        "reason": "The current factors rely solely on price action (shadows and residuals). Adding a volume component will help distinguish between a 'passive' price drop and an 'active' liquidity grab where high-volume buying pressure creates the lower shadow. Furthermore, using ATR (Average True Range) for normalization instead of a simple high-low range provides a more robust volatility measure, and adding an RSI filter ensures the signal is only active during true exhaustion phases, reducing false positives."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "e409d916c2cb4f8b98f8374d42b2ef32",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/e409d916c2cb4f8b98f8374d42b2ef32/result.h5"
      }
    },
    "a52ff15e32ecf279": {
      "factor_id": "a52ff15e32ecf279",
      "factor_name": "Blowoff_Bottom_Intensity",
      "factor_expression": "(-1 * REGRESI($close, SEQUENCE(3), 3) * (MIN($open, $close) - $low)) / (TS_MEAN($high - $low, 10) + 1e-8)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(-1 * REGRESI($close, SEQUENCE(3), 3) * (MIN($open, $close) - $low)) / (TS_MEAN($high - $low, 10) + 1e-8)\" # Your output factor expression will be filled in here\n    name = \"Blowoff_Bottom_Intensity\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "Measures the intensity of a blow-off bottom by combining the 3-day price residual with the lower shadow magnitude, normalized by the 10-day historical range. It specifically targets the most extreme negative residuals.",
      "factor_formulation": "BBI = \\frac{-REGRESI(close, SEQUENCE(3), 3) \\times (MIN(open, close) - low)}{(TS\\_MEAN(high - low, 10) + 1e-8)}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term price reversals are most effectively captured by identifying 'Intraday Liquidity Grabs' where the lower shadow length significantly exceeds the 10-day average intraday range, conditioned on a sharp 3-day negative price deviation.\n                Concise Observation: Previous 5-day windows for regression and volatility were too slow to capture rapid exhaustion, and linear RANK combinations failed to isolate the extreme 'blow-off' events that drive high-conviction reversals.\n                Concise Justification: Normalizing the lower shadow by a longer-term (10-day) average range (ATR-like) provides a more stable 'volatility-adjusted' signal of price rejection, while shortening the regression window to 3 days focuses on the immediate momentum collapse.\n                Concise Knowledge: If a stock's intraday price rejection (lower shadow) is exceptionally large relative to its historical average range (ATR), it indicates a liquidity grab; when this occurs following a short-term trend exhaustion (3-day residual), the probability of a sharp reversal increases.\n                concise Specification: Calculate the 3-day linear regression residual of close prices (RESI3); calculate the lower shadow (min(open, close) - low) and normalize it by the 10-day average of (high - low); the factor is the product of the negative RESI3 and the normalized shadow.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:17:06.944713"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1613232959917939,
        "ICIR": 0.011622124438239,
        "1day.excess_return_without_cost.std": 0.0041718251225816,
        "1day.excess_return_with_cost.annualized_return": -0.0038123491354997,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001824484550188,
        "1day.excess_return_without_cost.annualized_return": 0.0434227322944835,
        "1day.excess_return_with_cost.std": 0.0041737404935396,
        "Rank IC": 0.0163443390783264,
        "IC": 0.0015928456780813,
        "1day.excess_return_without_cost.max_drawdown": -0.1074675413743412,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6746873594422088,
        "1day.pa": 0.0,
        "l2.valid": 0.9964062393180816,
        "Rank ICIR": 0.1182547566213726,
        "l2.train": 0.9940329841730474,
        "1day.excess_return_with_cost.information_ratio": -0.0592077755897106,
        "1day.excess_return_with_cost.mean": -1.6018273678570537e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Intraday Liquidity Grab' hypothesis, focusing on the interaction between a 3-day negative price deviation (regression residual) and the relative size of the lower shadow. While the logic is sound, the performance metrics (IC: 0.0016, IR: 0.675) are significantly lower than the SOTA (IC: 0.0058, IR: 0.973). The 'Exhaustion_Shadow_ZScore_10D' using cross-sectional ranking was the most robust implementation among the three, but it still failed to capture the signal effectively compared to the previous SOTA approach.",
        "hypothesis_evaluation": "The hypothesis that short-term reversals are captured by the interaction of price residuals and lower shadows is partially supported but lacks sufficient predictive power in its current form. The low IC suggests that the 'Liquidity Grab' signal might be too sparse or noisy when normalized by a simple 10-day average range. The linear multiplication of the residual and the shadow length might be creating extreme outliers that degrade the model's performance.",
        "decision": false,
        "reason": "The current factors rely solely on price action (shadows and residuals). Adding a volume component will help distinguish between a 'passive' price drop and an 'active' liquidity grab where high-volume buying pressure creates the lower shadow. Furthermore, using ATR (Average True Range) for normalization instead of a simple high-low range provides a more robust volatility measure, and adding an RSI filter ensures the signal is only active during true exhaustion phases, reducing false positives."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "1f3a23c7f0f64e0ebd4091c848da43fd",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/1f3a23c7f0f64e0ebd4091c848da43fd/result.h5"
      }
    },
    "ddcc5c3f8e2d06e5": {
      "factor_id": "ddcc5c3f8e2d06e5",
      "factor_name": "PV_Rank_Divergence_Surge_20D",
      "factor_expression": "(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_PCTCHANGE($volume, 20))) * (TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_PCTCHANGE($volume, 20))) * (TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"PV_Rank_Divergence_Surge_20D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies trend quality by calculating the cross-sectional rank divergence between 20-day price returns and 20-day volume growth, scaled by a volume surge ratio (5-day vs 20-day average). A positive divergence suggests price strength is leading volume growth, while the surge ratio filters for sustainable liquidity expansion.",
      "factor_formulation": "\\text{Factor} = (\\text{RANK}(\\text{TS\\_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS\\_PCTCHANGE}(\\text{volume}, 20))) \\times \\frac{\\text{TS\\_MEAN}(\\text{volume}, 5)}{\\text{TS\\_MEAN}(\\text{volume}, 20)}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor combining a 20-day price-volume rank divergence with a 5-day/20-day volume surge ratio can identify high-quality trend shifts while minimizing noise-induced volatility.\n                Concise Observation: Previous attempts using raw volume volatility and simple correlation led to high drawdowns, suggesting that linear correlation is too noisy and short-term standard deviation is too sensitive to outliers.\n                Concise Justification: Rank divergence acts as a robust, non-linear confirmation of price-volume dynamics, while the volume surge ratio (V5/V20) normalizes liquidity spikes against the asset's own baseline to filter for sustainable momentum.\n                Concise Knowledge: If price rank significantly leads volume rank (divergence), it indicates potential exhaustion; when combined with a controlled volume surge ratio, it distinguishes healthy trend initiation from speculative spikes.\n                concise Specification: The factor is defined as the difference between the cross-sectional rank of 20-day close price returns and the cross-sectional rank of 20-day volume returns, multiplied by the ratio of the 5-day moving average volume to the 20-day moving average volume.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:18:04.399461"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1214261073922489,
        "ICIR": 0.0401209224507838,
        "1day.excess_return_without_cost.std": 0.0044144067559674,
        "1day.excess_return_with_cost.annualized_return": 0.0064909772798177,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002252539816941,
        "1day.excess_return_without_cost.annualized_return": 0.0536104476432006,
        "1day.excess_return_with_cost.std": 0.0044149463392098,
        "Rank IC": 0.0208219133592493,
        "IC": 0.0056106100415451,
        "1day.excess_return_without_cost.max_drawdown": -0.113875208971601,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7872063836583528,
        "1day.pa": 0.0,
        "l2.valid": 0.9966244114324097,
        "Rank ICIR": 0.1533980178010795,
        "l2.train": 0.9946391446228384,
        "1day.excess_return_with_cost.information_ratio": 0.0953007198502745,
        "1day.excess_return_with_cost.mean": 2.727301378074685e-05
      },
      "feedback": {
        "observations": "The experiment compared two implementations of the price-volume rank divergence hypothesis. The 'Robust_Trend_Confirmation_Factor' (Current Result) introduced Z-score normalization and a clipping mechanism (MIN function) for the volume surge ratio to cap the influence of extreme volume spikes. The results show a significant improvement in the Information Ratio (from 0.707 to 0.787) and IC (from 0.0051 to 0.0056), alongside a reduction in Max Drawdown (-0.114 vs -0.125). Although the Annualized Return saw a marginal decrease (0.0536 vs 0.0556), the risk-adjusted performance and predictive consistency (IC) are notably superior.",
        "hypothesis_evaluation": "The results strongly support the hypothesis that combining price-volume rank divergence with a surge ratio identifies high-quality trends. The inclusion of a 'capping' mechanism (MIN(ratio, 2.0)) in the current iteration suggests that while volume surges are informative, extreme outliers can introduce noise, and limiting their weight improves factor stability and risk-adjusted returns.",
        "decision": true,
        "reason": "The current 'TS_PCTCHANGE(volume, 20)' can be highly volatile for stocks with low baseline liquidity. By replacing volume percentage change with a standardized volume measure (e.g., Z-score of volume or Rank of average volume), we can more accurately identify where price momentum is backed by significant relative capital commitment, further improving the Information Ratio and reducing drawdown."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "b060e3e9948949d8bd0f08beb3e1f7dd",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/b060e3e9948949d8bd0f08beb3e1f7dd/result.h5"
      }
    },
    "40e38712dda97c33": {
      "factor_id": "40e38712dda97c33",
      "factor_name": "Robust_Trend_Confirmation_Factor",
      "factor_expression": "ZSCORE(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_PCTCHANGE($volume, 20))) * MIN(TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8), 2.0)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_PCTCHANGE($volume, 20))) * MIN(TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8), 2.0)\" # Your output factor expression will be filled in here\n    name = \"Robust_Trend_Confirmation_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures the interaction between price momentum and volume stability. It uses the difference between price return rank and volume return rank to detect exhaustion or confirmation, smoothed by the ratio of short-term to long-term volume to avoid noise from erratic spikes.",
      "factor_formulation": "\\text{Factor} = \\text{ZSCORE}(\\text{RANK}(\\text{TS\\_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS\\_PCTCHANGE}(\\text{volume}, 20))) \\times \\text{MIN}(\\frac{\\text{TS\\_MEAN}(\\text{volume}, 5)}{\\text{TS\\_MEAN}(\\text{volume}, 20)}, 2.0)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor combining a 20-day price-volume rank divergence with a 5-day/20-day volume surge ratio can identify high-quality trend shifts while minimizing noise-induced volatility.\n                Concise Observation: Previous attempts using raw volume volatility and simple correlation led to high drawdowns, suggesting that linear correlation is too noisy and short-term standard deviation is too sensitive to outliers.\n                Concise Justification: Rank divergence acts as a robust, non-linear confirmation of price-volume dynamics, while the volume surge ratio (V5/V20) normalizes liquidity spikes against the asset's own baseline to filter for sustainable momentum.\n                Concise Knowledge: If price rank significantly leads volume rank (divergence), it indicates potential exhaustion; when combined with a controlled volume surge ratio, it distinguishes healthy trend initiation from speculative spikes.\n                concise Specification: The factor is defined as the difference between the cross-sectional rank of 20-day close price returns and the cross-sectional rank of 20-day volume returns, multiplied by the ratio of the 5-day moving average volume to the 20-day moving average volume.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:18:04.399461"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1214261073922489,
        "ICIR": 0.0401209224507838,
        "1day.excess_return_without_cost.std": 0.0044144067559674,
        "1day.excess_return_with_cost.annualized_return": 0.0064909772798177,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002252539816941,
        "1day.excess_return_without_cost.annualized_return": 0.0536104476432006,
        "1day.excess_return_with_cost.std": 0.0044149463392098,
        "Rank IC": 0.0208219133592493,
        "IC": 0.0056106100415451,
        "1day.excess_return_without_cost.max_drawdown": -0.113875208971601,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7872063836583528,
        "1day.pa": 0.0,
        "l2.valid": 0.9966244114324097,
        "Rank ICIR": 0.1533980178010795,
        "l2.train": 0.9946391446228384,
        "1day.excess_return_with_cost.information_ratio": 0.0953007198502745,
        "1day.excess_return_with_cost.mean": 2.727301378074685e-05
      },
      "feedback": {
        "observations": "The experiment compared two implementations of the price-volume rank divergence hypothesis. The 'Robust_Trend_Confirmation_Factor' (Current Result) introduced Z-score normalization and a clipping mechanism (MIN function) for the volume surge ratio to cap the influence of extreme volume spikes. The results show a significant improvement in the Information Ratio (from 0.707 to 0.787) and IC (from 0.0051 to 0.0056), alongside a reduction in Max Drawdown (-0.114 vs -0.125). Although the Annualized Return saw a marginal decrease (0.0536 vs 0.0556), the risk-adjusted performance and predictive consistency (IC) are notably superior.",
        "hypothesis_evaluation": "The results strongly support the hypothesis that combining price-volume rank divergence with a surge ratio identifies high-quality trends. The inclusion of a 'capping' mechanism (MIN(ratio, 2.0)) in the current iteration suggests that while volume surges are informative, extreme outliers can introduce noise, and limiting their weight improves factor stability and risk-adjusted returns.",
        "decision": true,
        "reason": "The current 'TS_PCTCHANGE(volume, 20)' can be highly volatile for stocks with low baseline liquidity. By replacing volume percentage change with a standardized volume measure (e.g., Z-score of volume or Rank of average volume), we can more accurately identify where price momentum is backed by significant relative capital commitment, further improving the Information Ratio and reducing drawdown."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "313712a806704ff8a78cedb9932376eb",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/313712a806704ff8a78cedb9932376eb/result.h5"
      }
    },
    "34fe64f78fb84ef4": {
      "factor_id": "34fe64f78fb84ef4",
      "factor_name": "VW_Price_Rejection_Reversal_3D",
      "factor_expression": "($close <= TS_MIN($close, 3)) ? (((MIN($open, $close) - $low) / (TS_MEAN(MAX(MAX($high - $low, ABS($high - DELAY($close, 1))), ABS($low - DELAY($close, 1))), 10) + 1e-8)) * ($volume / (TS_MEAN($volume, 5) + 1e-8))) : 0",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"($close <= TS_MIN($close, 3)) ? (((MIN($open, $close) - $low) / (TS_MEAN(MAX(MAX($high - $low, ABS($high - DELAY($close, 1))), ABS($low - DELAY($close, 1))), 10) + 1e-8)) * ($volume / (TS_MEAN($volume, 5) + 1e-8))) : 0\" # Your output factor expression will be filled in here\n    name = \"VW_Price_Rejection_Reversal_3D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies short-term reversals by measuring the 'Volume-Weighted Price Rejection'. It calculates the lower shadow length normalized by the 10-day ATR (Average True Range) and scales it by the relative volume (current volume vs. 5-day average). The signal is only active when the close price is at a 3-day low, capturing high-conviction buying support at local extremes.",
      "factor_formulation": "Factor = \\begin{cases} \\frac{\\min(open, close) - low}{ATR_{10}} \\times \\frac{volume}{mean(volume, 5)} & \\text{if } close = \\min(close, 3) \\\\ 0 & \\text{otherwise} \\end{cases}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Volume-Weighted Price Rejection' where the lower shadow length is normalized by the 10-day Average True Range (ATR) and amplified by the ratio of current volume to its 5-day moving average, specifically when the price is at a 3-day low.\n                Concise Observation: Previous attempts using price residuals and shadows failed because they lacked a validation mechanism to distinguish between low-conviction price drifts and high-conviction buying support at the lows.\n                Concise Justification: Normalizing the lower shadow by ATR accounts for volatility regimes, while the volume ratio filters for 'active' absorption of selling pressure, ensuring the factor captures meaningful capital flow rather than idiosyncratic noise.\n                Concise Knowledge: If a price rejection (lower shadow) occurs on high relative volume at a local price extreme, the probability of a reversal increases; volume acts as a validation of the 'liquidity grab' identified by the shadow.\n                concise Specification: Calculate the Lower Shadow (min(open, close) - low); normalize it by the 10-day ATR; multiply this by the Volume Ratio ($volume / mean($volume, 5)); the final factor is this product if $close is the minimum of the last 3 days, else 0.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:23:19.348287"
      },
      "backtest_results": {},
      "feedback": {
        "observations": "The current experiment attempted to validate the 'Volume-Weighted Price Rejection' hypothesis through two implemented factors: VW_Price_Rejection_Reversal_3D and Active_Liquidity_Grab_Index. However, the results for these factors are missing (NaN) in the provided comparison table, while the SOTA result remains at an Information Ratio of 0.972 and an IC of 0.0058. The lack of valid metrics for the current run suggests either a calculation failure, a data alignment issue (possibly due to the strict '3-day low' condition being too sparse), or a failure to outperform the baseline to a degree that it was recorded.",
        "hypothesis_evaluation": "The hypothesis that short-term reversals are driven by volume-weighted lower shadows at price extremes is theoretically sound but may be too restrictive in its current 'if close == min(close, 3)' condition. This binary trigger likely results in a sparse signal, leading to the NaN values observed in the metrics. The use of ATR or STD for normalization is appropriate, but the interaction between the volume surge and the price rejection needs a more continuous representation to be robust.",
        "decision": false,
        "reason": "The current binary condition (close == min(close, 3)) creates a 'spike' signal that may not provide enough coverage for stable model training or evaluation, potentially causing the NaN results. By moving to a continuous ranking of the 'Price Rejection' (lower shadow / ATR) multiplied by 'Volume Intensity' (Volume / MA), we allow the model to learn the gradient of reversal strength across all instruments rather than just at absolute local minimums. This reduces signal sparsity and improves the Information Ratio."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "afa55c0e39d84baf83ecf780ce4f8887",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/afa55c0e39d84baf83ecf780ce4f8887/result.h5"
      }
    },
    "8e9c2cf15aaebdb3": {
      "factor_id": "8e9c2cf15aaebdb3",
      "factor_name": "ATR_Normalized_Shadow_Volume_Filter",
      "factor_expression": "($close <= TS_MIN($close, 3)) ? (RANK((MIN($open, $close) - $low) / (TS_MEAN(MAX($high - $low, ABS($high - DELAY($close, 1))), 10) + 1e-8)) * RANK($volume / (TS_MEAN($volume, 5) + 1e-8))) : 0",
      "factor_implementation_code": "",
      "factor_description": "A simplified version of the volume-weighted rejection hypothesis. It focuses on the cross-sectional rank of the lower shadow normalized by volatility (ATR), amplified by the volume surge, specifically when the stock hits a new short-term low. This ensures the factor identifies 'active' absorption of selling pressure.",
      "factor_formulation": "Factor = RANK(\\frac{min(open, close) - low}{ATR_{10}}) \\times RANK(\\frac{volume}{TS\\_MEAN(volume, 5)}) \\text{ if } close == TS\\_MIN(close, 3)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Volume-Weighted Price Rejection' where the lower shadow length is normalized by the 10-day Average True Range (ATR) and amplified by the ratio of current volume to its 5-day moving average, specifically when the price is at a 3-day low.\n                Concise Observation: Previous attempts using price residuals and shadows failed because they lacked a validation mechanism to distinguish between low-conviction price drifts and high-conviction buying support at the lows.\n                Concise Justification: Normalizing the lower shadow by ATR accounts for volatility regimes, while the volume ratio filters for 'active' absorption of selling pressure, ensuring the factor captures meaningful capital flow rather than idiosyncratic noise.\n                Concise Knowledge: If a price rejection (lower shadow) occurs on high relative volume at a local price extreme, the probability of a reversal increases; volume acts as a validation of the 'liquidity grab' identified by the shadow.\n                concise Specification: Calculate the Lower Shadow (min(open, close) - low); normalize it by the 10-day ATR; multiply this by the Volume Ratio ($volume / mean($volume, 5)); the final factor is this product if $close is the minimum of the last 3 days, else 0.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:23:19.348287"
      },
      "backtest_results": {},
      "feedback": {
        "observations": "The current experiment attempted to validate the 'Volume-Weighted Price Rejection' hypothesis through two implemented factors: VW_Price_Rejection_Reversal_3D and Active_Liquidity_Grab_Index. However, the results for these factors are missing (NaN) in the provided comparison table, while the SOTA result remains at an Information Ratio of 0.972 and an IC of 0.0058. The lack of valid metrics for the current run suggests either a calculation failure, a data alignment issue (possibly due to the strict '3-day low' condition being too sparse), or a failure to outperform the baseline to a degree that it was recorded.",
        "hypothesis_evaluation": "The hypothesis that short-term reversals are driven by volume-weighted lower shadows at price extremes is theoretically sound but may be too restrictive in its current 'if close == min(close, 3)' condition. This binary trigger likely results in a sparse signal, leading to the NaN values observed in the metrics. The use of ATR or STD for normalization is appropriate, but the interaction between the volume surge and the price rejection needs a more continuous representation to be robust.",
        "decision": false,
        "reason": "The current binary condition (close == min(close, 3)) creates a 'spike' signal that may not provide enough coverage for stable model training or evaluation, potentially causing the NaN results. By moving to a continuous ranking of the 'Price Rejection' (lower shadow / ATR) multiplied by 'Volume Intensity' (Volume / MA), we allow the model to learn the gradient of reversal strength across all instruments rather than just at absolute local minimums. This reduces signal sparsity and improves the Information Ratio."
      },
      "cache_location": null
    },
    "26ab41e885f85f84": {
      "factor_id": "26ab41e885f85f84",
      "factor_name": "Active_Liquidity_Grab_Index",
      "factor_expression": "($close <= TS_MIN($close, 3)) ? (((MIN($open, $close) - $low) / (TS_STD($close, 10) + 1e-8)) * ($volume / (TS_MEAN($volume, 5) + 1e-8))) : 0",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"($close <= TS_MIN($close, 3)) ? (((MIN($open, $close) - $low) / (TS_STD($close, 10) + 1e-8)) * ($volume / (TS_MEAN($volume, 5) + 1e-8))) : 0\" # Your output factor expression will be filled in here\n    name = \"Active_Liquidity_Grab_Index\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures 'Liquidity Grabs' by multiplying the normalized lower shadow by the volume ratio. It uses a 10-day window for volatility normalization and a 5-day window for volume benchmarking, targeting stocks that show significant intraday recovery on high relative volume at a 3-day price bottom.",
      "factor_formulation": "Factor = \\frac{min(open, close) - low}{TS\\_STD(close, 10)} \\times \\frac{volume}{TS\\_MEAN(volume, 5)} \\text{ conditioned on 3-day low}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Volume-Weighted Price Rejection' where the lower shadow length is normalized by the 10-day Average True Range (ATR) and amplified by the ratio of current volume to its 5-day moving average, specifically when the price is at a 3-day low.\n                Concise Observation: Previous attempts using price residuals and shadows failed because they lacked a validation mechanism to distinguish between low-conviction price drifts and high-conviction buying support at the lows.\n                Concise Justification: Normalizing the lower shadow by ATR accounts for volatility regimes, while the volume ratio filters for 'active' absorption of selling pressure, ensuring the factor captures meaningful capital flow rather than idiosyncratic noise.\n                Concise Knowledge: If a price rejection (lower shadow) occurs on high relative volume at a local price extreme, the probability of a reversal increases; volume acts as a validation of the 'liquidity grab' identified by the shadow.\n                concise Specification: Calculate the Lower Shadow (min(open, close) - low); normalize it by the 10-day ATR; multiply this by the Volume Ratio ($volume / mean($volume, 5)); the final factor is this product if $close is the minimum of the last 3 days, else 0.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:23:19.348287"
      },
      "backtest_results": {},
      "feedback": {
        "observations": "The current experiment attempted to validate the 'Volume-Weighted Price Rejection' hypothesis through two implemented factors: VW_Price_Rejection_Reversal_3D and Active_Liquidity_Grab_Index. However, the results for these factors are missing (NaN) in the provided comparison table, while the SOTA result remains at an Information Ratio of 0.972 and an IC of 0.0058. The lack of valid metrics for the current run suggests either a calculation failure, a data alignment issue (possibly due to the strict '3-day low' condition being too sparse), or a failure to outperform the baseline to a degree that it was recorded.",
        "hypothesis_evaluation": "The hypothesis that short-term reversals are driven by volume-weighted lower shadows at price extremes is theoretically sound but may be too restrictive in its current 'if close == min(close, 3)' condition. This binary trigger likely results in a sparse signal, leading to the NaN values observed in the metrics. The use of ATR or STD for normalization is appropriate, but the interaction between the volume surge and the price rejection needs a more continuous representation to be robust.",
        "decision": false,
        "reason": "The current binary condition (close == min(close, 3)) creates a 'spike' signal that may not provide enough coverage for stable model training or evaluation, potentially causing the NaN results. By moving to a continuous ranking of the 'Price Rejection' (lower shadow / ATR) multiplied by 'Volume Intensity' (Volume / MA), we allow the model to learn the gradient of reversal strength across all instruments rather than just at absolute local minimums. This reduces signal sparsity and improves the Information Ratio."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "c0efbaa97c9e4702af32d193eec2df13",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/c0efbaa97c9e4702af32d193eec2df13/result.h5"
      }
    },
    "ac5848b26f80fded": {
      "factor_id": "ac5848b26f80fded",
      "factor_name": "Institutional_Accumulation_Intensity_Factor",
      "factor_expression": "(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_ZSCORE($volume, 20))) * SIGN(WMA($volume, 5) / (WMA($volume, 20) + 1e-8) - 1.0)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_ZSCORE($volume, 20))) * SIGN(WMA($volume, 5) / (WMA($volume, 20) + 1e-8) - 1.0)\" # Your output factor expression will be filled in here\n    name = \"Institutional_Accumulation_Intensity_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the divergence between price momentum and standardized volume intensity. It uses a 20-day volume Z-score to identify institutional conviction and scales the result by a smoothed volume ratio (WMA) to filter for high-quality liquidity trends, avoiding the previously flagged simple mean ratio.",
      "factor_formulation": "\\text{RankDiff} = \\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS_ZSCORE}(\\text{volume}, 20)) \\\\ \\text{Factor} = \\text{RankDiff} * \\text{SIGN}(\\text{WMA}(\\text{volume}, 5) / \\text{WMA}(\\text{volume}, 20) - 1.0)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor that measures the divergence between the cross-sectional rank of price momentum and the cross-sectional rank of standardized volume intensity (volume Z-score) provides a more robust signal of institutional accumulation than simple volume growth.\n                Concise Observation: Previous iterations showed that raw volume percentage changes (TS_PCTCHANGE) are prone to distortions in low-liquidity stocks, whereas capping volume surge ratios improved the Information Ratio by limiting the impact of outliers.\n                Concise Justification: Standardizing volume via a 20-day Z-score removes the scale effect of low-base volume, ensuring that the 'volume rank' reflects true intensity relative to the asset's history. Comparing this to price momentum rank identifies high-conviction moves while filtering out speculative noise.\n                Concise Knowledge: If price momentum is supported by high standardized volume intensity (Z-score) rather than just percentage volume growth, the trend is more likely to be driven by institutional accumulation; when price rank leads volume intensity rank, it signals a more sustainable trend than when driven by low-base volume spikes.\n                concise Specification: The factor is calculated as: (Rank(TS_PCTCHANGE(Close, 20)) - Rank((Volume - TS_MEAN(Volume, 20)) / TS_STD(Volume, 20))) * MIN(TS_MEAN(Volume, 5) / TS_MEAN(Volume, 20), 2.0). All ranks are cross-sectional.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:23:45.131372"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1141834631731679,
        "ICIR": 0.0437782455216338,
        "1day.excess_return_without_cost.std": 0.0045919143609327,
        "1day.excess_return_with_cost.annualized_return": 0.0281343952086348,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003170490512255,
        "1day.excess_return_without_cost.annualized_return": 0.0754576741916892,
        "1day.excess_return_with_cost.std": 0.0045931347139422,
        "Rank IC": 0.0218212457874268,
        "IC": 0.0064974592663259,
        "1day.excess_return_without_cost.max_drawdown": -0.1063550962855847,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.0651754701214335,
        "1day.pa": 0.0,
        "l2.valid": 0.9966855470972046,
        "Rank ICIR": 0.150216821294942,
        "l2.train": 0.994165880323172,
        "1day.excess_return_with_cost.information_ratio": 0.397045174372272,
        "1day.excess_return_with_cost.mean": 0.000118211744574
      },
      "feedback": {
        "observations": "The current iteration focused on refining the 'Institutional Accumulation' hypothesis by replacing simple mean-based volume ratios with more sophisticated smoothing techniques like WMA, EMA, and Sum-ratios to weight the divergence between price momentum and volume intensity. The results show a significant improvement across all key performance metrics. The Information Ratio increased from 0.787 to 1.065, and the Annualized Return improved from 5.36% to 7.55%. The IC also saw a healthy boost to 0.0065. These improvements suggest that the divergence between price rank and volume Z-score rank is a powerful predictor, especially when filtered by volume trend stability.",
        "hypothesis_evaluation": "The results strongly support the hypothesis. The divergence between price momentum rank and standardized volume intensity (volume Z-score) captures a unique signal of institutional activity. Specifically, using more robust volume filters (like WMA or EMA) to weight this divergence effectively separates high-conviction institutional moves from noise, outperforming the previous SOTA which likely used simpler, noisier volume growth metrics.",
        "decision": true,
        "reason": "Current factors use volume level (Z-score) and volume trend (WMA/EMA ratios), but they don't account for the 'cleanliness' of the volume signal. High volume volatility can indicate retail panic or wash trading rather than institutional accumulation. By incorporating a volume stability measure (e.g., 1/TS_STD(volume)), we can further filter for 'quiet' institutional accumulation which typically precedes larger price moves. Additionally, simplifying the interaction between the RankDiff and the volume filter from a multiplicative weight to a conditional thresholding or a more stable Z-scored weight may improve robustness."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "e2a4ee002ab0404682a5d26ecc199d25",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/e2a4ee002ab0404682a5d26ecc199d25/result.h5"
      }
    },
    "bf3e7ddb204fb04c": {
      "factor_id": "bf3e7ddb204fb04c",
      "factor_name": "Standardized_Volume_Momentum_Divergence",
      "factor_expression": "(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_ZSCORE($volume, 20))) * MIN(EMA($volume, 10) / (TS_MEDIAN($volume, 20) + 1e-8), 1.5)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_ZSCORE($volume, 20))) * MIN(EMA($volume, 10) / (TS_MEDIAN($volume, 20) + 1e-8), 1.5)\" # Your output factor expression will be filled in here\n    name = \"Standardized_Volume_Momentum_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "Calculates the gap between price momentum rank and volume intensity rank. Instead of a simple volume ratio, it uses the 10-day exponential moving average of volume relative to its 20-day median to weight the divergence, ensuring the signal is driven by sustained volume growth rather than one-day spikes.",
      "factor_formulation": "\\text{Factor} = (\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS_ZSCORE}(\\text{volume}, 20))) * \\text{MIN}(\\text{EMA}(\\text{volume}, 10) / (\\text{TS_MEDIAN}(\\text{volume}, 20) + 1e-8), 1.5)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor that measures the divergence between the cross-sectional rank of price momentum and the cross-sectional rank of standardized volume intensity (volume Z-score) provides a more robust signal of institutional accumulation than simple volume growth.\n                Concise Observation: Previous iterations showed that raw volume percentage changes (TS_PCTCHANGE) are prone to distortions in low-liquidity stocks, whereas capping volume surge ratios improved the Information Ratio by limiting the impact of outliers.\n                Concise Justification: Standardizing volume via a 20-day Z-score removes the scale effect of low-base volume, ensuring that the 'volume rank' reflects true intensity relative to the asset's history. Comparing this to price momentum rank identifies high-conviction moves while filtering out speculative noise.\n                Concise Knowledge: If price momentum is supported by high standardized volume intensity (Z-score) rather than just percentage volume growth, the trend is more likely to be driven by institutional accumulation; when price rank leads volume intensity rank, it signals a more sustainable trend than when driven by low-base volume spikes.\n                concise Specification: The factor is calculated as: (Rank(TS_PCTCHANGE(Close, 20)) - Rank((Volume - TS_MEAN(Volume, 20)) / TS_STD(Volume, 20))) * MIN(TS_MEAN(Volume, 5) / TS_MEAN(Volume, 20), 2.0). All ranks are cross-sectional.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:23:45.131372"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1141834631731679,
        "ICIR": 0.0437782455216338,
        "1day.excess_return_without_cost.std": 0.0045919143609327,
        "1day.excess_return_with_cost.annualized_return": 0.0281343952086348,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003170490512255,
        "1day.excess_return_without_cost.annualized_return": 0.0754576741916892,
        "1day.excess_return_with_cost.std": 0.0045931347139422,
        "Rank IC": 0.0218212457874268,
        "IC": 0.0064974592663259,
        "1day.excess_return_without_cost.max_drawdown": -0.1063550962855847,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.0651754701214335,
        "1day.pa": 0.0,
        "l2.valid": 0.9966855470972046,
        "Rank ICIR": 0.150216821294942,
        "l2.train": 0.994165880323172,
        "1day.excess_return_with_cost.information_ratio": 0.397045174372272,
        "1day.excess_return_with_cost.mean": 0.000118211744574
      },
      "feedback": {
        "observations": "The current iteration focused on refining the 'Institutional Accumulation' hypothesis by replacing simple mean-based volume ratios with more sophisticated smoothing techniques like WMA, EMA, and Sum-ratios to weight the divergence between price momentum and volume intensity. The results show a significant improvement across all key performance metrics. The Information Ratio increased from 0.787 to 1.065, and the Annualized Return improved from 5.36% to 7.55%. The IC also saw a healthy boost to 0.0065. These improvements suggest that the divergence between price rank and volume Z-score rank is a powerful predictor, especially when filtered by volume trend stability.",
        "hypothesis_evaluation": "The results strongly support the hypothesis. The divergence between price momentum rank and standardized volume intensity (volume Z-score) captures a unique signal of institutional activity. Specifically, using more robust volume filters (like WMA or EMA) to weight this divergence effectively separates high-conviction institutional moves from noise, outperforming the previous SOTA which likely used simpler, noisier volume growth metrics.",
        "decision": true,
        "reason": "Current factors use volume level (Z-score) and volume trend (WMA/EMA ratios), but they don't account for the 'cleanliness' of the volume signal. High volume volatility can indicate retail panic or wash trading rather than institutional accumulation. By incorporating a volume stability measure (e.g., 1/TS_STD(volume)), we can further filter for 'quiet' institutional accumulation which typically precedes larger price moves. Additionally, simplifying the interaction between the RankDiff and the volume filter from a multiplicative weight to a conditional thresholding or a more stable Z-scored weight may improve robustness."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "775095a6b5b8480fa667b94dfec6adad",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/775095a6b5b8480fa667b94dfec6adad/result.h5"
      }
    },
    "1b4c407d0e1e3b54": {
      "factor_id": "1b4c407d0e1e3b54",
      "factor_name": "Relative_Intensity_Trend_Filter",
      "factor_expression": "ZSCORE(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_ZSCORE($volume, 20))) * (TS_SUM($volume, 5) / (TS_SUM($volume, 20) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_ZSCORE($volume, 20))) * (TS_SUM($volume, 5) / (TS_SUM($volume, 20) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Relative_Intensity_Trend_Filter\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "Identifies stocks where price momentum is leading volume intensity. It uses the ratio of the 5-day volume sum to the 20-day volume sum as a weight, which is a structurally different calculation from the previously flagged mean ratio, to capture institutional footprint.",
      "factor_formulation": "\\text{Factor} = \\text{ZSCORE}(\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS_ZSCORE}(\\text{volume}, 20))) * (\\text{TS_SUM}(\\text{volume}, 5) / \\text{TS_SUM}(\\text{volume}, 20))",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor that measures the divergence between the cross-sectional rank of price momentum and the cross-sectional rank of standardized volume intensity (volume Z-score) provides a more robust signal of institutional accumulation than simple volume growth.\n                Concise Observation: Previous iterations showed that raw volume percentage changes (TS_PCTCHANGE) are prone to distortions in low-liquidity stocks, whereas capping volume surge ratios improved the Information Ratio by limiting the impact of outliers.\n                Concise Justification: Standardizing volume via a 20-day Z-score removes the scale effect of low-base volume, ensuring that the 'volume rank' reflects true intensity relative to the asset's history. Comparing this to price momentum rank identifies high-conviction moves while filtering out speculative noise.\n                Concise Knowledge: If price momentum is supported by high standardized volume intensity (Z-score) rather than just percentage volume growth, the trend is more likely to be driven by institutional accumulation; when price rank leads volume intensity rank, it signals a more sustainable trend than when driven by low-base volume spikes.\n                concise Specification: The factor is calculated as: (Rank(TS_PCTCHANGE(Close, 20)) - Rank((Volume - TS_MEAN(Volume, 20)) / TS_STD(Volume, 20))) * MIN(TS_MEAN(Volume, 5) / TS_MEAN(Volume, 20), 2.0). All ranks are cross-sectional.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:23:45.131372"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1141834631731679,
        "ICIR": 0.0437782455216338,
        "1day.excess_return_without_cost.std": 0.0045919143609327,
        "1day.excess_return_with_cost.annualized_return": 0.0281343952086348,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003170490512255,
        "1day.excess_return_without_cost.annualized_return": 0.0754576741916892,
        "1day.excess_return_with_cost.std": 0.0045931347139422,
        "Rank IC": 0.0218212457874268,
        "IC": 0.0064974592663259,
        "1day.excess_return_without_cost.max_drawdown": -0.1063550962855847,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.0651754701214335,
        "1day.pa": 0.0,
        "l2.valid": 0.9966855470972046,
        "Rank ICIR": 0.150216821294942,
        "l2.train": 0.994165880323172,
        "1day.excess_return_with_cost.information_ratio": 0.397045174372272,
        "1day.excess_return_with_cost.mean": 0.000118211744574
      },
      "feedback": {
        "observations": "The current iteration focused on refining the 'Institutional Accumulation' hypothesis by replacing simple mean-based volume ratios with more sophisticated smoothing techniques like WMA, EMA, and Sum-ratios to weight the divergence between price momentum and volume intensity. The results show a significant improvement across all key performance metrics. The Information Ratio increased from 0.787 to 1.065, and the Annualized Return improved from 5.36% to 7.55%. The IC also saw a healthy boost to 0.0065. These improvements suggest that the divergence between price rank and volume Z-score rank is a powerful predictor, especially when filtered by volume trend stability.",
        "hypothesis_evaluation": "The results strongly support the hypothesis. The divergence between price momentum rank and standardized volume intensity (volume Z-score) captures a unique signal of institutional activity. Specifically, using more robust volume filters (like WMA or EMA) to weight this divergence effectively separates high-conviction institutional moves from noise, outperforming the previous SOTA which likely used simpler, noisier volume growth metrics.",
        "decision": true,
        "reason": "Current factors use volume level (Z-score) and volume trend (WMA/EMA ratios), but they don't account for the 'cleanliness' of the volume signal. High volume volatility can indicate retail panic or wash trading rather than institutional accumulation. By incorporating a volume stability measure (e.g., 1/TS_STD(volume)), we can further filter for 'quiet' institutional accumulation which typically precedes larger price moves. Additionally, simplifying the interaction between the RankDiff and the volume filter from a multiplicative weight to a conditional thresholding or a more stable Z-scored weight may improve robustness."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "1b3265a44fea4651bb53062193649c42",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/1b3265a44fea4651bb53062193649c42/result.h5"
      }
    },
    "fb9a57b88e064b9a": {
      "factor_id": "fb9a57b88e064b9a",
      "factor_name": "RBI_Reversal_Intensity_5D",
      "factor_expression": "((MIN($open, $close) - $low) / ($high - $low + 1e-8)) * (($volume / (TS_MEAN($volume, 5) + 1e-8)) * (($high - $low) / (TS_MEAN($high - $low, 5) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"((MIN($open, $close) - $low) / ($high - $low + 1e-8)) * (($volume / (TS_MEAN($volume, 5) + 1e-8)) * (($high - $low) / (TS_MEAN($high - $low, 5) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"RBI_Reversal_Intensity_5D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor calculates the Relative Buying Intensity (RBI) by measuring the ratio of intraday price rejection (lower shadow) to the total daily range, scaled by a volume-weighted range expansion factor over a 5-day window. It identifies high-conviction buying support during periods of expanding activity.",
      "factor_formulation": "RBI = \\frac{\\min(open, close) - low}{high - low + 1e-8} \\times \\left( \\frac{volume}{\\text{TS_MEAN}(volume, 5)} \\times \\frac{high - low}{\\text{TS_MEAN}(high - low, 5)} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Relative Buying Intensity' (RBI), which measures the ratio of intraday price rejection to the total price range, scaled by the volume-weighted relative range expansion over a 5-day window.\n                Concise Observation: Previous attempts failed due to signal sparsity (binary 3-day low filters) or noise from absolute normalization (ATR). The NaN results and low IC suggest that the interaction between price rejection and volume must be captured as a continuous proportion of the total daily activity to remain robust across different volatility regimes.\n                Concise Justification: By using the ratio of the lower shadow to the total daily range ($high - $low), we create a scale-invariant measure of 'intraday recovery'. Multiplying this by a volume-scaled range expansion factor (the 'Intensity') ensures we capture moments where the market is actively clearing sell orders, providing a continuous signal suitable for gradient-based models.\n                Concise Knowledge: If the intraday lower shadow represents a large proportion of the day's total range (High-Low) and this occurs during a period of expanding volume and range relative to a 5-day baseline, it signals high-conviction buying support; such 'relative intensity' is more predictive of reversals than absolute shadow length or binary price lows.\n                concise Specification: 1. Calculate Lower Shadow: LS = min(open, close) - low; 2. Calculate Daily Range: DR = high - low; 3. Calculate Intraday Rejection Ratio: IRR = LS / (DR + epsilon); 4. Calculate Volume-Range Intensity: VRI = (volume / mean(volume, 5)) * (DR / mean(DR, 5)); 5. Factor = IRR * VRI. All components use a 5-day lookback for normalization.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:26:52.588804"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1561700216758442,
        "ICIR": 0.0191133159854574,
        "1day.excess_return_without_cost.std": 0.0044726387217344,
        "1day.excess_return_with_cost.annualized_return": -0.0018954604519087,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001904214309802,
        "1day.excess_return_without_cost.annualized_return": 0.0453203005733064,
        "1day.excess_return_with_cost.std": 0.0044746816533387,
        "Rank IC": 0.0178728774428716,
        "IC": 0.0025674614173384,
        "1day.excess_return_without_cost.max_drawdown": -0.1138489868047696,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6568110999300245,
        "1day.pa": 0.0,
        "l2.valid": 0.996151281612235,
        "Rank ICIR": 0.1314486856121008,
        "l2.train": 0.9936624049355006,
        "1day.excess_return_with_cost.information_ratio": -0.0274576968365202,
        "1day.excess_return_with_cost.mean": -7.9641195458352e-06
      },
      "feedback": {
        "observations": "The experimental results for the 'Relative Buying Intensity' (RBI) framework show that while the concept of intraday price rejection is a valid signal for short-term reversals, the current implementations (RBI_Reversal_Intensity_5D, CBSI, and NIR) underperform compared to the SOTA result across all key metrics, including IC (0.002567 vs 0.005798) and Information Ratio (0.6568 vs 0.9725). The NIR factor simplified the logic by focusing on the lower shadow relative to a 5-day volatility baseline, but the overall predictive power remains weaker than the previous best. The complexity of the factors is well-controlled (low symbol length and few base features), suggesting that the underperformance is due to the signal's logic rather than overfitting.",
        "hypothesis_evaluation": "The hypothesis that RBI (ratio of price rejection to range scaled by volume) drives reversals is partially supported in direction but lacks the strength of the SOTA. The 'RBI_Reversal_Intensity_5D' factor might be too noisy because it multiplies two volatile ratios (volume expansion and range expansion). The 'Continuous_Buying_Support_Index_5D' (CBSI) using RANK is a more robust approach but still fails to capture the full alpha. The results suggest that 'buying intensity' needs to be contextualized not just by volume, but by the trend preceding the rejection.",
        "decision": false,
        "reason": "The current factors treat all intraday rejections equally, regardless of whether the stock was already in an uptrend or a downtrend. Reversal signals are theoretically stronger after a sell-off. By incorporating a short-term momentum filter (e.g., 3-day return) and focusing on the 'Shadow Ratio' (lower shadow vs. upper shadow), we can better isolate genuine support from simple high-volatility churning. This refines the 'Relative Buying Intensity' framework by adding a 'Pre-condition' and a 'Quality' metric."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "1132a8ec55344454a512d632f07bf1c1",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/1132a8ec55344454a512d632f07bf1c1/result.h5"
      }
    },
    "8c82deb5928d64c7": {
      "factor_id": "8c82deb5928d64c7",
      "factor_name": "Continuous_Buying_Support_Index_5D",
      "factor_expression": "RANK((MIN($open, $close) - $low) / ($high - $low + 1e-8)) * RANK($volume / (TS_MEAN($volume, 5) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK((MIN($open, $close) - $low) / ($high - $low + 1e-8)) * RANK($volume / (TS_MEAN($volume, 5) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Continuous_Buying_Support_Index_5D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A continuous measure of buying support that combines the intraday rejection ratio with relative volume intensity. Unlike binary filters, this provides a cross-sectional ranking of reversal conviction by identifying where price recovery is most significant relative to recent volume and volatility baselines.",
      "factor_formulation": "CBSI = \\text{RANK}\\left(\\frac{\\min(open, close) - low}{high - low + 1e-8}\\right) \\times \\text{RANK}\\left(\\frac{volume}{\\text{TS_MEAN}(volume, 5)}\\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Relative Buying Intensity' (RBI), which measures the ratio of intraday price rejection to the total price range, scaled by the volume-weighted relative range expansion over a 5-day window.\n                Concise Observation: Previous attempts failed due to signal sparsity (binary 3-day low filters) or noise from absolute normalization (ATR). The NaN results and low IC suggest that the interaction between price rejection and volume must be captured as a continuous proportion of the total daily activity to remain robust across different volatility regimes.\n                Concise Justification: By using the ratio of the lower shadow to the total daily range ($high - $low), we create a scale-invariant measure of 'intraday recovery'. Multiplying this by a volume-scaled range expansion factor (the 'Intensity') ensures we capture moments where the market is actively clearing sell orders, providing a continuous signal suitable for gradient-based models.\n                Concise Knowledge: If the intraday lower shadow represents a large proportion of the day's total range (High-Low) and this occurs during a period of expanding volume and range relative to a 5-day baseline, it signals high-conviction buying support; such 'relative intensity' is more predictive of reversals than absolute shadow length or binary price lows.\n                concise Specification: 1. Calculate Lower Shadow: LS = min(open, close) - low; 2. Calculate Daily Range: DR = high - low; 3. Calculate Intraday Rejection Ratio: IRR = LS / (DR + epsilon); 4. Calculate Volume-Range Intensity: VRI = (volume / mean(volume, 5)) * (DR / mean(DR, 5)); 5. Factor = IRR * VRI. All components use a 5-day lookback for normalization.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:26:52.588804"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1561700216758442,
        "ICIR": 0.0191133159854574,
        "1day.excess_return_without_cost.std": 0.0044726387217344,
        "1day.excess_return_with_cost.annualized_return": -0.0018954604519087,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001904214309802,
        "1day.excess_return_without_cost.annualized_return": 0.0453203005733064,
        "1day.excess_return_with_cost.std": 0.0044746816533387,
        "Rank IC": 0.0178728774428716,
        "IC": 0.0025674614173384,
        "1day.excess_return_without_cost.max_drawdown": -0.1138489868047696,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6568110999300245,
        "1day.pa": 0.0,
        "l2.valid": 0.996151281612235,
        "Rank ICIR": 0.1314486856121008,
        "l2.train": 0.9936624049355006,
        "1day.excess_return_with_cost.information_ratio": -0.0274576968365202,
        "1day.excess_return_with_cost.mean": -7.9641195458352e-06
      },
      "feedback": {
        "observations": "The experimental results for the 'Relative Buying Intensity' (RBI) framework show that while the concept of intraday price rejection is a valid signal for short-term reversals, the current implementations (RBI_Reversal_Intensity_5D, CBSI, and NIR) underperform compared to the SOTA result across all key metrics, including IC (0.002567 vs 0.005798) and Information Ratio (0.6568 vs 0.9725). The NIR factor simplified the logic by focusing on the lower shadow relative to a 5-day volatility baseline, but the overall predictive power remains weaker than the previous best. The complexity of the factors is well-controlled (low symbol length and few base features), suggesting that the underperformance is due to the signal's logic rather than overfitting.",
        "hypothesis_evaluation": "The hypothesis that RBI (ratio of price rejection to range scaled by volume) drives reversals is partially supported in direction but lacks the strength of the SOTA. The 'RBI_Reversal_Intensity_5D' factor might be too noisy because it multiplies two volatile ratios (volume expansion and range expansion). The 'Continuous_Buying_Support_Index_5D' (CBSI) using RANK is a more robust approach but still fails to capture the full alpha. The results suggest that 'buying intensity' needs to be contextualized not just by volume, but by the trend preceding the rejection.",
        "decision": false,
        "reason": "The current factors treat all intraday rejections equally, regardless of whether the stock was already in an uptrend or a downtrend. Reversal signals are theoretically stronger after a sell-off. By incorporating a short-term momentum filter (e.g., 3-day return) and focusing on the 'Shadow Ratio' (lower shadow vs. upper shadow), we can better isolate genuine support from simple high-volatility churning. This refines the 'Relative Buying Intensity' framework by adding a 'Pre-condition' and a 'Quality' metric."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "4aaea48f3ee64a0497989d5bde699637",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/4aaea48f3ee64a0497989d5bde699637/result.h5"
      }
    },
    "d812a4529f1382f8": {
      "factor_id": "d812a4529f1382f8",
      "factor_name": "Normalized_Intraday_Recovery_5D",
      "factor_expression": "(MIN($open, $close) - $low) / (TS_MEAN($high - $low, 5) + 1e-8)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(MIN($open, $close) - $low) / (TS_MEAN($high - $low, 5) + 1e-8)\" # Your output factor expression will be filled in here\n    name = \"Normalized_Intraday_Recovery_5D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor focuses on the 'Intraday Rejection Ratio' (IRR) normalized by the 5-day range expansion. It captures the magnitude of the lower shadow relative to the day's volatility, ensuring the signal is robust across different volatility regimes by using a 5-day baseline for the total range.",
      "factor_formulation": "NIR = \\frac{\\min(open, close) - low}{\\text{TS_MEAN}(high - low, 5) + 1e-8}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Relative Buying Intensity' (RBI), which measures the ratio of intraday price rejection to the total price range, scaled by the volume-weighted relative range expansion over a 5-day window.\n                Concise Observation: Previous attempts failed due to signal sparsity (binary 3-day low filters) or noise from absolute normalization (ATR). The NaN results and low IC suggest that the interaction between price rejection and volume must be captured as a continuous proportion of the total daily activity to remain robust across different volatility regimes.\n                Concise Justification: By using the ratio of the lower shadow to the total daily range ($high - $low), we create a scale-invariant measure of 'intraday recovery'. Multiplying this by a volume-scaled range expansion factor (the 'Intensity') ensures we capture moments where the market is actively clearing sell orders, providing a continuous signal suitable for gradient-based models.\n                Concise Knowledge: If the intraday lower shadow represents a large proportion of the day's total range (High-Low) and this occurs during a period of expanding volume and range relative to a 5-day baseline, it signals high-conviction buying support; such 'relative intensity' is more predictive of reversals than absolute shadow length or binary price lows.\n                concise Specification: 1. Calculate Lower Shadow: LS = min(open, close) - low; 2. Calculate Daily Range: DR = high - low; 3. Calculate Intraday Rejection Ratio: IRR = LS / (DR + epsilon); 4. Calculate Volume-Range Intensity: VRI = (volume / mean(volume, 5)) * (DR / mean(DR, 5)); 5. Factor = IRR * VRI. All components use a 5-day lookback for normalization.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:26:52.588804"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1561700216758442,
        "ICIR": 0.0191133159854574,
        "1day.excess_return_without_cost.std": 0.0044726387217344,
        "1day.excess_return_with_cost.annualized_return": -0.0018954604519087,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001904214309802,
        "1day.excess_return_without_cost.annualized_return": 0.0453203005733064,
        "1day.excess_return_with_cost.std": 0.0044746816533387,
        "Rank IC": 0.0178728774428716,
        "IC": 0.0025674614173384,
        "1day.excess_return_without_cost.max_drawdown": -0.1138489868047696,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6568110999300245,
        "1day.pa": 0.0,
        "l2.valid": 0.996151281612235,
        "Rank ICIR": 0.1314486856121008,
        "l2.train": 0.9936624049355006,
        "1day.excess_return_with_cost.information_ratio": -0.0274576968365202,
        "1day.excess_return_with_cost.mean": -7.9641195458352e-06
      },
      "feedback": {
        "observations": "The experimental results for the 'Relative Buying Intensity' (RBI) framework show that while the concept of intraday price rejection is a valid signal for short-term reversals, the current implementations (RBI_Reversal_Intensity_5D, CBSI, and NIR) underperform compared to the SOTA result across all key metrics, including IC (0.002567 vs 0.005798) and Information Ratio (0.6568 vs 0.9725). The NIR factor simplified the logic by focusing on the lower shadow relative to a 5-day volatility baseline, but the overall predictive power remains weaker than the previous best. The complexity of the factors is well-controlled (low symbol length and few base features), suggesting that the underperformance is due to the signal's logic rather than overfitting.",
        "hypothesis_evaluation": "The hypothesis that RBI (ratio of price rejection to range scaled by volume) drives reversals is partially supported in direction but lacks the strength of the SOTA. The 'RBI_Reversal_Intensity_5D' factor might be too noisy because it multiplies two volatile ratios (volume expansion and range expansion). The 'Continuous_Buying_Support_Index_5D' (CBSI) using RANK is a more robust approach but still fails to capture the full alpha. The results suggest that 'buying intensity' needs to be contextualized not just by volume, but by the trend preceding the rejection.",
        "decision": false,
        "reason": "The current factors treat all intraday rejections equally, regardless of whether the stock was already in an uptrend or a downtrend. Reversal signals are theoretically stronger after a sell-off. By incorporating a short-term momentum filter (e.g., 3-day return) and focusing on the 'Shadow Ratio' (lower shadow vs. upper shadow), we can better isolate genuine support from simple high-volatility churning. This refines the 'Relative Buying Intensity' framework by adding a 'Pre-condition' and a 'Quality' metric."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "e654041bb951460dbbb9b5c6864c129f",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/e654041bb951460dbbb9b5c6864c129f/result.h5"
      }
    },
    "8a75d9db76575857": {
      "factor_id": "8a75d9db76575857",
      "factor_name": "Stable_Institutional_Accumulation_Factor",
      "factor_expression": "(RANK(TS_PCTCHANGE($close, 10)) - RANK(TS_ZSCORE($volume, 10))) / (TS_STD($volume, 20) / (TS_MEAN($volume, 20) + 1e-8) + 1e-6)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(RANK(TS_PCTCHANGE($close, 10)) - RANK(TS_ZSCORE($volume, 10))) / (TS_STD($volume, 20) / (TS_MEAN($volume, 20) + 1e-8) + 1e-6)\" # Your output factor expression will be filled in here\n    name = \"Stable_Institutional_Accumulation_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies institutional accumulation by measuring the divergence between price momentum and volume intensity, weighted by the inverse of volume's coefficient of variation. It prioritizes signals where volume is stable (low volatility) to filter out speculative noise. It uses a 10-day window for momentum to differentiate from the flagged 20-day pattern.",
      "factor_formulation": "\\frac{RANK(TS\\_PCTCHANGE(close, 10)) - RANK(TS\\_ZSCORE(volume, 10))}{TS\\_STD(volume, 20) / (TS\\_MEAN(volume, 20) + 1e-8) + 1e-6}",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor that weights the price-volume rank divergence by the inverse of volume volatility (stability) identifies high-conviction institutional accumulation while filtering out noisy speculative spikes.\n                Concise Observation: Previous successes used volume Z-scores and smoothed volume ratios to improve the Information Ratio, but the current model still struggles with 'noisy' volume spikes that degrade the signal-to-noise ratio of the price-volume divergence.\n                Concise Justification: Institutional accumulation typically occurs with steady, consistent liquidity rather than erratic spikes. Dividing the divergence signal by the 20-day standard deviation of volume (volume stability) ensures the factor prioritizes 'clean' accumulation phases over volatile, speculative ones.\n                Concise Knowledge: If price momentum leads volume intensity during periods of low volume dispersion, the signal is more likely to represent institutional accumulation; when volume volatility is high, the same price-volume divergence is often noise from retail speculation or wash trading.\n                concise Specification: The factor is defined as: (Rank(TS_PCTCHANGE(Close, 20)) - Rank((Volume - TS_MEAN(Volume, 20)) / TS_STD(Volume, 20))) / (TS_STD(Volume, 20) / TS_MEAN(Volume, 20) + 1e-6). The denominator represents the coefficient of variation for volume over 20 days. All ranks are cross-sectional.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:30:19.692627"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1472560559895442,
        "ICIR": 0.0287894015803919,
        "1day.excess_return_without_cost.std": 0.0048625692098862,
        "1day.excess_return_with_cost.annualized_return": -0.0044716169524387,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001812296502924,
        "1day.excess_return_without_cost.annualized_return": 0.0431326567695934,
        "1day.excess_return_with_cost.std": 0.004863486362547,
        "Rank IC": 0.0214230198160203,
        "IC": 0.0042445640372246,
        "1day.excess_return_without_cost.max_drawdown": -0.1239644437013239,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.574978936400623,
        "1day.pa": 0.0,
        "l2.valid": 0.9965737050305856,
        "Rank ICIR": 0.1522107416210549,
        "l2.train": 0.9936068754106084,
        "1day.excess_return_with_cost.information_ratio": -0.0595975508678463,
        "1day.excess_return_with_cost.mean": -1.8788306522851687e-05
      },
      "feedback": {
        "observations": "The current iteration explored three different implementations of the 'Price-Volume Rank Divergence weighted by Stability' hypothesis. While the theoretical framework is sound, the current empirical results (Annualized Return 0.043, IC 0.0042) underperform the SOTA (Annualized Return 0.075, IC 0.0065). The 'Stable_Institutional_Accumulation_Factor' and 'Clean_Volume_Momentum_Divergence' both attempted to use volume standard deviation as a penalty for noise. The results suggest that while the divergence concept has merit, the current weighting mechanism (inverse of volume volatility) might be too restrictive or the look-back windows (10-20 days) are capturing lagging signals rather than leading ones.",
        "hypothesis_evaluation": "The hypothesis that volume stability identifies high-conviction institutional accumulation is partially supported in theory, but the current mathematical formulations are likely too complex or incorrectly scaled. The use of 'RANK(Price) - RANK(Volume)' is a classic divergence measure, but dividing by a raw standard deviation or coefficient of variation creates extreme values when volume is very stable, potentially leading to outlier-driven signals that don't generalize well.",
        "decision": false,
        "reason": "The previous factors focused on the stability of volume alone. However, institutional accumulation is characterized by persistent buying pressure. By replacing raw volume with 'Volume Force' (Volume * TS_PCTCHANGE(close, 1)), we capture the intent. Using a Time-Series Rank (TS_RANK) of this force over a 20-day window, and then measuring its divergence from price momentum, should provide a cleaner signal. To address the complexity issues, we will simplify the stability component to a simple moving average of the force's sign consistency, reducing the number of nested functions and free parameters."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "6ed8b1e4c5614cb7913bfad28808c191",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/6ed8b1e4c5614cb7913bfad28808c191/result.h5"
      }
    },
    "ef7b177693fbcf9c": {
      "factor_id": "ef7b177693fbcf9c",
      "factor_name": "Clean_Volume_Momentum_Divergence",
      "factor_expression": "ZSCORE(TS_RANK($close, 20) - TS_RANK($volume, 20)) * (1.0 / (TS_STD($volume, 5) / (TS_STD($volume, 20) + 1e-8) + 1e-6))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_RANK($close, 20) - TS_RANK($volume, 20)) * (1.0 / (TS_STD($volume, 5) / (TS_STD($volume, 20) + 1e-8) + 1e-6))\" # Your output factor expression will be filled in here\n    name = \"Clean_Volume_Momentum_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures the divergence between price trend and volume intensity, specifically focusing on periods where volume volatility is low relative to its recent history. By using the ratio of 5-day to 20-day volume standard deviation, it identifies 'quiet' accumulation phases.",
      "factor_formulation": "ZSCORE(TS\\_RANK(close, 20) - TS\\_RANK(volume, 20)) * (1.0 / (TS\\_STD(volume, 5) / (TS\\_STD(volume, 20) + 1e-8) + 1e-6))",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor that weights the price-volume rank divergence by the inverse of volume volatility (stability) identifies high-conviction institutional accumulation while filtering out noisy speculative spikes.\n                Concise Observation: Previous successes used volume Z-scores and smoothed volume ratios to improve the Information Ratio, but the current model still struggles with 'noisy' volume spikes that degrade the signal-to-noise ratio of the price-volume divergence.\n                Concise Justification: Institutional accumulation typically occurs with steady, consistent liquidity rather than erratic spikes. Dividing the divergence signal by the 20-day standard deviation of volume (volume stability) ensures the factor prioritizes 'clean' accumulation phases over volatile, speculative ones.\n                Concise Knowledge: If price momentum leads volume intensity during periods of low volume dispersion, the signal is more likely to represent institutional accumulation; when volume volatility is high, the same price-volume divergence is often noise from retail speculation or wash trading.\n                concise Specification: The factor is defined as: (Rank(TS_PCTCHANGE(Close, 20)) - Rank((Volume - TS_MEAN(Volume, 20)) / TS_STD(Volume, 20))) / (TS_STD(Volume, 20) / TS_MEAN(Volume, 20) + 1e-6). The denominator represents the coefficient of variation for volume over 20 days. All ranks are cross-sectional.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:30:19.692627"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1472560559895442,
        "ICIR": 0.0287894015803919,
        "1day.excess_return_without_cost.std": 0.0048625692098862,
        "1day.excess_return_with_cost.annualized_return": -0.0044716169524387,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001812296502924,
        "1day.excess_return_without_cost.annualized_return": 0.0431326567695934,
        "1day.excess_return_with_cost.std": 0.004863486362547,
        "Rank IC": 0.0214230198160203,
        "IC": 0.0042445640372246,
        "1day.excess_return_without_cost.max_drawdown": -0.1239644437013239,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.574978936400623,
        "1day.pa": 0.0,
        "l2.valid": 0.9965737050305856,
        "Rank ICIR": 0.1522107416210549,
        "l2.train": 0.9936068754106084,
        "1day.excess_return_with_cost.information_ratio": -0.0595975508678463,
        "1day.excess_return_with_cost.mean": -1.8788306522851687e-05
      },
      "feedback": {
        "observations": "The current iteration explored three different implementations of the 'Price-Volume Rank Divergence weighted by Stability' hypothesis. While the theoretical framework is sound, the current empirical results (Annualized Return 0.043, IC 0.0042) underperform the SOTA (Annualized Return 0.075, IC 0.0065). The 'Stable_Institutional_Accumulation_Factor' and 'Clean_Volume_Momentum_Divergence' both attempted to use volume standard deviation as a penalty for noise. The results suggest that while the divergence concept has merit, the current weighting mechanism (inverse of volume volatility) might be too restrictive or the look-back windows (10-20 days) are capturing lagging signals rather than leading ones.",
        "hypothesis_evaluation": "The hypothesis that volume stability identifies high-conviction institutional accumulation is partially supported in theory, but the current mathematical formulations are likely too complex or incorrectly scaled. The use of 'RANK(Price) - RANK(Volume)' is a classic divergence measure, but dividing by a raw standard deviation or coefficient of variation creates extreme values when volume is very stable, potentially leading to outlier-driven signals that don't generalize well.",
        "decision": false,
        "reason": "The previous factors focused on the stability of volume alone. However, institutional accumulation is characterized by persistent buying pressure. By replacing raw volume with 'Volume Force' (Volume * TS_PCTCHANGE(close, 1)), we capture the intent. Using a Time-Series Rank (TS_RANK) of this force over a 20-day window, and then measuring its divergence from price momentum, should provide a cleaner signal. To address the complexity issues, we will simplify the stability component to a simple moving average of the force's sign consistency, reducing the number of nested functions and free parameters."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "567af211e9b94c5292672cbe4cda77b2",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/567af211e9b94c5292672cbe4cda77b2/result.h5"
      }
    },
    "c6f3304d5983dbc2": {
      "factor_id": "c6f3304d5983dbc2",
      "factor_name": "Relative_Intensity_Stability_Index",
      "factor_expression": "(RANK(WMA($close, 15)) - RANK(WMA(LOG($volume + 1), 15))) / (TS_STD(LOG($volume + 1), 15) + 1e-8)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"(RANK(WMA($close, 15)) - RANK(WMA(LOG($volume + 1), 15))) / (TS_STD(LOG($volume + 1), 15) + 1e-8)\" # Your output factor expression will be filled in here\n    name = \"Relative_Intensity_Stability_Index\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the spread between price momentum and volume intensity, normalized by volume stability. It uses the log-transformed volume to reduce the impact of extreme outliers and focuses on the consistency of the volume trend over a 15-day period.",
      "factor_formulation": "(RANK(WMA($close, 15)) - RANK(WMA(LOG($volume + 1), 15))) / (TS_STD(LOG($volume + 1), 15) + 1e-8)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor that weights the price-volume rank divergence by the inverse of volume volatility (stability) identifies high-conviction institutional accumulation while filtering out noisy speculative spikes.\n                Concise Observation: Previous successes used volume Z-scores and smoothed volume ratios to improve the Information Ratio, but the current model still struggles with 'noisy' volume spikes that degrade the signal-to-noise ratio of the price-volume divergence.\n                Concise Justification: Institutional accumulation typically occurs with steady, consistent liquidity rather than erratic spikes. Dividing the divergence signal by the 20-day standard deviation of volume (volume stability) ensures the factor prioritizes 'clean' accumulation phases over volatile, speculative ones.\n                Concise Knowledge: If price momentum leads volume intensity during periods of low volume dispersion, the signal is more likely to represent institutional accumulation; when volume volatility is high, the same price-volume divergence is often noise from retail speculation or wash trading.\n                concise Specification: The factor is defined as: (Rank(TS_PCTCHANGE(Close, 20)) - Rank((Volume - TS_MEAN(Volume, 20)) / TS_STD(Volume, 20))) / (TS_STD(Volume, 20) / TS_MEAN(Volume, 20) + 1e-6). The denominator represents the coefficient of variation for volume over 20 days. All ranks are cross-sectional.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:30:19.692627"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1472560559895442,
        "ICIR": 0.0287894015803919,
        "1day.excess_return_without_cost.std": 0.0048625692098862,
        "1day.excess_return_with_cost.annualized_return": -0.0044716169524387,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001812296502924,
        "1day.excess_return_without_cost.annualized_return": 0.0431326567695934,
        "1day.excess_return_with_cost.std": 0.004863486362547,
        "Rank IC": 0.0214230198160203,
        "IC": 0.0042445640372246,
        "1day.excess_return_without_cost.max_drawdown": -0.1239644437013239,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.574978936400623,
        "1day.pa": 0.0,
        "l2.valid": 0.9965737050305856,
        "Rank ICIR": 0.1522107416210549,
        "l2.train": 0.9936068754106084,
        "1day.excess_return_with_cost.information_ratio": -0.0595975508678463,
        "1day.excess_return_with_cost.mean": -1.8788306522851687e-05
      },
      "feedback": {
        "observations": "The current iteration explored three different implementations of the 'Price-Volume Rank Divergence weighted by Stability' hypothesis. While the theoretical framework is sound, the current empirical results (Annualized Return 0.043, IC 0.0042) underperform the SOTA (Annualized Return 0.075, IC 0.0065). The 'Stable_Institutional_Accumulation_Factor' and 'Clean_Volume_Momentum_Divergence' both attempted to use volume standard deviation as a penalty for noise. The results suggest that while the divergence concept has merit, the current weighting mechanism (inverse of volume volatility) might be too restrictive or the look-back windows (10-20 days) are capturing lagging signals rather than leading ones.",
        "hypothesis_evaluation": "The hypothesis that volume stability identifies high-conviction institutional accumulation is partially supported in theory, but the current mathematical formulations are likely too complex or incorrectly scaled. The use of 'RANK(Price) - RANK(Volume)' is a classic divergence measure, but dividing by a raw standard deviation or coefficient of variation creates extreme values when volume is very stable, potentially leading to outlier-driven signals that don't generalize well.",
        "decision": false,
        "reason": "The previous factors focused on the stability of volume alone. However, institutional accumulation is characterized by persistent buying pressure. By replacing raw volume with 'Volume Force' (Volume * TS_PCTCHANGE(close, 1)), we capture the intent. Using a Time-Series Rank (TS_RANK) of this force over a 20-day window, and then measuring its divergence from price momentum, should provide a cleaner signal. To address the complexity issues, we will simplify the stability component to a simple moving average of the force's sign consistency, reducing the number of nested functions and free parameters."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210539",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539",
        "factor_dir": "6f35393e01504ba3869d8c9141945b4a",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210539/6f35393e01504ba3869d8c9141945b4a/result.h5"
      }
    },
    "10e42ec35001f5cb": {
      "factor_id": "10e42ec35001f5cb",
      "factor_name": "AVR_Shadow_Asymmetry_10D",
      "factor_expression": "((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6)) / (TS_STD((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6), 10) + 1e-8) * (($close / DELAY($close, 3) - 1) < 0 ? ABS($close / DELAY($close, 3) - 1) : 0)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6)) / (TS_STD((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6), 10) + 1e-8) * (($close / DELAY($close, 3) - 1) < 0 ? ABS($close / DELAY($close, 3) - 1) : 0)\" # Your output factor expression will be filled in here\n    name = \"AVR_Shadow_Asymmetry_10D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures 'Asymmetric Volatility Rejection' (AVR) by measuring the ratio of the lower shadow to the upper shadow, normalized by its 10-day historical volatility. It is conditioned on a 3-day negative price acceleration to isolate potential bottoming reversals.",
      "factor_formulation": "AVR = \\frac{(min(open, close) - low + 1e-6)}{(high - max(open, close) + 1e-6) \\cdot TS\\_STD(SR, 10)} \\cdot (close/delay(close, 3) < 1 ? abs(close/delay(close, 3) - 1) : 0)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Asymmetric Volatility Rejection' (AVR), where a dominant lower shadow relative to the upper shadow is validated by a 3-day negative price acceleration and normalized by the 10-day volatility of the shadow ratio itself.\n                Concise Observation: Previous attempts failed because they used the total daily range or ATR for normalization, which conflates general volatility with specific rejection strength. Furthermore, they lacked a momentum pre-condition, causing the signal to trigger in neutral or bullish regimes where 'reversal' logic is inapplicable.\n                Concise Justification: Focusing on the ratio of the lower shadow to the upper shadow (Shadow Ratio) isolates the direction of intraday price rejection. By conditioning this on a 3-day negative return, we ensure the factor only captures 'bottoming' behavior. Normalizing by the standard deviation of this ratio over 10 days ensures the signal is statistically significant relative to the stock's typical intraday behavior.\n                Concise Knowledge: If a stock exhibits a high ratio of lower-to-upper shadow (asymmetry) following a period of accelerating price decline (negative 3-day return), it indicates a climax in selling pressure; when this asymmetry is extreme relative to its own 10-day historical distribution, the probability of a mean-reversion event is maximized.\n                concise Specification: 1. Lower Shadow (LS) = min(open, close) - low; 2. Upper Shadow (US) = high - max(open, close); 3. Shadow Ratio (SR) = (LS + 1e-6) / (US + 1e-6); 4. Momentum (MOM3) = close / ref(close, 3) - 1; 5. Factor = (SR / std(SR, 10)) * (MOM3 < 0 ? abs(MOM3) : 0). The final factor uses a 10-day window for volatility and a 3-day window for momentum.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:30:29.524747"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1288771707250119,
        "ICIR": 0.0352252939378359,
        "1day.excess_return_without_cost.std": 0.0050731553342085,
        "1day.excess_return_with_cost.annualized_return": 0.0281612557745195,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003200351272904,
        "1day.excess_return_without_cost.annualized_return": 0.076168360295122,
        "1day.excess_return_with_cost.std": 0.0050752503383375,
        "Rank IC": 0.0189769585555903,
        "IC": 0.0051754215553159,
        "1day.excess_return_without_cost.max_drawdown": -0.11034884745729,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9732131485751788,
        "1day.pa": 0.0,
        "l2.valid": 0.9962042319366832,
        "Rank ICIR": 0.1297344033378602,
        "l2.train": 0.992492442635101,
        "1day.excess_return_with_cost.information_ratio": 0.3596715361025471,
        "1day.excess_return_with_cost.mean": 0.0001183246040946
      },
      "feedback": {
        "observations": "The current iteration focused on 'Asymmetric Volatility Rejection' (AVR) by combining intraday shadow dynamics with short-term price momentum. The results show a significant improvement in Annualized Return (7.62% vs 5.20%) and a slight edge in Information Ratio (0.973 vs 0.972). However, the IC is slightly lower than the SOTA (0.0052 vs 0.0058), and the Max Drawdown has increased considerably (-0.110 vs -0.072), suggesting that while the signal is more potent in terms of raw return, it has introduced higher volatility and tail risk.",
        "hypothesis_evaluation": "The hypothesis that a dominant lower shadow combined with negative price acceleration predicts reversals is supported by the improved annualized returns. The 'AVR_Shadow_Asymmetry_10D' implementation successfully captures alpha. However, the high drawdown suggests that the '10-day volatility of the shadow ratio' might be too noisy or unstable for normalization, leading to inconsistent performance during market stress.",
        "decision": true,
        "reason": "The current AVR approach uses a complex denominator (TS_STD of a ratio) which can explode if the upper shadow is consistently small, leading to extreme factor values and high drawdowns. By switching to a 'Lower Shadow / Total Shadow' formulation, we bound the ratio between 0 and 1. Incorporating volume will help confirm if the 'rejection' (the lower shadow) occurred with high conviction, potentially filtering out the false signals that contributed to the increased drawdown in the current SOTA."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "14510366cd4041e9bf114d8592e81615",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/14510366cd4041e9bf114d8592e81615/result.h5"
      }
    },
    "93a228245c1043fe": {
      "factor_id": "93a228245c1043fe",
      "factor_name": "ZScore_Shadow_Ratio_MOM_3D",
      "factor_expression": "ZSCORE((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6)) * MAX(-TS_PCTCHANGE($close, 3), 0)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6)) * MAX(-TS_PCTCHANGE($close, 3), 0)\" # Your output factor expression will be filled in here\n    name = \"ZScore_Shadow_Ratio_MOM_3D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A simplified version of the AVR hypothesis that uses cross-sectional Z-scores of the shadow ratio to identify extreme intraday rejections, weighted by the magnitude of the recent 3-day price decline.",
      "factor_formulation": "Factor = ZSCORE(\\frac{min(open, close) - low + 1e-6}{high - max(open, close) + 1e-6}) \\cdot MAX(-TS\\_PCTCHANGE(close, 3), 0)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Asymmetric Volatility Rejection' (AVR), where a dominant lower shadow relative to the upper shadow is validated by a 3-day negative price acceleration and normalized by the 10-day volatility of the shadow ratio itself.\n                Concise Observation: Previous attempts failed because they used the total daily range or ATR for normalization, which conflates general volatility with specific rejection strength. Furthermore, they lacked a momentum pre-condition, causing the signal to trigger in neutral or bullish regimes where 'reversal' logic is inapplicable.\n                Concise Justification: Focusing on the ratio of the lower shadow to the upper shadow (Shadow Ratio) isolates the direction of intraday price rejection. By conditioning this on a 3-day negative return, we ensure the factor only captures 'bottoming' behavior. Normalizing by the standard deviation of this ratio over 10 days ensures the signal is statistically significant relative to the stock's typical intraday behavior.\n                Concise Knowledge: If a stock exhibits a high ratio of lower-to-upper shadow (asymmetry) following a period of accelerating price decline (negative 3-day return), it indicates a climax in selling pressure; when this asymmetry is extreme relative to its own 10-day historical distribution, the probability of a mean-reversion event is maximized.\n                concise Specification: 1. Lower Shadow (LS) = min(open, close) - low; 2. Upper Shadow (US) = high - max(open, close); 3. Shadow Ratio (SR) = (LS + 1e-6) / (US + 1e-6); 4. Momentum (MOM3) = close / ref(close, 3) - 1; 5. Factor = (SR / std(SR, 10)) * (MOM3 < 0 ? abs(MOM3) : 0). The final factor uses a 10-day window for volatility and a 3-day window for momentum.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:30:29.524747"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1288771707250119,
        "ICIR": 0.0352252939378359,
        "1day.excess_return_without_cost.std": 0.0050731553342085,
        "1day.excess_return_with_cost.annualized_return": 0.0281612557745195,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003200351272904,
        "1day.excess_return_without_cost.annualized_return": 0.076168360295122,
        "1day.excess_return_with_cost.std": 0.0050752503383375,
        "Rank IC": 0.0189769585555903,
        "IC": 0.0051754215553159,
        "1day.excess_return_without_cost.max_drawdown": -0.11034884745729,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9732131485751788,
        "1day.pa": 0.0,
        "l2.valid": 0.9962042319366832,
        "Rank ICIR": 0.1297344033378602,
        "l2.train": 0.992492442635101,
        "1day.excess_return_with_cost.information_ratio": 0.3596715361025471,
        "1day.excess_return_with_cost.mean": 0.0001183246040946
      },
      "feedback": {
        "observations": "The current iteration focused on 'Asymmetric Volatility Rejection' (AVR) by combining intraday shadow dynamics with short-term price momentum. The results show a significant improvement in Annualized Return (7.62% vs 5.20%) and a slight edge in Information Ratio (0.973 vs 0.972). However, the IC is slightly lower than the SOTA (0.0052 vs 0.0058), and the Max Drawdown has increased considerably (-0.110 vs -0.072), suggesting that while the signal is more potent in terms of raw return, it has introduced higher volatility and tail risk.",
        "hypothesis_evaluation": "The hypothesis that a dominant lower shadow combined with negative price acceleration predicts reversals is supported by the improved annualized returns. The 'AVR_Shadow_Asymmetry_10D' implementation successfully captures alpha. However, the high drawdown suggests that the '10-day volatility of the shadow ratio' might be too noisy or unstable for normalization, leading to inconsistent performance during market stress.",
        "decision": true,
        "reason": "The current AVR approach uses a complex denominator (TS_STD of a ratio) which can explode if the upper shadow is consistently small, leading to extreme factor values and high drawdowns. By switching to a 'Lower Shadow / Total Shadow' formulation, we bound the ratio between 0 and 1. Incorporating volume will help confirm if the 'rejection' (the lower shadow) occurred with high conviction, potentially filtering out the false signals that contributed to the increased drawdown in the current SOTA."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "d8c621a49df14b64afa07272ebb40040",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/d8c621a49df14b64afa07272ebb40040/result.h5"
      }
    },
    "1f5d2396d8b814fc": {
      "factor_id": "1f5d2396d8b814fc",
      "factor_name": "Relative_Shadow_Strength_V2",
      "factor_expression": "TS_RANK((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6), 10) * (TS_PCTCHANGE($close, 3) < 0 ? 1 : 0)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"TS_RANK((MIN($open, $close) - $low + 1e-6) / ($high - MAX($open, $close) + 1e-6), 10) * (TS_PCTCHANGE($close, 3) < 0 ? 1 : 0)\" # Your output factor expression will be filled in here\n    name = \"Relative_Shadow_Strength_V2\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies reversal points by comparing the lower shadow's dominance over the upper shadow, normalized by the 10-day time-series rank of this ratio, specifically when the 3-day return is negative.",
      "factor_formulation": "Factor = TS\\_RANK(\\frac{min(open, close) - low + 1e-6}{high - max(open, close) + 1e-6}, 10) \\cdot (TS\\_PCTCHANGE(close, 3) < 0 ? 1 : 0)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Asymmetric Volatility Rejection' (AVR), where a dominant lower shadow relative to the upper shadow is validated by a 3-day negative price acceleration and normalized by the 10-day volatility of the shadow ratio itself.\n                Concise Observation: Previous attempts failed because they used the total daily range or ATR for normalization, which conflates general volatility with specific rejection strength. Furthermore, they lacked a momentum pre-condition, causing the signal to trigger in neutral or bullish regimes where 'reversal' logic is inapplicable.\n                Concise Justification: Focusing on the ratio of the lower shadow to the upper shadow (Shadow Ratio) isolates the direction of intraday price rejection. By conditioning this on a 3-day negative return, we ensure the factor only captures 'bottoming' behavior. Normalizing by the standard deviation of this ratio over 10 days ensures the signal is statistically significant relative to the stock's typical intraday behavior.\n                Concise Knowledge: If a stock exhibits a high ratio of lower-to-upper shadow (asymmetry) following a period of accelerating price decline (negative 3-day return), it indicates a climax in selling pressure; when this asymmetry is extreme relative to its own 10-day historical distribution, the probability of a mean-reversion event is maximized.\n                concise Specification: 1. Lower Shadow (LS) = min(open, close) - low; 2. Upper Shadow (US) = high - max(open, close); 3. Shadow Ratio (SR) = (LS + 1e-6) / (US + 1e-6); 4. Momentum (MOM3) = close / ref(close, 3) - 1; 5. Factor = (SR / std(SR, 10)) * (MOM3 < 0 ? abs(MOM3) : 0). The final factor uses a 10-day window for volatility and a 3-day window for momentum.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:30:29.524747"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1288771707250119,
        "ICIR": 0.0352252939378359,
        "1day.excess_return_without_cost.std": 0.0050731553342085,
        "1day.excess_return_with_cost.annualized_return": 0.0281612557745195,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003200351272904,
        "1day.excess_return_without_cost.annualized_return": 0.076168360295122,
        "1day.excess_return_with_cost.std": 0.0050752503383375,
        "Rank IC": 0.0189769585555903,
        "IC": 0.0051754215553159,
        "1day.excess_return_without_cost.max_drawdown": -0.11034884745729,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9732131485751788,
        "1day.pa": 0.0,
        "l2.valid": 0.9962042319366832,
        "Rank ICIR": 0.1297344033378602,
        "l2.train": 0.992492442635101,
        "1day.excess_return_with_cost.information_ratio": 0.3596715361025471,
        "1day.excess_return_with_cost.mean": 0.0001183246040946
      },
      "feedback": {
        "observations": "The current iteration focused on 'Asymmetric Volatility Rejection' (AVR) by combining intraday shadow dynamics with short-term price momentum. The results show a significant improvement in Annualized Return (7.62% vs 5.20%) and a slight edge in Information Ratio (0.973 vs 0.972). However, the IC is slightly lower than the SOTA (0.0052 vs 0.0058), and the Max Drawdown has increased considerably (-0.110 vs -0.072), suggesting that while the signal is more potent in terms of raw return, it has introduced higher volatility and tail risk.",
        "hypothesis_evaluation": "The hypothesis that a dominant lower shadow combined with negative price acceleration predicts reversals is supported by the improved annualized returns. The 'AVR_Shadow_Asymmetry_10D' implementation successfully captures alpha. However, the high drawdown suggests that the '10-day volatility of the shadow ratio' might be too noisy or unstable for normalization, leading to inconsistent performance during market stress.",
        "decision": true,
        "reason": "The current AVR approach uses a complex denominator (TS_STD of a ratio) which can explode if the upper shadow is consistently small, leading to extreme factor values and high drawdowns. By switching to a 'Lower Shadow / Total Shadow' formulation, we bound the ratio between 0 and 1. Incorporating volume will help confirm if the 'rejection' (the lower shadow) occurred with high conviction, potentially filtering out the false signals that contributed to the increased drawdown in the current SOTA."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "9f4e3f6b4ca348009347774fca0c7cb7",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/9f4e3f6b4ca348009347774fca0c7cb7/result.h5"
      }
    },
    "9d10d82cab988ab3": {
      "factor_id": "9d10d82cab988ab3",
      "factor_name": "Volume_Force_Divergence_20D",
      "factor_expression": "TS_MEAN(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_RANK($volume * $return, 20)), 5)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"TS_MEAN(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_RANK($volume * TS_PCTCHANGE($close, 1), 20)), 5)\" # Your output factor expression will be filled in here\n    name = \"Volume_Force_Divergence_20D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the divergence between price momentum and the intensity of 'Volume Force' (Volume multiplied by Price Change). By comparing the cross-sectional rank of 20-day returns with the cross-sectional rank of the 20-day time-series rank of Volume Force, it identifies assets where price trends are supported by high-conviction institutional capital flows.",
      "factor_formulation": "\\text{TS_MEAN}(\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS_RANK}(\\text{volume} \\times \\text{return}, 20)), 5)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor measuring the divergence between price momentum and the persistence of 'Volume Force' (Volume * Price Change) identifies sustainable institutional trends by filtering for directional consistency rather than just volume magnitude.\n                Concise Observation: Previous attempts to use volume stability (inverse of standard deviation) as a filter failed because they penalized high-volume breakouts and created outlier issues; however, price-volume divergence remains a strong core signal.\n                Concise Justification: By using the 20-day Time-Series Rank of Volume Force, we capture the relative intensity of buying/selling pressure. Measuring the divergence between this 'Force Rank' and 'Price Rank' identifies assets where price moves are disproportionately supported by high-conviction capital flows.\n                Concise Knowledge: In quant investment, institutional accumulation is more accurately identified by the directional persistence of capital flow (Volume Force) than by volume magnitude alone; if price momentum is supported by consistent positive Volume Force, the trend is more likely to be sustainable.\n                concise Specification: The factor is defined as the cross-sectional Rank of 20-day price returns minus the cross-sectional Rank of the 20-day Time-Series Rank of (Volume * TS_PCTCHANGE(Close, 1)). The final value is smoothed by a 5-day moving average to ensure signal stability.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:37:46.753240"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1161177602321872,
        "ICIR": 0.0538948975462076,
        "1day.excess_return_without_cost.std": 0.0049268372833885,
        "1day.excess_return_with_cost.annualized_return": 0.0090030976135111,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002355842260743,
        "1day.excess_return_without_cost.annualized_return": 0.0560690458056885,
        "1day.excess_return_with_cost.std": 0.0049283012298274,
        "Rank IC": 0.0240564389770063,
        "IC": 0.0073218574438625,
        "1day.excess_return_without_cost.max_drawdown": -0.0913074739813558,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7376773815892657,
        "1day.pa": 0.0,
        "l2.valid": 0.9967397500747665,
        "Rank ICIR": 0.1808775523720896,
        "l2.train": 0.9936588352025156,
        "1day.excess_return_with_cost.information_ratio": 0.1184148680129671,
        "1day.excess_return_with_cost.mean": 3.7828141233240256e-05
      },
      "feedback": {
        "observations": "The current iteration explores the 'Volume Force' divergence hypothesis using three different mathematical treatments: time-series ranking (Volume_Force_Divergence_20D), Z-score averaging (Consistent_Force_Trend_Factor), and cumulative summation (Institutional_Flow_Persistence_Index). The results show a notable improvement in the Information Coefficient (IC) reaching 0.007322 and a significant reduction in Max Drawdown (-0.0913 vs -0.1064), indicating that the core concept of filtering momentum with volume-weighted price change is effective at capturing risk-adjusted signals. However, the annualized return (0.056) and Information Ratio (0.737) still lag behind the SOTA, suggesting that while the signal is more 'correct' on average (higher IC), it may be less aggressive or timely in its entry/exit points compared to the SOTA.",
        "hypothesis_evaluation": "The hypothesis that divergence between price momentum and Volume Force identifies sustainable trends is supported by the improved IC and lower Max Drawdown. The 'Volume Force' (Volume * Return) effectively acts as a quality filter for price trends. The results suggest that 'Persistence' (captured via TS_SUM or TS_MEAN) is a valid dimension, but the current implementations might be over-smoothing the signal, leading to lower annualized returns despite better directional accuracy.",
        "decision": false,
        "reason": "The current factors use a subtraction of ranks (RANK(Price) - RANK(Volume Force)), which can be noisy. A ratio-based approach (Efficiency) better captures the 'conviction' of institutional flows. By normalizing Volume Force against its own historical volatility or total volume, we can better distinguish between high-conviction institutional accumulation and high-volume retail speculation. Furthermore, reducing the smoothing window (from 5 to 3) may recover the lost annualized return observed in this iteration."
      },
      "cache_location": null
    },
    "6986c01ced70113d": {
      "factor_id": "6986c01ced70113d",
      "factor_name": "Consistent_Force_Trend_Factor",
      "factor_expression": "WMA(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_MEAN(TS_ZSCORE($volume * $return, 20), 10)), 5)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"WMA(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_MEAN(TS_ZSCORE($volume * TS_PCTCHANGE($close, 1), 20), 10)), 5)\" # Your output factor expression will be filled in here\n    name = \"Consistent_Force_Trend_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor focuses on the directional consistency of capital flows. It calculates the divergence between price momentum and the 20-day average of the 'Volume Force' Z-score. The signal is smoothed to capture sustainable institutional trends where price movement aligns with persistent buying or selling pressure.",
      "factor_formulation": "\\text{WMA}(\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS_MEAN}(\\text{TS_ZSCORE}(\\text{volume} \\times \\text{return}, 20), 10)), 5)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor measuring the divergence between price momentum and the persistence of 'Volume Force' (Volume * Price Change) identifies sustainable institutional trends by filtering for directional consistency rather than just volume magnitude.\n                Concise Observation: Previous attempts to use volume stability (inverse of standard deviation) as a filter failed because they penalized high-volume breakouts and created outlier issues; however, price-volume divergence remains a strong core signal.\n                Concise Justification: By using the 20-day Time-Series Rank of Volume Force, we capture the relative intensity of buying/selling pressure. Measuring the divergence between this 'Force Rank' and 'Price Rank' identifies assets where price moves are disproportionately supported by high-conviction capital flows.\n                Concise Knowledge: In quant investment, institutional accumulation is more accurately identified by the directional persistence of capital flow (Volume Force) than by volume magnitude alone; if price momentum is supported by consistent positive Volume Force, the trend is more likely to be sustainable.\n                concise Specification: The factor is defined as the cross-sectional Rank of 20-day price returns minus the cross-sectional Rank of the 20-day Time-Series Rank of (Volume * TS_PCTCHANGE(Close, 1)). The final value is smoothed by a 5-day moving average to ensure signal stability.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:37:46.753240"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1161177602321872,
        "ICIR": 0.0538948975462076,
        "1day.excess_return_without_cost.std": 0.0049268372833885,
        "1day.excess_return_with_cost.annualized_return": 0.0090030976135111,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002355842260743,
        "1day.excess_return_without_cost.annualized_return": 0.0560690458056885,
        "1day.excess_return_with_cost.std": 0.0049283012298274,
        "Rank IC": 0.0240564389770063,
        "IC": 0.0073218574438625,
        "1day.excess_return_without_cost.max_drawdown": -0.0913074739813558,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7376773815892657,
        "1day.pa": 0.0,
        "l2.valid": 0.9967397500747665,
        "Rank ICIR": 0.1808775523720896,
        "l2.train": 0.9936588352025156,
        "1day.excess_return_with_cost.information_ratio": 0.1184148680129671,
        "1day.excess_return_with_cost.mean": 3.7828141233240256e-05
      },
      "feedback": {
        "observations": "The current iteration explores the 'Volume Force' divergence hypothesis using three different mathematical treatments: time-series ranking (Volume_Force_Divergence_20D), Z-score averaging (Consistent_Force_Trend_Factor), and cumulative summation (Institutional_Flow_Persistence_Index). The results show a notable improvement in the Information Coefficient (IC) reaching 0.007322 and a significant reduction in Max Drawdown (-0.0913 vs -0.1064), indicating that the core concept of filtering momentum with volume-weighted price change is effective at capturing risk-adjusted signals. However, the annualized return (0.056) and Information Ratio (0.737) still lag behind the SOTA, suggesting that while the signal is more 'correct' on average (higher IC), it may be less aggressive or timely in its entry/exit points compared to the SOTA.",
        "hypothesis_evaluation": "The hypothesis that divergence between price momentum and Volume Force identifies sustainable trends is supported by the improved IC and lower Max Drawdown. The 'Volume Force' (Volume * Return) effectively acts as a quality filter for price trends. The results suggest that 'Persistence' (captured via TS_SUM or TS_MEAN) is a valid dimension, but the current implementations might be over-smoothing the signal, leading to lower annualized returns despite better directional accuracy.",
        "decision": false,
        "reason": "The current factors use a subtraction of ranks (RANK(Price) - RANK(Volume Force)), which can be noisy. A ratio-based approach (Efficiency) better captures the 'conviction' of institutional flows. By normalizing Volume Force against its own historical volatility or total volume, we can better distinguish between high-conviction institutional accumulation and high-volume retail speculation. Furthermore, reducing the smoothing window (from 5 to 3) may recover the lost annualized return observed in this iteration."
      },
      "cache_location": null
    },
    "c3e765aba96a8ebb": {
      "factor_id": "c3e765aba96a8ebb",
      "factor_name": "Institutional_Flow_Persistence_Index",
      "factor_expression": "EMA(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_SUM($volume * $return, 20)), 5)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"EMA(RANK(TS_PCTCHANGE($close, 20)) - RANK(TS_SUM($volume * TS_PCTCHANGE($close, 1), 20)), 5)\" # Your output factor expression will be filled in here\n    name = \"Institutional_Flow_Persistence_Index\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A simplified version of the Volume Force hypothesis that identifies divergence by comparing the rank of 20-day price performance against the rank of the cumulative Volume Force over the same period. It uses a 5-day EMA for smoothing to provide a more responsive yet stable signal.",
      "factor_formulation": "\\text{EMA}(\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 20)) - \\text{RANK}(\\text{TS_SUM}(\\text{volume} \\times \\text{return}, 20)), 5)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor measuring the divergence between price momentum and the persistence of 'Volume Force' (Volume * Price Change) identifies sustainable institutional trends by filtering for directional consistency rather than just volume magnitude.\n                Concise Observation: Previous attempts to use volume stability (inverse of standard deviation) as a filter failed because they penalized high-volume breakouts and created outlier issues; however, price-volume divergence remains a strong core signal.\n                Concise Justification: By using the 20-day Time-Series Rank of Volume Force, we capture the relative intensity of buying/selling pressure. Measuring the divergence between this 'Force Rank' and 'Price Rank' identifies assets where price moves are disproportionately supported by high-conviction capital flows.\n                Concise Knowledge: In quant investment, institutional accumulation is more accurately identified by the directional persistence of capital flow (Volume Force) than by volume magnitude alone; if price momentum is supported by consistent positive Volume Force, the trend is more likely to be sustainable.\n                concise Specification: The factor is defined as the cross-sectional Rank of 20-day price returns minus the cross-sectional Rank of the 20-day Time-Series Rank of (Volume * TS_PCTCHANGE(Close, 1)). The final value is smoothed by a 5-day moving average to ensure signal stability.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:37:46.753240"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1161177602321872,
        "ICIR": 0.0538948975462076,
        "1day.excess_return_without_cost.std": 0.0049268372833885,
        "1day.excess_return_with_cost.annualized_return": 0.0090030976135111,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002355842260743,
        "1day.excess_return_without_cost.annualized_return": 0.0560690458056885,
        "1day.excess_return_with_cost.std": 0.0049283012298274,
        "Rank IC": 0.0240564389770063,
        "IC": 0.0073218574438625,
        "1day.excess_return_without_cost.max_drawdown": -0.0913074739813558,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7376773815892657,
        "1day.pa": 0.0,
        "l2.valid": 0.9967397500747665,
        "Rank ICIR": 0.1808775523720896,
        "l2.train": 0.9936588352025156,
        "1day.excess_return_with_cost.information_ratio": 0.1184148680129671,
        "1day.excess_return_with_cost.mean": 3.7828141233240256e-05
      },
      "feedback": {
        "observations": "The current iteration explores the 'Volume Force' divergence hypothesis using three different mathematical treatments: time-series ranking (Volume_Force_Divergence_20D), Z-score averaging (Consistent_Force_Trend_Factor), and cumulative summation (Institutional_Flow_Persistence_Index). The results show a notable improvement in the Information Coefficient (IC) reaching 0.007322 and a significant reduction in Max Drawdown (-0.0913 vs -0.1064), indicating that the core concept of filtering momentum with volume-weighted price change is effective at capturing risk-adjusted signals. However, the annualized return (0.056) and Information Ratio (0.737) still lag behind the SOTA, suggesting that while the signal is more 'correct' on average (higher IC), it may be less aggressive or timely in its entry/exit points compared to the SOTA.",
        "hypothesis_evaluation": "The hypothesis that divergence between price momentum and Volume Force identifies sustainable trends is supported by the improved IC and lower Max Drawdown. The 'Volume Force' (Volume * Return) effectively acts as a quality filter for price trends. The results suggest that 'Persistence' (captured via TS_SUM or TS_MEAN) is a valid dimension, but the current implementations might be over-smoothing the signal, leading to lower annualized returns despite better directional accuracy.",
        "decision": false,
        "reason": "The current factors use a subtraction of ranks (RANK(Price) - RANK(Volume Force)), which can be noisy. A ratio-based approach (Efficiency) better captures the 'conviction' of institutional flows. By normalizing Volume Force against its own historical volatility or total volume, we can better distinguish between high-conviction institutional accumulation and high-volume retail speculation. Furthermore, reducing the smoothing window (from 5 to 3) may recover the lost annualized return observed in this iteration."
      },
      "cache_location": null
    },
    "9c2330218fdbe792": {
      "factor_id": "9c2330218fdbe792",
      "factor_name": "VWSD_Rank_Momentum_Stabilized",
      "factor_expression": "((MIN($open, $close) - $low) / ($high - $low - ABS($open - $close) + 1e-6)) * ($volume / (TS_MEAN($volume, 3) + 1e-8)) * RANK(-TS_PCTCHANGE($close, 3))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"((MIN($open, $close) - $low) / ($high - $low - ABS($open - $close) + 1e-6)) * ($volume / (TS_MEAN($volume, 3) + 1e-8)) * RANK(-TS_PCTCHANGE($close, 3))\" # Your output factor expression will be filled in here\n    name = \"VWSD_Rank_Momentum_Stabilized\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor implements Volume-Weighted Shadow Dominance (VWSD) by calculating the ratio of the lower shadow to the total shadow range, bounded between 0 and 1. It weights this dominance by a 3-day volume surge and validates it using a negative 3-day return. To avoid duplication and improve robustness, it uses a rank-based momentum approach instead of a conditional absolute return.",
      "factor_formulation": "VWSD = \\frac{LS}{LS + US + 1e-6} \\times \\frac{volume}{TS\\_MEAN(volume, 3)} \\times RANK(-TS\\_PCTCHANGE(close, 3))",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Volume-Weighted Shadow Dominance' (VWSD), where the proportion of the lower shadow relative to the total shadow is amplified by a 3-day volume surge and conditioned on a 3-day price decline.\n                Concise Observation: The previous 'Asymmetric Volatility Rejection' (AVR) achieved high returns but suffered from high drawdowns due to an unstable 'Shadow Ratio' denominator; bounding the shadow metric and adding volume validation should stabilize the signal.\n                Concise Justification: Using the ratio of the lower shadow to the sum of both shadows (LS / (LS + US)) bounds the price rejection signal between 0 and 1, preventing extreme outliers. Weighting this by relative volume ensures that the 'rejection' is backed by significant capital flow, reducing false positives from low-liquidity noise.\n                Concise Knowledge: In quant equity, if a stock's intraday price rejection (lower shadow) dominates the total shadow length on high relative volume following a 3-day price drop, the probability of a short-term mean-reversion increases; volume acts as a validation of the buying support intensity.\n                concise Specification: 1. Lower Shadow (LS) = min(open, close) - low; 2. Upper Shadow (US) = high - max(open, close); 3. Shadow Dominance (SD) = LS / (LS + US + 1e-6); 4. Volume Surge (VS) = volume / mean(volume, 3); 5. Momentum (MOM3) = close / ref(close, 3) - 1; 6. Factor = SD * VS * (MOM3 < 0 ? abs(MOM3) : 0). All moving averages and momentum calculations use a 3-day window.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:39:10.405446"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.2031560213233271,
        "ICIR": 0.0441246507685381,
        "1day.excess_return_without_cost.std": 0.004684208287791,
        "1day.excess_return_with_cost.annualized_return": -0.0009964492752396,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001946360017391,
        "1day.excess_return_without_cost.annualized_return": 0.0463233684139222,
        "1day.excess_return_with_cost.std": 0.0046870497199878,
        "Rank IC": 0.0219539976115235,
        "IC": 0.0061768795362088,
        "1day.excess_return_without_cost.max_drawdown": -0.1441716570944447,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6410257197922947,
        "1day.pa": 0.0,
        "l2.valid": 0.9963959688516928,
        "Rank ICIR": 0.1644510104422223,
        "l2.train": 0.9935471532119684,
        "1day.excess_return_with_cost.information_ratio": -0.0137805692093849,
        "1day.excess_return_with_cost.mean": -4.186761660670908e-06
      },
      "feedback": {
        "observations": "The experiment tested two implementations of the 'Volume-Weighted Shadow Dominance' (VWSD) hypothesis: VWSD_Rank_Momentum_Stabilized and Volume_Validated_Rejection_Score. The current results show a significant improvement in Information Coefficient (IC) (0.006177 vs. 0.005175), indicating a stronger linear relationship between the factor and future returns. However, the portfolio-based metrics (Annualized Return, Information Ratio, and Max Drawdown) have deteriorated compared to the SOTA. This suggests that while the core signal (shadow dominance + volume) is predictive, the current weighting or the specific momentum/price-to-median components may be introducing noise or volatility that reduces risk-adjusted performance.",
        "hypothesis_evaluation": "The hypothesis that VWSD drives short-term reversals is partially supported by the improved IC. The use of 'LS / (LS + US)' combined with volume surges effectively captures price rejection. However, the 'VWRS' implementation using the price-to-median ratio and the 'VWSD_Rank' implementation using cross-sectional ranking seem to capture the signal differently. The drop in Annualized Return suggests that the 'price decline' condition needs to be more precisely defined—perhaps using volatility-adjusted price drops rather than simple ratios or ranks to better filter for true exhaustion points.",
        "decision": false,
        "reason": "The current IC improvement shows the shadow dominance signal is valid, but the poor IR and drawdown suggest the factor triggers too frequently or in non-extreme conditions. By incorporating the True Range (High-Low) and anchoring the price rejection to a volatility-normalized range (e.g., using a stochastic-like position within the recent range), we can ensure the shadow dominance is only weighted heavily when price is at a statistically significant 'oversold' level, reducing false positives and improving the Information Ratio."
      },
      "cache_location": {
        "workspace_suffix": "exp_20260119_210519",
        "workspace_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519",
        "factor_dir": "aff0c9c2569a426ca9f44e390aa6cc08",
        "result_h5_path": "/mnt/DATA/quantagent/AlphaAgent/RD-Agent_workspace_exp_20260119_210519/aff0c9c2569a426ca9f44e390aa6cc08/result.h5"
      }
    },
    "feb2d6508a26c76f": {
      "factor_id": "feb2d6508a26c76f",
      "factor_name": "Shadow_Dominance_Intensity_Index",
      "factor_expression": "((MIN($open, $close) - $low) / ($high - MAX($open, $close) + MIN($open, $close) - $low + 1e-6)) * TS_ZSCORE($volume / ($high - $low + 1e-8), 3) * MAX(0, -TS_ZSCORE(TS_PCTCHANGE($close, 3), 10))",
      "factor_implementation_code": "",
      "factor_description": "A variation of the VWSD hypothesis that focuses on the 'cleanliness' of the price rejection. It calculates shadow dominance as the lower shadow relative to the sum of shadows, scaled by the 3-day volume-to-price-range intensity. It uses a Z-score of the 3-day return to identify oversold conditions without using a binary if-else trigger.",
      "factor_formulation": "SDII = \\frac{LS}{LS + US + 1e-6} \\times TS\\_ZSCORE(\\frac{volume}{high - low + 1e-8}, 3) \\times MAX(0, -TS\\_ZSCORE(TS\\_PCTCHANGE(close, 3), 10))",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Volume-Weighted Shadow Dominance' (VWSD), where the proportion of the lower shadow relative to the total shadow is amplified by a 3-day volume surge and conditioned on a 3-day price decline.\n                Concise Observation: The previous 'Asymmetric Volatility Rejection' (AVR) achieved high returns but suffered from high drawdowns due to an unstable 'Shadow Ratio' denominator; bounding the shadow metric and adding volume validation should stabilize the signal.\n                Concise Justification: Using the ratio of the lower shadow to the sum of both shadows (LS / (LS + US)) bounds the price rejection signal between 0 and 1, preventing extreme outliers. Weighting this by relative volume ensures that the 'rejection' is backed by significant capital flow, reducing false positives from low-liquidity noise.\n                Concise Knowledge: In quant equity, if a stock's intraday price rejection (lower shadow) dominates the total shadow length on high relative volume following a 3-day price drop, the probability of a short-term mean-reversion increases; volume acts as a validation of the buying support intensity.\n                concise Specification: 1. Lower Shadow (LS) = min(open, close) - low; 2. Upper Shadow (US) = high - max(open, close); 3. Shadow Dominance (SD) = LS / (LS + US + 1e-6); 4. Volume Surge (VS) = volume / mean(volume, 3); 5. Momentum (MOM3) = close / ref(close, 3) - 1; 6. Factor = SD * VS * (MOM3 < 0 ? abs(MOM3) : 0). All moving averages and momentum calculations use a 3-day window.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:39:10.405446"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.2031560213233271,
        "ICIR": 0.0441246507685381,
        "1day.excess_return_without_cost.std": 0.004684208287791,
        "1day.excess_return_with_cost.annualized_return": -0.0009964492752396,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001946360017391,
        "1day.excess_return_without_cost.annualized_return": 0.0463233684139222,
        "1day.excess_return_with_cost.std": 0.0046870497199878,
        "Rank IC": 0.0219539976115235,
        "IC": 0.0061768795362088,
        "1day.excess_return_without_cost.max_drawdown": -0.1441716570944447,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6410257197922947,
        "1day.pa": 0.0,
        "l2.valid": 0.9963959688516928,
        "Rank ICIR": 0.1644510104422223,
        "l2.train": 0.9935471532119684,
        "1day.excess_return_with_cost.information_ratio": -0.0137805692093849,
        "1day.excess_return_with_cost.mean": -4.186761660670908e-06
      },
      "feedback": {
        "observations": "The experiment tested two implementations of the 'Volume-Weighted Shadow Dominance' (VWSD) hypothesis: VWSD_Rank_Momentum_Stabilized and Volume_Validated_Rejection_Score. The current results show a significant improvement in Information Coefficient (IC) (0.006177 vs. 0.005175), indicating a stronger linear relationship between the factor and future returns. However, the portfolio-based metrics (Annualized Return, Information Ratio, and Max Drawdown) have deteriorated compared to the SOTA. This suggests that while the core signal (shadow dominance + volume) is predictive, the current weighting or the specific momentum/price-to-median components may be introducing noise or volatility that reduces risk-adjusted performance.",
        "hypothesis_evaluation": "The hypothesis that VWSD drives short-term reversals is partially supported by the improved IC. The use of 'LS / (LS + US)' combined with volume surges effectively captures price rejection. However, the 'VWRS' implementation using the price-to-median ratio and the 'VWSD_Rank' implementation using cross-sectional ranking seem to capture the signal differently. The drop in Annualized Return suggests that the 'price decline' condition needs to be more precisely defined—perhaps using volatility-adjusted price drops rather than simple ratios or ranks to better filter for true exhaustion points.",
        "decision": false,
        "reason": "The current IC improvement shows the shadow dominance signal is valid, but the poor IR and drawdown suggest the factor triggers too frequently or in non-extreme conditions. By incorporating the True Range (High-Low) and anchoring the price rejection to a volatility-normalized range (e.g., using a stochastic-like position within the recent range), we can ensure the shadow dominance is only weighted heavily when price is at a statistically significant 'oversold' level, reducing false positives and improving the Information Ratio."
      },
      "cache_location": null
    },
    "309121c9e4c5b1cd": {
      "factor_id": "309121c9e4c5b1cd",
      "factor_name": "Volume_Validated_Rejection_Score",
      "factor_expression": "((MIN($open, $close) - $low) / ($high - $low - ABS($open - $close) + 1e-6)) * ($volume / (TS_MEAN($volume, 3) + 1e-8)) * (TS_MEDIAN($close, 3) / ($close + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"((MIN($open, $close) - $low) / ((MIN($open, $close) - $low) + ($high - MAX($open, $close)) + 1e-6)) * ($volume / (TS_MEAN($volume, 3) + 1e-8)) * (TS_MEDIAN($close, 3) / ($close + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Volume_Validated_Rejection_Score\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures short-term reversals by multiplying the bounded shadow dominance ratio with a volume surge factor. It replaces the duplicated momentum logic with a 3-day price-to-median ratio to identify stocks trading significantly below their recent median price, signaling a potential bounce.",
      "factor_formulation": "VVRS = \\frac{LS}{LS + US + 1e-6} \\times \\frac{volume}{TS\\_MEAN(volume, 3)} \\times (TS\\_MEDIAN(close, 3) / close)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-20-154982",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: Short-term reversals are driven by 'Volume-Weighted Shadow Dominance' (VWSD), where the proportion of the lower shadow relative to the total shadow is amplified by a 3-day volume surge and conditioned on a 3-day price decline.\n                Concise Observation: The previous 'Asymmetric Volatility Rejection' (AVR) achieved high returns but suffered from high drawdowns due to an unstable 'Shadow Ratio' denominator; bounding the shadow metric and adding volume validation should stabilize the signal.\n                Concise Justification: Using the ratio of the lower shadow to the sum of both shadows (LS / (LS + US)) bounds the price rejection signal between 0 and 1, preventing extreme outliers. Weighting this by relative volume ensures that the 'rejection' is backed by significant capital flow, reducing false positives from low-liquidity noise.\n                Concise Knowledge: In quant equity, if a stock's intraday price rejection (lower shadow) dominates the total shadow length on high relative volume following a 3-day price drop, the probability of a short-term mean-reversion increases; volume acts as a validation of the buying support intensity.\n                concise Specification: 1. Lower Shadow (LS) = min(open, close) - low; 2. Upper Shadow (US) = high - max(open, close); 3. Shadow Dominance (SD) = LS / (LS + US + 1e-6); 4. Volume Surge (VS) = volume / mean(volume, 3); 5. Momentum (MOM3) = close / ref(close, 3) - 1; 6. Factor = SD * VS * (MOM3 < 0 ? abs(MOM3) : 0). All moving averages and momentum calculations use a 3-day window.\n                ",
        "initial_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "planning_direction": "参考以下组合给出假设。组合3包含RESI5（表达式：Resi(, 5)/，含义：5日线性回归残差，反映价格偏离趋势程度）、KLOW（表达式：(Less(, )-)/，含义：K线下影线长度，反映盘中支撑力度）、STD5（表达式：Std(, 5)/，含义：5日收盘价标准差，衡量纯价格波动幅度）。",
        "created_at": "2026-01-19T21:39:10.405446"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.2031560213233271,
        "ICIR": 0.0441246507685381,
        "1day.excess_return_without_cost.std": 0.004684208287791,
        "1day.excess_return_with_cost.annualized_return": -0.0009964492752396,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001946360017391,
        "1day.excess_return_without_cost.annualized_return": 0.0463233684139222,
        "1day.excess_return_with_cost.std": 0.0046870497199878,
        "Rank IC": 0.0219539976115235,
        "IC": 0.0061768795362088,
        "1day.excess_return_without_cost.max_drawdown": -0.1441716570944447,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6410257197922947,
        "1day.pa": 0.0,
        "l2.valid": 0.9963959688516928,
        "Rank ICIR": 0.1644510104422223,
        "l2.train": 0.9935471532119684,
        "1day.excess_return_with_cost.information_ratio": -0.0137805692093849,
        "1day.excess_return_with_cost.mean": -4.186761660670908e-06
      },
      "feedback": {
        "observations": "The experiment tested two implementations of the 'Volume-Weighted Shadow Dominance' (VWSD) hypothesis: VWSD_Rank_Momentum_Stabilized and Volume_Validated_Rejection_Score. The current results show a significant improvement in Information Coefficient (IC) (0.006177 vs. 0.005175), indicating a stronger linear relationship between the factor and future returns. However, the portfolio-based metrics (Annualized Return, Information Ratio, and Max Drawdown) have deteriorated compared to the SOTA. This suggests that while the core signal (shadow dominance + volume) is predictive, the current weighting or the specific momentum/price-to-median components may be introducing noise or volatility that reduces risk-adjusted performance.",
        "hypothesis_evaluation": "The hypothesis that VWSD drives short-term reversals is partially supported by the improved IC. The use of 'LS / (LS + US)' combined with volume surges effectively captures price rejection. However, the 'VWRS' implementation using the price-to-median ratio and the 'VWSD_Rank' implementation using cross-sectional ranking seem to capture the signal differently. The drop in Annualized Return suggests that the 'price decline' condition needs to be more precisely defined—perhaps using volatility-adjusted price drops rather than simple ratios or ranks to better filter for true exhaustion points.",
        "decision": false,
        "reason": "The current IC improvement shows the shadow dominance signal is valid, but the poor IR and drawdown suggest the factor triggers too frequently or in non-extreme conditions. By incorporating the True Range (High-Low) and anchoring the price rejection to a volatility-normalized range (e.g., using a stochastic-like position within the recent range), we can ensure the shadow dominance is only weighted heavily when price is at a statistically significant 'oversold' level, reducing false positives and improving the Information Ratio."
      },
      "cache_location": null
    },
    "deb2ce3fe808a48f": {
      "factor_id": "deb2ce3fe808a48f",
      "factor_name": "Volume_Force_Efficiency_Ratio_20D",
      "factor_expression": "SMA(ZSCORE(TS_MEAN($volume * $return, 20) / (TS_STD($return, 20) + 1e-6)), 3, 1)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"SMA(ZSCORE(TS_MEAN($volume * TS_PCTCHANGE($close, 1), 20) / (TS_STD(TS_PCTCHANGE($close, 1), 20) + 1e-6)), 3, 1)\" # Your output factor expression will be filled in here\n    name = \"Volume_Force_Efficiency_Ratio_20D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the 'Volume-Price Synergy' by calculating the ratio of the 20-day average Volume Force (Volume * Return) to the 20-day standard deviation of price returns. It identifies high-conviction trends where directional capital flow is high relative to price volatility, smoothed by a 3-day moving average for timeliness.",
      "factor_formulation": "SMA(ZSCORE(\\frac{TS\\_MEAN(volume \\cdot return, 20)}{TS\\_STD(return, 20) + 1e-6}), 3, 1)",
      "metadata": {
        "experiment_id": "2026-01-19_13-05-39-450069",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: A factor that measures the 'Volume-Price Synergy' by calculating the ratio of smoothed Volume Force to the standard deviation of price returns identifies high-conviction trends with superior risk-adjusted efficiency.\n                Concise Observation: Previous iterations showed that 'Volume Force' improves IC and drawdown, but rank-based subtraction and over-smoothing (5-day MA) lead to lagging signals and lower annualized returns compared to the SOTA.\n                Concise Justification: The 'Efficiency' of a trend is best captured by normalizing the directional capital flow (Volume Force) by the price risk (Volatility). A ratio-based approach provides a more granular signal than rank differences, and a shorter smoothing window (3-day) preserves the timeliness of the alpha.\n                Concise Knowledge: If a price trend is supported by consistent Volume Force (Volume * Return) while maintaining low price volatility, it indicates a high-conviction institutional move; conversely, trends with high price dispersion relative to volume force are likely speculative and prone to reversal.\n                concise Specification: The factor is defined as: TS_MEAN(Volume * TS_PCTCHANGE(Close, 1), 20) / (TS_STD(Close / TS_DELAY(Close, 1) - 1, 20) + 1e-6). The final output is the 3-day moving average of the cross-sectional Z-score of this ratio.\n                ",
        "initial_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "planning_direction": "参考以下组合给出假设。组合2包含ROC60（表达式：Ref(, 60)/，含义：60日价格反转因子，值>1表示长期下跌）、CORR20（表达式：Corr(, Log(+1), 20)，含义：20日收盘价与成交量对数的相关系数）、VSTD5（表达式：Std(, 5)/(+1e-12)，含义：5日成交量标准差，反映资金流向稳定性）。",
        "created_at": "2026-01-19T21:41:46.095568"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1280692636434181,
        "ICIR": 0.0417549784056506,
        "1day.excess_return_without_cost.std": 0.0053206710761932,
        "1day.excess_return_with_cost.annualized_return": 0.0074714385102128,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002281942136644,
        "1day.excess_return_without_cost.annualized_return": 0.0543102228521347,
        "1day.excess_return_with_cost.std": 0.0053212791466124,
        "Rank IC": 0.02226408420592,
        "IC": 0.0062465466258215,
        "1day.excess_return_without_cost.max_drawdown": -0.1090790743971895,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6616475285837199,
        "1day.pa": 0.0,
        "l2.valid": 0.9966454344909348,
        "Rank ICIR": 0.1517096391548497,
        "l2.train": 0.9939751974690456,
        "1day.excess_return_with_cost.information_ratio": 0.0910122196031398,
        "1day.excess_return_with_cost.mean": 3.139259878240711e-05
      },
      "feedback": {
        "observations": "The experiment tested two variations of the 'Volume-Price Synergy' hypothesis: one using volatility normalization (Volume_Force_Efficiency_Ratio_20D) and another using volume-churn normalization (Consistent_Institutional_Flow_Factor_20D). While both factors are theoretically sound, the current results (Information Ratio: 0.66, Annualized Return: 0.054) show a significant deterioration compared to the SOTA (IR: 1.06, Annualized Return: 0.075). The IC is also slightly lower (0.0062 vs 0.0065). This suggests that while the 'Volume Force' concept captures directional flow, the current normalization methods (TS_STD of returns or TS_MEAN of absolute volume-force) might be introducing noise or lagging too much to capture timely alpha.",
        "hypothesis_evaluation": "The hypothesis that Volume-Price Synergy identifies high-conviction trends is partially supported by the positive IC, but the 'efficiency' aspect (the denominator) needs refinement. The current implementation uses a 20-day window for both the numerator and denominator, which may be too slow for the current market regime. The 'Consistent Institutional Flow' approach, which normalizes by the absolute magnitude of volume-price movement, appears more robust in theory than volatility normalization but still failed to beat the SOTA, likely due to the look-back period or the linear nature of the ratio.",
        "decision": false,
        "reason": "The current 20-day window for the numerator (Volume * Return) creates a significant lag. By shortening the numerator's window to 5 days while maintaining a 20-day denominator for normalization, we can identify 'spikes' in conviction that are statistically significant relative to the past month's trading activity. This addresses the 'timeliness' issue observed in the current results while maintaining the core synergy concept. Additionally, keeping the symbol length low and avoiding excessive raw features will prevent the overfitting suggested by the performance gap between this iteration and SOTA."
      },
      "cache_location": null
    }
  }
}
# QuantaAlpha AI V2 - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ¯ é¡¹ç›®æ¦‚è§ˆ

è¿™æ˜¯ä¸€ä¸ªå…¨æ–°è®¾è®¡çš„**å¯¹è¯å¼ AI é©±åŠ¨é‡åŒ–å› å­æŒ–æ˜å¹³å°**ï¼Œæ ¸å¿ƒç‰¹ç‚¹ï¼š

### âœ¨ ä¸»è¦ç‰¹æ€§
1. **è‡ªç„¶è¯­è¨€è¾“å…¥** - ç”¨å¯¹è¯æ–¹å¼æè¿°éœ€æ±‚ï¼Œæ— éœ€ç¼–ç¨‹
2. **å®æ—¶è¿›åº¦å±•ç¤º** - é˜¶æ®µè¯†åˆ«ã€è¿›åº¦æ¡ã€æ—¥å¿—æµ
3. **å®æ—¶å›æµ‹ç»“æœ** - ICæŒ‡æ ‡ã€æ”¶ç›Šç‡ã€å›æ’¤å®æ—¶æ›´æ–°
4. **äº¤äº’å¼å¯è§†åŒ–** - å‡€å€¼æ›²çº¿ã€å›æ’¤åˆ†æã€å› å­åˆ†å¸ƒ
5. **ç°ä»£åŒ–UI** - æ·±è‰²ä¸»é¢˜ã€æµç•…åŠ¨ç”»ã€å“åº”å¼å¸ƒå±€

### ğŸ“ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æµè§ˆå™¨                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         React å‰ç«¯ (localhost:3000)              â”‚  â”‚
â”‚  â”‚  - è¾“å…¥é¢æ¿ (è‡ªç„¶è¯­è¨€)                           â”‚  â”‚
â”‚  â”‚  - æ‰§è¡Œè¿›åº¦é¢æ¿ (å®æ—¶æ—¥å¿—)                       â”‚  â”‚
â”‚  â”‚  - æŒ‡æ ‡é¢æ¿ (å®æ—¶IC/æ”¶ç›Š)                        â”‚  â”‚
â”‚  â”‚  - å¯è§†åŒ–é¢æ¿ (å›¾è¡¨)                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚            â†• HTTP REST API + WebSocket                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚       FastAPI åç«¯ (localhost:8000)              â”‚  â”‚
â”‚  â”‚  - REST API (ä»»åŠ¡ç®¡ç†)                           â”‚  â”‚
â”‚  â”‚  - WebSocket (å®æ—¶æ¨é€)                          â”‚  â”‚
â”‚  â”‚  - è™šæ‹Ÿæ•°æ®ç”Ÿæˆ (æ¼”ç¤ºæ¨¡å¼)                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚            â†• [é›†æˆç‚¹] é¢„ç•™æ¥å£                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚        QuantaAlpha æ ¸å¿ƒé€»è¾‘ (å¾…é›†æˆ)             â”‚  â”‚
â”‚  â”‚  - alphaagent (å› å­æŒ–æ˜)                         â”‚  â”‚
â”‚  â”‚  - backtest_v2 (å›æµ‹ç³»ç»Ÿ)                        â”‚  â”‚
â”‚  â”‚  - factor_library (å› å­åº“)                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ä¸€é”®å¯åŠ¨

### æ–¹æ³• 1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ (æ¨è)

```bash
cd /Users/wanghuacan/Documents/tmp/QA/frontend-v2
./start.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… æ£€æŸ¥ç¯å¢ƒä¾èµ–
- âœ… å®‰è£…å‰ç«¯ä¾èµ– (npm install)
- âœ… åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒ
- âœ… å®‰è£…åç«¯ä¾èµ– (pip install)
- âœ… å¯åŠ¨åç«¯æœåŠ¡ (8000ç«¯å£)
- âœ… å¯åŠ¨å‰ç«¯æœåŠ¡ (3000ç«¯å£)

### æ–¹æ³• 2: æ‰‹åŠ¨å¯åŠ¨

**ç»ˆç«¯ 1 - åç«¯:**
```bash
cd /Users/wanghuacan/Documents/tmp/QA/frontend-v2/backend
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
python app.py
```

**ç»ˆç«¯ 2 - å‰ç«¯:**
```bash
cd /Users/wanghuacan/Documents/tmp/QA/frontend-v2
npm install
npm run dev
```

### è®¿é—®åº”ç”¨

- ğŸŒ **å‰ç«¯ç•Œé¢**: http://localhost:3000
- ğŸ”§ **API æ–‡æ¡£**: http://localhost:8000/docs
- ğŸ“Š **å¥åº·æ£€æŸ¥**: http://localhost:8000/api/health

## ğŸ’¡ ä½¿ç”¨æµç¨‹

### 1ï¸âƒ£ è¾“å…¥éœ€æ±‚

åœ¨ä¸»ç•Œé¢å¤§æ–‡æœ¬æ¡†ä¸­è¾“å…¥è‡ªç„¶è¯­è¨€æè¿°ï¼š

**ç¤ºä¾‹è¾“å…¥:**
```
è¯·å¸®æˆ‘æŒ–æ˜åŠ¨é‡ç±»å› å­ï¼Œé‡ç‚¹å…³æ³¨çŸ­æœŸåè½¬æ•ˆåº”å’Œæˆäº¤é‡é…åˆï¼Œ
å¸Œæœ›å› å­èƒ½å¤Ÿåœ¨CSI500å¸‚åœºä¸Šè¡¨ç°ç¨³å®šï¼ŒICå¤§äº0.05
```

### 2ï¸âƒ£ é…ç½®å‚æ•° (å¯é€‰)

ç‚¹å‡» "âš™ï¸ é«˜çº§é…ç½®" è°ƒæ•´ï¼š
- **å¹¶è¡Œæ–¹å‘æ•°**: 2 (é»˜è®¤)
- **è¿›åŒ–è½®æ¬¡**: 7 (é»˜è®¤)
- **å¸‚åœºé€‰æ‹©**: CSI 500 / S&P 500
- **è´¨é‡é—¨æ§**: å¯ç”¨ (æ¨è)

### 3ï¸âƒ£ å¼€å§‹æ‰§è¡Œ

ç‚¹å‡» "ğŸš€ å¼€å§‹æ‰§è¡Œ" æŒ‰é’®

### 4ï¸âƒ£ è§‚å¯Ÿå®æ—¶è¿›åº¦

**å·¦ä¾§é¢æ¿ - æ‰§è¡Œè¿›åº¦:**
- ğŸ¤” è§£æéœ€æ±‚ â†’ ğŸ“‹ è§„åˆ’æ–¹å‘ â†’ ğŸ§¬ è¿›åŒ–ä¸­ â†’ ğŸ“Š å›æµ‹ä¸­ â†’ ğŸ” åˆ†æç»“æœ â†’ âœ… å®Œæˆ
- è¿›åº¦æ¡æ˜¾ç¤ºå®Œæˆç™¾åˆ†æ¯”
- å®æ—¶æ»šåŠ¨æ—¥å¿— (æœ€è¿‘20æ¡)

**å³ä¾§é¢æ¿ - å®æ—¶æŒ‡æ ‡:**
- **IC æŒ‡æ ‡**: IC, ICIR, RankIC, RankICIR
- **æ”¶ç›ŠæŒ‡æ ‡**: å¹´åŒ–æ”¶ç›Š, å¤æ™®æ¯”ç‡, æœ€å¤§å›æ’¤
- **å› å­ç»Ÿè®¡**: æ€»æ•°åŠè´¨é‡åˆ†å¸ƒ (é«˜/ä¸­/ä½)

### 5ï¸âƒ£ æŸ¥çœ‹æœ€ç»ˆç»“æœ

ä»»åŠ¡å®Œæˆåï¼Œåº•éƒ¨è‡ªåŠ¨å±•å¼€ "ğŸ“Š æœ€ç»ˆç»“æœå±•ç¤º":

**å››å¤§å›¾è¡¨:**
1. **å‡€å€¼æ›²çº¿** - ç­–ç•¥ç´¯è®¡æ”¶ç›Šèµ°åŠ¿
2. **å›æ’¤åˆ†æ** - å†å²å›æ’¤æ°´å¹³
3. **IC æ—¶åº** - IC æŒ‡æ ‡æ—¶é—´åºåˆ—
4. **è´¨é‡åˆ†å¸ƒ** - å› å­è´¨é‡æŸ±çŠ¶å›¾

**å› å­åˆ—è¡¨:**
- Top 10 é«˜è´¨é‡å› å­
- æ˜¾ç¤ºåç§°ã€è¡¨è¾¾å¼ã€è´¨é‡ã€ICæŒ‡æ ‡ã€è½®æ¬¡

## ğŸ“ é¡¹ç›®æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒæ–‡ä»¶

```
frontend-v2/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/                    # åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx         # æŒ‰é’®
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.tsx           # å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ Badge.tsx          # æ ‡ç­¾
â”‚   â”‚   â”‚   â”œâ”€â”€ Progress.tsx       # è¿›åº¦æ¡
â”‚   â”‚   â”‚   â””â”€â”€ Textarea.tsx       # æ–‡æœ¬æ¡†
â”‚   â”‚   â”œâ”€â”€ InputPanel.tsx         # è¾“å…¥é¢æ¿ â­
â”‚   â”‚   â”œâ”€â”€ ExecutionPanel.tsx     # æ‰§è¡Œè¿›åº¦é¢æ¿ â­
â”‚   â”‚   â”œâ”€â”€ MetricsPanel.tsx       # å®æ—¶æŒ‡æ ‡é¢æ¿ â­
â”‚   â”‚   â””â”€â”€ ResultVisualization.tsx # ç»“æœå¯è§†åŒ– â­
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â””â”€â”€ HomePage.tsx           # ä¸»é¡µé¢ â­
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts               # ç±»å‹å®šä¹‰ â­
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ index.ts               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ index.css                  # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ main.tsx                   # åº”ç”¨å…¥å£
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.py                     # FastAPI æœåŠ¡ â­
â”‚   â””â”€â”€ requirements.txt           # Python ä¾èµ–
â”œâ”€â”€ package.json                   # å‰ç«¯ä¾èµ–
â”œâ”€â”€ vite.config.ts                 # Vite é…ç½®
â”œâ”€â”€ tailwind.config.js             # Tailwind é…ç½®
â”œâ”€â”€ start.sh                       # ä¸€é”®å¯åŠ¨è„šæœ¬ â­
â””â”€â”€ README.md                      # å®Œæ•´æ–‡æ¡£
```

â­ = æ ¸å¿ƒæ–‡ä»¶

### å…³é”®ä»£ç ä½ç½®

**è™šæ‹Ÿæ•°æ®ç”Ÿæˆ (æ¼”ç¤ºæ¨¡å¼):**
- å‰ç«¯: `src/pages/HomePage.tsx` â†’ `useMockExecution` hook
- åç«¯: `backend/app.py` â†’ `simulate_task_execution` å‡½æ•°

**æ¥å£é¢„ç•™ (å¾…é›†æˆ):**
```python
# backend/app.py ç¬¬ 60 è¡Œå·¦å³
async def simulate_task_execution(task_id: str, config: TaskConfig):
    """
    Simulate task execution with mock data
    TODO: Replace with actual integration to quantaalpha backend
    """
    # åœ¨è¿™é‡Œé›†æˆ quantaalpha çš„å®é™…é€»è¾‘
```

## ğŸ”Œ API æ¥å£æ–‡æ¡£

### REST API

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/` | API æ ¹è·¯å¾„ |
| GET | `/api/health` | å¥åº·æ£€æŸ¥ |
| POST | `/api/v1/mining/start` | å¯åŠ¨æŒ–æ˜ä»»åŠ¡ |
| GET | `/api/v1/mining/{task_id}` | è·å–ä»»åŠ¡çŠ¶æ€ |
| DELETE | `/api/v1/mining/{task_id}` | å–æ¶ˆä»»åŠ¡ |
| GET | `/api/v1/factors` | è·å–å› å­åº“ |
| GET | `/api/v1/system/config` | è·å–ç³»ç»Ÿé…ç½® |

### WebSocket

**è¿æ¥åœ°å€:** `ws://localhost:8000/ws/mining/{task_id}`

**æ¶ˆæ¯ç±»å‹:**
- `progress` - è¿›åº¦æ›´æ–°
- `log` - æ—¥å¿—æ¡ç›®
- `metrics` - æŒ‡æ ‡æ›´æ–°
- `result` - æœ€ç»ˆç»“æœ
- `heartbeat` - å¿ƒè·³ä¿æ´»

## ğŸ¨ UI è®¾è®¡äº®ç‚¹

### é…è‰²æ–¹æ¡ˆ
- **ä¸»è‰² (Primary)**: è“è‰² #3B82F6 - ç§‘æŠ€æ„Ÿã€ä¸“ä¸š
- **æˆåŠŸ (Success)**: ç»¿è‰² #10B981 - é«˜è´¨é‡å› å­
- **è­¦å‘Š (Warning)**: é»„è‰² #F59E0B - ä¸­ç­‰è´¨é‡
- **é”™è¯¯ (Destructive)**: çº¢è‰² #EF4444 - ä½è´¨é‡/å¤±è´¥
- **èƒŒæ™¯**: æ·±è‰² #111827 - æŠ¤çœ¼ã€ä¸“ä¸š

### äº¤äº’ç‰¹æ€§
- âœ¨ å¹³æ»‘åŠ¨ç”»è¿‡æ¸¡ (Framer Motion)
- ğŸ“Š å®æ—¶æ•°æ®æµå¼æ›´æ–°
- ğŸ“± å“åº”å¼å¸ƒå±€ (æ”¯æŒæ¡Œé¢/å¹³æ¿)
- ğŸ¯ è‡ªå®šä¹‰æ»šåŠ¨æ¡
- ğŸ’« åŠ è½½éª¨æ¶å±

## ğŸ”§ ä¸ QuantaAlpha é›†æˆ

### é›†æˆæ­¥éª¤

**1. å¯¼å…¥æ ¸å¿ƒæ¨¡å—**
```python
# backend/app.py
from quantaalpha.alphaagent.app.qlib_rd_loop import factor_mining
from quantaalpha.backtest_v2 import run_backtest
```

**2. æ›¿æ¢è™šæ‹Ÿæ‰§è¡Œå‡½æ•°**
```python
async def real_task_execution(task_id: str, config: TaskConfig):
    # è°ƒç”¨çœŸå®çš„å› å­æŒ–æ˜é€»è¾‘
    result = await factor_mining.run(
        user_input=config.userInput,
        num_directions=config.numDirections,
        max_rounds=config.maxRounds,
        # ... å…¶ä»–å‚æ•°
    )

    # é€šè¿‡ WebSocket æ¨é€å®æ—¶è¿›åº¦
    if task_id in websocket_connections:
        await websocket_connections[task_id].send_json({
            "type": "progress",
            "data": result.progress
        })
```

**3. å®ç°å› å­åº“æŒä¹…åŒ–**
```python
@app.get("/api/v1/factors")
async def get_factors(quality: Optional[str] = None):
    # ä» all_factors_library*.json åŠ è½½
    with open("../all_factors_library.json") as f:
        factors = json.load(f)

    # æŒ‰è´¨é‡ç­›é€‰
    if quality:
        factors = [f for f in factors if f['quality'] == quality]

    return {"factors": factors}
```

### æ•°æ®æµæ˜ å°„

**QuantaAlpha â†’ å‰ç«¯ç±»å‹:**
```python
# è¿›åŒ–è¿›åº¦
trajectory.round_idx â†’ ExecutionProgress.currentRound
trajectory.phase â†’ ExecutionProgress.phase

# å›æµ‹æŒ‡æ ‡
backtest_metrics['IC'] â†’ RealtimeMetrics.ic
backtest_metrics['ICIR'] â†’ RealtimeMetrics.icir
backtest_metrics['RankIC'] â†’ RealtimeMetrics.rankIc

# å› å­ä¿¡æ¯
factor_task.factor_name â†’ Factor.factorName
factor_task.factor_expression â†’ Factor.factorExpression
```

## ğŸ› å¸¸è§é—®é¢˜

### Q1: å‰ç«¯å¯åŠ¨æŠ¥é”™ "Cannot find module"
```bash
rm -rf node_modules package-lock.json
npm install
```

### Q2: åç«¯å¯åŠ¨æŠ¥é”™ "Address already in use"
```bash
# æŸ¥æ‰¾å ç”¨ 8000 ç«¯å£çš„è¿›ç¨‹
lsof -ti:8000 | xargs kill -9

# æˆ–è€…ä¿®æ”¹ç«¯å£
# backend/app.py æœ€åä¸€è¡Œæ”¹ä¸º:
uvicorn.run(app, host="127.0.0.1", port=8001)
```

### Q3: WebSocket è¿æ¥å¤±è´¥
- ç¡®è®¤åç«¯æ­£å¸¸è¿è¡Œ
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰ CORS é”™è¯¯
- å°è¯•åˆ·æ–°é¡µé¢é‡æ–°è¿æ¥

### Q4: è™šæ‹Ÿæ•°æ®å¦‚ä½•åˆ‡æ¢åˆ°çœŸå®æ•°æ®ï¼Ÿ
ä¿®æ”¹ `backend/app.py` ç¬¬ 60 è¡Œçš„ `simulate_task_execution` å‡½æ•°ï¼Œ
æ›¿æ¢ä¸ºè°ƒç”¨ quantaalpha çš„å®é™…é€»è¾‘ã€‚

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¤§é‡å› å­åˆ—è¡¨**: ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ (react-window)
2. **å›¾è¡¨æ€§èƒ½**: æ•°æ®é‡å¤§æ—¶å¯ç”¨æ•°æ®é‡‡æ ·
3. **WebSocket æ¶ˆæ¯**: å®ç°æ¶ˆæ¯é˜Ÿåˆ—é˜²æ­¢é˜»å¡
4. **æ—¥å¿—å­˜å‚¨**: è¶…è¿‡ 1000 æ¡æ—¶æŒä¹…åŒ–åˆ°æ–‡ä»¶

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] é›†æˆçœŸå®çš„ quantaalpha åç«¯é€»è¾‘
- [ ] æ·»åŠ å› å­åº“æµè§ˆå’Œç®¡ç†åŠŸèƒ½
- [ ] å®ç°å¤šä»»åŠ¡å¹¶è¡Œæ‰§è¡Œ
- [ ] æ·»åŠ ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- [ ] å®ç°ç»“æœå¯¼å‡º (JSON/CSV/Excel)
- [ ] æ·»åŠ å†å²ä»»åŠ¡è®°å½•
- [ ] ä¼˜åŒ–ç§»åŠ¨ç«¯é€‚é…

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥:
1. æµè§ˆå™¨æ§åˆ¶å° (F12)
2. åç«¯æ—¥å¿—è¾“å‡º
3. README.md å®Œæ•´æ–‡æ¡£

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«! ğŸš€**

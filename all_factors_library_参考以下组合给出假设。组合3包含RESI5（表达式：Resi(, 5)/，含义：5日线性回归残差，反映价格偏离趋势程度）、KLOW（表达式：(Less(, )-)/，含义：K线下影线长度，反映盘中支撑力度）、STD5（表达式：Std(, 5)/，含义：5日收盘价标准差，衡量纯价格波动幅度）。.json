{
  "metadata": {
    "created_at": "2026-01-19T21:11:04.555980",
    "last_updated": "2026-01-19T22:37:34.600854",
    "total_factors": 45,
    "version": "1.0"
  },
  "factors": {
    "c36251a1de18f321": {
      "factor_id": "c36251a1de18f321",
      "factor_name": "Volume_Adjusted_Volatility_10_20",
      "factor_expression": "RANK(TS_STD($close, 10) / (TS_MEAN($volume, 20) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_STD($close, 10) / (TS_MEAN($volume, 20) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Volume_Adjusted_Volatility_10_20\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor calculates the 10-day price volatility normalized by the 20-day average trading volume. High volatility on low volume suggests liquidity-driven noise and lack of institutional conviction, which typically leads to negative future returns or mean reversion.",
      "factor_formulation": "VAV = \\text{RANK}\\left(\\frac{\\text{TS_STD}(\\text{close}, 10)}{\\text{TS_MEAN}(\\text{volume}, 20) + 1e-8}\\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 10-day price volatility normalized by the 20-day average trading volume (Volume-Adjusted Volatility) negatively predicts future returns due to liquidity-constrained risk pricing.\n                Concise Observation: Daily price and volume data often show that price spikes on thin volume are less sustainable than those supported by high turnover, suggesting a divergence between volatility and liquidity.\n                Concise Justification: Assets with high volatility but low volume lack the institutional conviction required to maintain price trends, leading to higher risk premiums or subsequent reversals.\n                Concise Knowledge: If high price volatility is accompanied by low relative volume, the asset is likely experiencing liquidity-driven noise rather than fundamental price discovery; when such conditions occur, the price tends to mean-revert as liquidity stabilizes.\n                concise Specification: Calculate the standard deviation of the daily close price over the last 10 days and divide it by the mean volume over the last 20 days to create a single static factor for each instrument.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:11:04.555648"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1408305340515132,
        "ICIR": 0.0278613879144935,
        "1day.excess_return_without_cost.std": 0.0038143652529656,
        "1day.excess_return_with_cost.annualized_return": -0.0088881924306522,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001618626152089,
        "1day.excess_return_without_cost.annualized_return": 0.038523302419722,
        "1day.excess_return_with_cost.std": 0.0038149067572797,
        "Rank IC": 0.0178494571253468,
        "IC": 0.0034875742147514,
        "1day.excess_return_without_cost.max_drawdown": -0.0839877097913644,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.654655399153893,
        "1day.pa": 0.0,
        "l2.valid": 0.9964472238990748,
        "Rank ICIR": 0.1480124005382707,
        "l2.train": 0.993636277046149,
        "1day.excess_return_with_cost.information_ratio": -0.1510222869327769,
        "1day.excess_return_with_cost.mean": -3.734534634727837e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Volume-Adjusted Volatility' hypothesis. The combined results show a positive Information Ratio (0.6547) and an annualized excess return of 3.85%, with a positive IC of 0.0035. While these metrics indicate some predictive power, the overall performance is relatively modest, suggesting that while the relationship between volatility and liquidity exists, the current linear or ratio-based implementations may not fully capture the non-linear dynamics of liquidity-constrained risk pricing.",
        "hypothesis_evaluation": "The results provide partial support for the hypothesis. The positive IC and excess returns suggest that normalizing volatility by volume helps identify mispriced risks. However, the 'Relative_Volatility_Volume_Divergence' factor introduces a time-series rank approach which might be more robust than simple ratios. The current implementation uses a mix of cross-sectional RANK, ZSCORE, and TS_RANK, which complicates the direct attribution of performance to a single construction method.",
        "decision": true,
        "reason": "The current factors use relatively short windows (10-20 days). By extending the look-back period for the volume baseline (e.g., 60 days) while keeping the volatility window short (e.g., 5 days), we can better identify 'sudden' volatility spikes that are unsupported by 'structural' liquidity. This addresses the 'liquidity-induced overextension' more effectively than short-term moving averages. Furthermore, using a subtraction of ranks (TS_RANK of Volatility - TS_RANK of Volume) instead of a ratio may provide a more stable signal and reduce extreme values caused by low-volume denominators."
      }
    },
    "6a99f1ff946dc7b2": {
      "factor_id": "6a99f1ff946dc7b2",
      "factor_name": "Liquidity_Constrained_Risk_Factor_15D",
      "factor_expression": "ZSCORE(TS_MEAN($high - $low, 15) / (TS_MEAN($volume, 15) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_MEAN($high - $low, 15) / (TS_MEAN($volume, 15) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Constrained_Risk_Factor_15D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A variation of the volume-adjusted volatility hypothesis using a 15-day window for both price range volatility and volume. It identifies assets where price swings are large relative to the average turnover, indicating potential liquidity-induced overextension.",
      "factor_formulation": "LCRF = \\text{ZSCORE}\\left(\\frac{\\text{TS_MEAN}(\\text{high} - \\text{low}, 15)}{\\text{TS_MEAN}(\\text{volume}, 15) + 1e-8}\\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 10-day price volatility normalized by the 20-day average trading volume (Volume-Adjusted Volatility) negatively predicts future returns due to liquidity-constrained risk pricing.\n                Concise Observation: Daily price and volume data often show that price spikes on thin volume are less sustainable than those supported by high turnover, suggesting a divergence between volatility and liquidity.\n                Concise Justification: Assets with high volatility but low volume lack the institutional conviction required to maintain price trends, leading to higher risk premiums or subsequent reversals.\n                Concise Knowledge: If high price volatility is accompanied by low relative volume, the asset is likely experiencing liquidity-driven noise rather than fundamental price discovery; when such conditions occur, the price tends to mean-revert as liquidity stabilizes.\n                concise Specification: Calculate the standard deviation of the daily close price over the last 10 days and divide it by the mean volume over the last 20 days to create a single static factor for each instrument.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:11:04.555648"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1408305340515132,
        "ICIR": 0.0278613879144935,
        "1day.excess_return_without_cost.std": 0.0038143652529656,
        "1day.excess_return_with_cost.annualized_return": -0.0088881924306522,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001618626152089,
        "1day.excess_return_without_cost.annualized_return": 0.038523302419722,
        "1day.excess_return_with_cost.std": 0.0038149067572797,
        "Rank IC": 0.0178494571253468,
        "IC": 0.0034875742147514,
        "1day.excess_return_without_cost.max_drawdown": -0.0839877097913644,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.654655399153893,
        "1day.pa": 0.0,
        "l2.valid": 0.9964472238990748,
        "Rank ICIR": 0.1480124005382707,
        "l2.train": 0.993636277046149,
        "1day.excess_return_with_cost.information_ratio": -0.1510222869327769,
        "1day.excess_return_with_cost.mean": -3.734534634727837e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Volume-Adjusted Volatility' hypothesis. The combined results show a positive Information Ratio (0.6547) and an annualized excess return of 3.85%, with a positive IC of 0.0035. While these metrics indicate some predictive power, the overall performance is relatively modest, suggesting that while the relationship between volatility and liquidity exists, the current linear or ratio-based implementations may not fully capture the non-linear dynamics of liquidity-constrained risk pricing.",
        "hypothesis_evaluation": "The results provide partial support for the hypothesis. The positive IC and excess returns suggest that normalizing volatility by volume helps identify mispriced risks. However, the 'Relative_Volatility_Volume_Divergence' factor introduces a time-series rank approach which might be more robust than simple ratios. The current implementation uses a mix of cross-sectional RANK, ZSCORE, and TS_RANK, which complicates the direct attribution of performance to a single construction method.",
        "decision": true,
        "reason": "The current factors use relatively short windows (10-20 days). By extending the look-back period for the volume baseline (e.g., 60 days) while keeping the volatility window short (e.g., 5 days), we can better identify 'sudden' volatility spikes that are unsupported by 'structural' liquidity. This addresses the 'liquidity-induced overextension' more effectively than short-term moving averages. Furthermore, using a subtraction of ranks (TS_RANK of Volatility - TS_RANK of Volume) instead of a ratio may provide a more stable signal and reduce extreme values caused by low-volume denominators."
      }
    },
    "2bff132c4f41f7ec": {
      "factor_id": "2bff132c4f41f7ec",
      "factor_name": "Relative_Volatility_Volume_Divergence",
      "factor_expression": "TS_RANK(TS_STD($close, 10), 20) / (TS_RANK($volume, 20) + 1e-8)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"TS_RANK(TS_STD($close, 10), 20) / (TS_RANK($volume, 20) + 1e-8)\" # Your output factor expression will be filled in here\n    name = \"Relative_Volatility_Volume_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the divergence between price volatility and volume by taking the ratio of their respective time-series ranks. A high value indicates that volatility is historically high while volume is historically low relative to their own histories, signaling unsustainable price movements.",
      "factor_formulation": "RVVD = \\frac{\\text{TS_RANK}(\\text{TS_STD}(\\text{close}, 10), 20)}{\\text{TS_RANK}(\\text{volume}, 20) + 1e-8}",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 10-day price volatility normalized by the 20-day average trading volume (Volume-Adjusted Volatility) negatively predicts future returns due to liquidity-constrained risk pricing.\n                Concise Observation: Daily price and volume data often show that price spikes on thin volume are less sustainable than those supported by high turnover, suggesting a divergence between volatility and liquidity.\n                Concise Justification: Assets with high volatility but low volume lack the institutional conviction required to maintain price trends, leading to higher risk premiums or subsequent reversals.\n                Concise Knowledge: If high price volatility is accompanied by low relative volume, the asset is likely experiencing liquidity-driven noise rather than fundamental price discovery; when such conditions occur, the price tends to mean-revert as liquidity stabilizes.\n                concise Specification: Calculate the standard deviation of the daily close price over the last 10 days and divide it by the mean volume over the last 20 days to create a single static factor for each instrument.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:11:04.555648"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1408305340515132,
        "ICIR": 0.0278613879144935,
        "1day.excess_return_without_cost.std": 0.0038143652529656,
        "1day.excess_return_with_cost.annualized_return": -0.0088881924306522,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001618626152089,
        "1day.excess_return_without_cost.annualized_return": 0.038523302419722,
        "1day.excess_return_with_cost.std": 0.0038149067572797,
        "Rank IC": 0.0178494571253468,
        "IC": 0.0034875742147514,
        "1day.excess_return_without_cost.max_drawdown": -0.0839877097913644,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.654655399153893,
        "1day.pa": 0.0,
        "l2.valid": 0.9964472238990748,
        "Rank ICIR": 0.1480124005382707,
        "l2.train": 0.993636277046149,
        "1day.excess_return_with_cost.information_ratio": -0.1510222869327769,
        "1day.excess_return_with_cost.mean": -3.734534634727837e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Volume-Adjusted Volatility' hypothesis. The combined results show a positive Information Ratio (0.6547) and an annualized excess return of 3.85%, with a positive IC of 0.0035. While these metrics indicate some predictive power, the overall performance is relatively modest, suggesting that while the relationship between volatility and liquidity exists, the current linear or ratio-based implementations may not fully capture the non-linear dynamics of liquidity-constrained risk pricing.",
        "hypothesis_evaluation": "The results provide partial support for the hypothesis. The positive IC and excess returns suggest that normalizing volatility by volume helps identify mispriced risks. However, the 'Relative_Volatility_Volume_Divergence' factor introduces a time-series rank approach which might be more robust than simple ratios. The current implementation uses a mix of cross-sectional RANK, ZSCORE, and TS_RANK, which complicates the direct attribution of performance to a single construction method.",
        "decision": true,
        "reason": "The current factors use relatively short windows (10-20 days). By extending the look-back period for the volume baseline (e.g., 60 days) while keeping the volatility window short (e.g., 5 days), we can better identify 'sudden' volatility spikes that are unsupported by 'structural' liquidity. This addresses the 'liquidity-induced overextension' more effectively than short-term moving averages. Furthermore, using a subtraction of ranks (TS_RANK of Volatility - TS_RANK of Volume) instead of a ratio may provide a more stable signal and reduce extreme values caused by low-volume denominators."
      }
    },
    "e2818c57c65517cc": {
      "factor_id": "e2818c57c65517cc",
      "factor_name": "Liquidity_Gap_Volatility_Rank_Divergence_60D",
      "factor_expression": "TS_RANK(TS_STD($close, 5), 60) - TS_RANK(TS_MEAN($volume, 60), 60)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"TS_RANK(TS_STD($close, 5), 60) - TS_RANK(TS_MEAN($volume, 60), 60)\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Gap_Volatility_Rank_Divergence_60D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies unsustainable price turbulence by calculating the divergence between short-term price volatility and long-term structural liquidity. It subtracts the 60-day time-series rank of average volume from the 60-day time-series rank of 5-day price volatility. High values suggest a 'liquidity vacuum' where volatility spikes without volume support, predicting lower future returns.",
      "factor_formulation": "\\text{TS\\_RANK}(\\text{TS\\_STD}(\\text{close}, 5), 60) - \\text{TS\\_RANK}(\\text{TS\\_MEAN}(\\text{volume}, 60), 60)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The divergence between short-term price volatility and long-term structural liquidity, measured by the difference in their 60-day time-series ranks, negatively predicts future returns as it identifies unsustainable liquidity gaps.\n                Concise Observation: Simple ratios of volatility to volume are prone to noise from low-volume denominators; however, subtracting the time-series rank of volume from the time-series rank of volatility effectively isolates periods of 'unsupported' price turbulence.\n                Concise Justification: Using a long-term (60-day) baseline for volume provides a more stable measure of structural liquidity, making short-term (5-day) volatility spikes stand out as anomalies when they are not accompanied by a corresponding increase in participation.\n                Concise Knowledge: If an asset's 5-day price volatility reaches a local peak while its 60-day relative volume remains subdued, the price movement is likely driven by a liquidity vacuum rather than fundamental conviction, leading to a higher probability of mean reversion.\n                concise Specification: Calculate the 60-day TS_RANK of the 5-day standard deviation of close prices and subtract the 60-day TS_RANK of the 60-day moving average of volume; higher values indicate a liquidity gap and predict lower future returns.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:15:21.399443"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1162987356908505,
        "ICIR": 0.044737050268156,
        "1day.excess_return_without_cost.std": 0.0040601499014415,
        "1day.excess_return_with_cost.annualized_return": 0.0124894801172768,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002501236820876,
        "1day.excess_return_without_cost.annualized_return": 0.0595294363368669,
        "1day.excess_return_with_cost.std": 0.0040607451991685,
        "Rank IC": 0.0204198324762387,
        "IC": 0.0058018050767164,
        "1day.excess_return_without_cost.max_drawdown": -0.0961112041002919,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.950388612026825,
        "1day.pa": 0.0,
        "l2.valid": 0.9965207348384764,
        "Rank ICIR": 0.1647631965832502,
        "l2.train": 0.9939844516604665,
        "1day.excess_return_with_cost.information_ratio": 0.1993655627274344,
        "1day.excess_return_with_cost.mean": 5.247680721544883e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Gap' hypothesis, focusing on the divergence between short-term volatility (5-day) and long-term liquidity (60-day). The results show a significant improvement over the previous SOTA across almost all key performance indicators. The Information Ratio (IR) increased from 0.65 to 0.95, and the Annualized Return rose from 3.85% to 5.95%. The IC also saw a substantial jump from 0.0035 to 0.0058. While the Max Drawdown slightly increased (deteriorated), the overall risk-adjusted return profile is much stronger. The 'Ranked_Liquidity_Vacuum_Indicator' and 'Normalized_Volatility_Liquidity_Spread_Z' likely contributed to this success by providing better cross-sectional comparability than raw rank differences.",
        "hypothesis_evaluation": "The results strongly support the hypothesis. The divergence between short-term price volatility and long-term structural liquidity is a potent predictor of future returns. Specifically, the implementation using cross-sectional ranking of the ratio (Ranked_Liquidity_Vacuum_Indicator) or Z-score normalization effectively captures the 'unsustainable' nature of price moves that lack volume support. This confirms that 'liquidity vacuums' lead to mean-reversion or negative price pressure.",
        "decision": true,
        "reason": "Currently, the factor uses TS_STD which is direction-agnostic. By distinguishing between upside and downside volatility (e.g., using Semi-Deviation or signed returns), we can isolate whether the 'liquidity vacuum' is a 'blow-off top' or a 'panic bottom'. Additionally, replacing TS_MEAN(volume, 60) with an EMA(volume, 60) will give more weight to recent liquidity trends while maintaining the long-term structural baseline, potentially reducing the lag in the liquidity signal."
      }
    },
    "288740ad9bdcba63": {
      "factor_id": "288740ad9bdcba63",
      "factor_name": "Normalized_Volatility_Liquidity_Spread_Z",
      "factor_expression": "ZSCORE(TS_RANK(TS_STD($close, 5), 60)) - ZSCORE(TS_RANK(TS_MEAN($volume, 60), 60))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_RANK(TS_STD($close, 5), 60)) - ZSCORE(TS_RANK(TS_MEAN($volume, 60), 60))\" # Your output factor expression will be filled in here\n    name = \"Normalized_Volatility_Liquidity_Spread_Z\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A cross-sectionally standardized version of the liquidity gap hypothesis. It measures the spread between the relative intensity of 5-day price fluctuations and the relative intensity of 60-day volume participation. By applying ZSCORE, it identifies assets where the volatility-to-liquidity mismatch is extreme relative to the market universe.",
      "factor_formulation": "\\text{ZSCORE}(\\text{TS\\_RANK}(\\text{TS\\_STD}(\\text{close}, 5), 60)) - \\text{ZSCORE}(\\text{TS\\_RANK}(\\text{TS\\_MEAN}(\\text{volume}, 60), 60))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The divergence between short-term price volatility and long-term structural liquidity, measured by the difference in their 60-day time-series ranks, negatively predicts future returns as it identifies unsustainable liquidity gaps.\n                Concise Observation: Simple ratios of volatility to volume are prone to noise from low-volume denominators; however, subtracting the time-series rank of volume from the time-series rank of volatility effectively isolates periods of 'unsupported' price turbulence.\n                Concise Justification: Using a long-term (60-day) baseline for volume provides a more stable measure of structural liquidity, making short-term (5-day) volatility spikes stand out as anomalies when they are not accompanied by a corresponding increase in participation.\n                Concise Knowledge: If an asset's 5-day price volatility reaches a local peak while its 60-day relative volume remains subdued, the price movement is likely driven by a liquidity vacuum rather than fundamental conviction, leading to a higher probability of mean reversion.\n                concise Specification: Calculate the 60-day TS_RANK of the 5-day standard deviation of close prices and subtract the 60-day TS_RANK of the 60-day moving average of volume; higher values indicate a liquidity gap and predict lower future returns.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:15:21.399443"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1162987356908505,
        "ICIR": 0.044737050268156,
        "1day.excess_return_without_cost.std": 0.0040601499014415,
        "1day.excess_return_with_cost.annualized_return": 0.0124894801172768,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002501236820876,
        "1day.excess_return_without_cost.annualized_return": 0.0595294363368669,
        "1day.excess_return_with_cost.std": 0.0040607451991685,
        "Rank IC": 0.0204198324762387,
        "IC": 0.0058018050767164,
        "1day.excess_return_without_cost.max_drawdown": -0.0961112041002919,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.950388612026825,
        "1day.pa": 0.0,
        "l2.valid": 0.9965207348384764,
        "Rank ICIR": 0.1647631965832502,
        "l2.train": 0.9939844516604665,
        "1day.excess_return_with_cost.information_ratio": 0.1993655627274344,
        "1day.excess_return_with_cost.mean": 5.247680721544883e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Gap' hypothesis, focusing on the divergence between short-term volatility (5-day) and long-term liquidity (60-day). The results show a significant improvement over the previous SOTA across almost all key performance indicators. The Information Ratio (IR) increased from 0.65 to 0.95, and the Annualized Return rose from 3.85% to 5.95%. The IC also saw a substantial jump from 0.0035 to 0.0058. While the Max Drawdown slightly increased (deteriorated), the overall risk-adjusted return profile is much stronger. The 'Ranked_Liquidity_Vacuum_Indicator' and 'Normalized_Volatility_Liquidity_Spread_Z' likely contributed to this success by providing better cross-sectional comparability than raw rank differences.",
        "hypothesis_evaluation": "The results strongly support the hypothesis. The divergence between short-term price volatility and long-term structural liquidity is a potent predictor of future returns. Specifically, the implementation using cross-sectional ranking of the ratio (Ranked_Liquidity_Vacuum_Indicator) or Z-score normalization effectively captures the 'unsustainable' nature of price moves that lack volume support. This confirms that 'liquidity vacuums' lead to mean-reversion or negative price pressure.",
        "decision": true,
        "reason": "Currently, the factor uses TS_STD which is direction-agnostic. By distinguishing between upside and downside volatility (e.g., using Semi-Deviation or signed returns), we can isolate whether the 'liquidity vacuum' is a 'blow-off top' or a 'panic bottom'. Additionally, replacing TS_MEAN(volume, 60) with an EMA(volume, 60) will give more weight to recent liquidity trends while maintaining the long-term structural baseline, potentially reducing the lag in the liquidity signal."
      }
    },
    "aab06afa5dd26442": {
      "factor_id": "aab06afa5dd26442",
      "factor_name": "Ranked_Liquidity_Vacuum_Indicator",
      "factor_expression": "RANK(TS_RANK(TS_STD($close, 5), 60) / (TS_RANK(TS_MEAN($volume, 60), 60) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_RANK(TS_STD($close, 5), 60) / (TS_RANK(TS_MEAN($volume, 60), 60) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Ranked_Liquidity_Vacuum_Indicator\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures the 'liquidity gap' by focusing on the percentile position of short-term volatility relative to long-term volume. It uses a 60-day lookback to establish the structural baseline for both metrics. A high value indicates that current volatility is at a historical peak while volume is not, signaling a potential mean-reversion due to lack of fundamental support.",
      "factor_formulation": "\\text{RANK}(\\text{TS\\_RANK}(\\text{TS\\_STD}(\\text{close}, 5), 60) / (\\text{TS\\_RANK}(\\text{TS\\_MEAN}(\\text{volume}, 60), 60) + 1e-8))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The divergence between short-term price volatility and long-term structural liquidity, measured by the difference in their 60-day time-series ranks, negatively predicts future returns as it identifies unsustainable liquidity gaps.\n                Concise Observation: Simple ratios of volatility to volume are prone to noise from low-volume denominators; however, subtracting the time-series rank of volume from the time-series rank of volatility effectively isolates periods of 'unsupported' price turbulence.\n                Concise Justification: Using a long-term (60-day) baseline for volume provides a more stable measure of structural liquidity, making short-term (5-day) volatility spikes stand out as anomalies when they are not accompanied by a corresponding increase in participation.\n                Concise Knowledge: If an asset's 5-day price volatility reaches a local peak while its 60-day relative volume remains subdued, the price movement is likely driven by a liquidity vacuum rather than fundamental conviction, leading to a higher probability of mean reversion.\n                concise Specification: Calculate the 60-day TS_RANK of the 5-day standard deviation of close prices and subtract the 60-day TS_RANK of the 60-day moving average of volume; higher values indicate a liquidity gap and predict lower future returns.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:15:21.399443"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1162987356908505,
        "ICIR": 0.044737050268156,
        "1day.excess_return_without_cost.std": 0.0040601499014415,
        "1day.excess_return_with_cost.annualized_return": 0.0124894801172768,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002501236820876,
        "1day.excess_return_without_cost.annualized_return": 0.0595294363368669,
        "1day.excess_return_with_cost.std": 0.0040607451991685,
        "Rank IC": 0.0204198324762387,
        "IC": 0.0058018050767164,
        "1day.excess_return_without_cost.max_drawdown": -0.0961112041002919,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.950388612026825,
        "1day.pa": 0.0,
        "l2.valid": 0.9965207348384764,
        "Rank ICIR": 0.1647631965832502,
        "l2.train": 0.9939844516604665,
        "1day.excess_return_with_cost.information_ratio": 0.1993655627274344,
        "1day.excess_return_with_cost.mean": 5.247680721544883e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Gap' hypothesis, focusing on the divergence between short-term volatility (5-day) and long-term liquidity (60-day). The results show a significant improvement over the previous SOTA across almost all key performance indicators. The Information Ratio (IR) increased from 0.65 to 0.95, and the Annualized Return rose from 3.85% to 5.95%. The IC also saw a substantial jump from 0.0035 to 0.0058. While the Max Drawdown slightly increased (deteriorated), the overall risk-adjusted return profile is much stronger. The 'Ranked_Liquidity_Vacuum_Indicator' and 'Normalized_Volatility_Liquidity_Spread_Z' likely contributed to this success by providing better cross-sectional comparability than raw rank differences.",
        "hypothesis_evaluation": "The results strongly support the hypothesis. The divergence between short-term price volatility and long-term structural liquidity is a potent predictor of future returns. Specifically, the implementation using cross-sectional ranking of the ratio (Ranked_Liquidity_Vacuum_Indicator) or Z-score normalization effectively captures the 'unsustainable' nature of price moves that lack volume support. This confirms that 'liquidity vacuums' lead to mean-reversion or negative price pressure.",
        "decision": true,
        "reason": "Currently, the factor uses TS_STD which is direction-agnostic. By distinguishing between upside and downside volatility (e.g., using Semi-Deviation or signed returns), we can isolate whether the 'liquidity vacuum' is a 'blow-off top' or a 'panic bottom'. Additionally, replacing TS_MEAN(volume, 60) with an EMA(volume, 60) will give more weight to recent liquidity trends while maintaining the long-term structural baseline, potentially reducing the lag in the liquidity signal."
      }
    },
    "9f9c7b314dd7f42b": {
      "factor_id": "9f9c7b314dd7f42b",
      "factor_name": "Liquidity_Exhaustion_Panic_Bottom_60D",
      "factor_expression": "TS_RANK(SQRT(SUMIF(POW($return, 2), 5, $return < 0) / 5), 60) - TS_RANK(EMA($volume, 60), 60)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"TS_RANK(SQRT(SUMIF(POW($close / DELAY($close, 1) - 1, 2), 5, ($close / DELAY($close, 1) - 1) < 0) / 5), 60) - TS_RANK(EMA($volume, 60), 60)\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Exhaustion_Panic_Bottom_60D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies panic bottoms by measuring the gap between downside volatility and structural liquidity. It calculates the 60-day time-series rank of the 5-day downside semi-deviation (volatility of negative returns) and subtracts the 60-day time-series rank of the 60-day EMA of volume. High values suggest seller exhaustion in a liquidity vacuum, predicting positive mean reversion.",
      "factor_formulation": "LEPB = TS\\_RANK(\\sqrt{\\frac{\\sum_{i=1}^{5} (return_i < 0 ? return_i^2 : 0)}{5}}, 60) - TS\\_RANK(EMA(volume, 60), 60)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity Exhaustion' factor, defined as the difference between the 60-day TS_RANK of 5-day downside semi-deviation and the 60-day TS_RANK of the 60-day EMA of volume, identifies high-conviction panic bottoms that predict positive future returns.\n                Concise Observation: Previous results show that rank-based liquidity gaps (volatility vs. volume) are highly predictive, but the direction-agnostic nature of standard deviation conflates 'exhaustion' at peaks with 'capitulation' at troughs.\n                Concise Justification: Downside semi-deviation isolates the risk of price drops; when this 'panic' volatility peaks while long-term structural volume (EMA) remains low, it indicates a lack of liquidity to absorb selling pressure, often leading to an oversold bounce or mean reversion as buyers return.\n                Concise Knowledge: If a liquidity gap (high volatility, low volume) is driven specifically by downside price action, it signals seller exhaustion rather than a blow-off top; when volume is smoothed by an EMA, the signal becomes more responsive to structural liquidity shifts than a simple moving average.\n                concise Specification: Calculate the 5-day downside semi-deviation (standard deviation of negative returns only) and its 60-day TS_RANK. Calculate the 60-day EMA of volume and its 60-day TS_RANK. The factor is the difference: TS_RANK(Downside_Vol, 60) - TS_RANK(EMA_Volume, 60).\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:20:22.037456"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1572285409569022,
        "ICIR": 0.0530403441648252,
        "1day.excess_return_without_cost.std": 0.0043830992301383,
        "1day.excess_return_with_cost.annualized_return": 0.0067400473133438,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002263845984003,
        "1day.excess_return_without_cost.annualized_return": 0.0538795344192741,
        "1day.excess_return_with_cost.std": 0.0043860391632996,
        "Rank IC": 0.0197215138438166,
        "IC": 0.0073471167829965,
        "1day.excess_return_without_cost.max_drawdown": -0.1165100515955113,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7968086734994563,
        "1day.pa": 0.0,
        "l2.valid": 0.9964699501378668,
        "Rank ICIR": 0.1513199158515729,
        "l2.train": 0.9929281420394236,
        "1day.excess_return_with_cost.information_ratio": 0.0996097755347108,
        "1day.excess_return_with_cost.mean": 2.831952652665486e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Exhaustion' hypothesis. The current results show a significant improvement in the Information Coefficient (IC), which rose from 0.0058 to 0.0073, indicating a stronger predictive signal for individual stock returns. However, the portfolio-level metrics (Annualized Return, Information Ratio, and Max Drawdown) showed slight deterioration compared to the SOTA. This suggests that while the raw signal strength (IC) improved, the risk-adjusted returns and drawdown characteristics of the current implementation are less stable than the previous best.",
        "hypothesis_evaluation": "The hypothesis that the gap between downside volatility and structural liquidity predicts positive returns is supported by the improved IC. The 'Downside_Volatility_Liquidity_Gap_Ratio' and 'Cross_Sectional_Panic_Exhaustion_Z' variations successfully captured the decoupling of price action and volume. However, the drop in Information Ratio suggests that the current 60-day window for volume EMA or the 5-day window for downside deviation might be introducing noise or capturing short-lived spikes that lead to higher turnover and drawdowns.",
        "decision": false,
        "reason": "1. The current 60-day EMA of volume can be heavily skewed by recent high-volume sell-offs, potentially masking the 'exhaustion' effect. A median (TS_MEDIAN) is more robust to outliers. 2. A 5-day window for downside deviation is very sensitive; extending it to 10 days may capture more significant 'panic' phases. 3. The high IC but lower IR suggests the signal is accurate but volatile; smoothing the inputs should stabilize the portfolio performance."
      }
    },
    "c4f83cd8a2954cc3": {
      "factor_id": "c4f83cd8a2954cc3",
      "factor_name": "Cross_Sectional_Panic_Exhaustion_Z",
      "factor_expression": "ZSCORE(TS_RANK(TS_STD(MIN($return, 0), 5), 60) - TS_RANK(EMA($volume, 60), 60))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_RANK(TS_STD(MIN($close / DELAY($close, 1) - 1, 0), 5), 60) - TS_RANK(EMA($volume, 60), 60))\" # Your output factor expression will be filled in here\n    name = \"Cross_Sectional_Panic_Exhaustion_Z\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A cross-sectionally standardized version of the liquidity exhaustion hypothesis. It focuses on the divergence between recent downside intensity and long-term volume trends. By using Z-scores of the ranks, it ensures the factor is comparable across different market regimes and identifies instruments with the most extreme 'panic-to-liquidity' decoupling.",
      "factor_formulation": "CSPE = ZSCORE(TS\\_RANK(TS\\_STD(MIN($return, 0), 5), 60) - TS\\_RANK(EMA($volume, 60), 60))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity Exhaustion' factor, defined as the difference between the 60-day TS_RANK of 5-day downside semi-deviation and the 60-day TS_RANK of the 60-day EMA of volume, identifies high-conviction panic bottoms that predict positive future returns.\n                Concise Observation: Previous results show that rank-based liquidity gaps (volatility vs. volume) are highly predictive, but the direction-agnostic nature of standard deviation conflates 'exhaustion' at peaks with 'capitulation' at troughs.\n                Concise Justification: Downside semi-deviation isolates the risk of price drops; when this 'panic' volatility peaks while long-term structural volume (EMA) remains low, it indicates a lack of liquidity to absorb selling pressure, often leading to an oversold bounce or mean reversion as buyers return.\n                Concise Knowledge: If a liquidity gap (high volatility, low volume) is driven specifically by downside price action, it signals seller exhaustion rather than a blow-off top; when volume is smoothed by an EMA, the signal becomes more responsive to structural liquidity shifts than a simple moving average.\n                concise Specification: Calculate the 5-day downside semi-deviation (standard deviation of negative returns only) and its 60-day TS_RANK. Calculate the 60-day EMA of volume and its 60-day TS_RANK. The factor is the difference: TS_RANK(Downside_Vol, 60) - TS_RANK(EMA_Volume, 60).\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:20:22.037456"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1572285409569022,
        "ICIR": 0.0530403441648252,
        "1day.excess_return_without_cost.std": 0.0043830992301383,
        "1day.excess_return_with_cost.annualized_return": 0.0067400473133438,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002263845984003,
        "1day.excess_return_without_cost.annualized_return": 0.0538795344192741,
        "1day.excess_return_with_cost.std": 0.0043860391632996,
        "Rank IC": 0.0197215138438166,
        "IC": 0.0073471167829965,
        "1day.excess_return_without_cost.max_drawdown": -0.1165100515955113,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7968086734994563,
        "1day.pa": 0.0,
        "l2.valid": 0.9964699501378668,
        "Rank ICIR": 0.1513199158515729,
        "l2.train": 0.9929281420394236,
        "1day.excess_return_with_cost.information_ratio": 0.0996097755347108,
        "1day.excess_return_with_cost.mean": 2.831952652665486e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Exhaustion' hypothesis. The current results show a significant improvement in the Information Coefficient (IC), which rose from 0.0058 to 0.0073, indicating a stronger predictive signal for individual stock returns. However, the portfolio-level metrics (Annualized Return, Information Ratio, and Max Drawdown) showed slight deterioration compared to the SOTA. This suggests that while the raw signal strength (IC) improved, the risk-adjusted returns and drawdown characteristics of the current implementation are less stable than the previous best.",
        "hypothesis_evaluation": "The hypothesis that the gap between downside volatility and structural liquidity predicts positive returns is supported by the improved IC. The 'Downside_Volatility_Liquidity_Gap_Ratio' and 'Cross_Sectional_Panic_Exhaustion_Z' variations successfully captured the decoupling of price action and volume. However, the drop in Information Ratio suggests that the current 60-day window for volume EMA or the 5-day window for downside deviation might be introducing noise or capturing short-lived spikes that lead to higher turnover and drawdowns.",
        "decision": false,
        "reason": "1. The current 60-day EMA of volume can be heavily skewed by recent high-volume sell-offs, potentially masking the 'exhaustion' effect. A median (TS_MEDIAN) is more robust to outliers. 2. A 5-day window for downside deviation is very sensitive; extending it to 10 days may capture more significant 'panic' phases. 3. The high IC but lower IR suggests the signal is accurate but volatile; smoothing the inputs should stabilize the portfolio performance."
      }
    },
    "811628f3f7f0d9ca": {
      "factor_id": "811628f3f7f0d9ca",
      "factor_name": "Downside_Volatility_Liquidity_Gap_Ratio",
      "factor_expression": "TS_RANK(TS_STD(MIN($return, 0), 5) / (EMA($volume, 60) + 1e-8), 60)",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"TS_RANK(TS_STD(MIN($close / DELAY($close, 1) - 1, 0), 5) / (EMA($volume, 60) + 0.00000001), 60)\" # Your output factor expression will be filled in here\n    name = \"Downside_Volatility_Liquidity_Gap_Ratio\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor simplifies the exhaustion hypothesis into a ratio of downside risk to smoothed volume, then applies a time-series rank to identify local extremes. It uses the 5-day downside deviation relative to the 60-day EMA of volume to pinpoint periods where price drops are occurring on disproportionately low structural participation.",
      "factor_formulation": "DVLG = TS\\_RANK(\\frac{TS\\_STD(MIN(return, 0), 5)}{EMA(volume, 60) + 1e-8}, 60)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity Exhaustion' factor, defined as the difference between the 60-day TS_RANK of 5-day downside semi-deviation and the 60-day TS_RANK of the 60-day EMA of volume, identifies high-conviction panic bottoms that predict positive future returns.\n                Concise Observation: Previous results show that rank-based liquidity gaps (volatility vs. volume) are highly predictive, but the direction-agnostic nature of standard deviation conflates 'exhaustion' at peaks with 'capitulation' at troughs.\n                Concise Justification: Downside semi-deviation isolates the risk of price drops; when this 'panic' volatility peaks while long-term structural volume (EMA) remains low, it indicates a lack of liquidity to absorb selling pressure, often leading to an oversold bounce or mean reversion as buyers return.\n                Concise Knowledge: If a liquidity gap (high volatility, low volume) is driven specifically by downside price action, it signals seller exhaustion rather than a blow-off top; when volume is smoothed by an EMA, the signal becomes more responsive to structural liquidity shifts than a simple moving average.\n                concise Specification: Calculate the 5-day downside semi-deviation (standard deviation of negative returns only) and its 60-day TS_RANK. Calculate the 60-day EMA of volume and its 60-day TS_RANK. The factor is the difference: TS_RANK(Downside_Vol, 60) - TS_RANK(EMA_Volume, 60).\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:20:22.037456"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1572285409569022,
        "ICIR": 0.0530403441648252,
        "1day.excess_return_without_cost.std": 0.0043830992301383,
        "1day.excess_return_with_cost.annualized_return": 0.0067400473133438,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002263845984003,
        "1day.excess_return_without_cost.annualized_return": 0.0538795344192741,
        "1day.excess_return_with_cost.std": 0.0043860391632996,
        "Rank IC": 0.0197215138438166,
        "IC": 0.0073471167829965,
        "1day.excess_return_without_cost.max_drawdown": -0.1165100515955113,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7968086734994563,
        "1day.pa": 0.0,
        "l2.valid": 0.9964699501378668,
        "Rank ICIR": 0.1513199158515729,
        "l2.train": 0.9929281420394236,
        "1day.excess_return_with_cost.information_ratio": 0.0996097755347108,
        "1day.excess_return_with_cost.mean": 2.831952652665486e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Exhaustion' hypothesis. The current results show a significant improvement in the Information Coefficient (IC), which rose from 0.0058 to 0.0073, indicating a stronger predictive signal for individual stock returns. However, the portfolio-level metrics (Annualized Return, Information Ratio, and Max Drawdown) showed slight deterioration compared to the SOTA. This suggests that while the raw signal strength (IC) improved, the risk-adjusted returns and drawdown characteristics of the current implementation are less stable than the previous best.",
        "hypothesis_evaluation": "The hypothesis that the gap between downside volatility and structural liquidity predicts positive returns is supported by the improved IC. The 'Downside_Volatility_Liquidity_Gap_Ratio' and 'Cross_Sectional_Panic_Exhaustion_Z' variations successfully captured the decoupling of price action and volume. However, the drop in Information Ratio suggests that the current 60-day window for volume EMA or the 5-day window for downside deviation might be introducing noise or capturing short-lived spikes that lead to higher turnover and drawdowns.",
        "decision": false,
        "reason": "1. The current 60-day EMA of volume can be heavily skewed by recent high-volume sell-offs, potentially masking the 'exhaustion' effect. A median (TS_MEDIAN) is more robust to outliers. 2. A 5-day window for downside deviation is very sensitive; extending it to 10 days may capture more significant 'panic' phases. 3. The high IC but lower IR suggests the signal is accurate but volatile; smoothing the inputs should stabilize the portfolio performance."
      }
    },
    "f5c570719092cfa7": {
      "factor_id": "f5c570719092cfa7",
      "factor_name": "Structural_Liquidity_Capitulation_Rank_Diff",
      "factor_expression": "RANK(TS_RANK(TS_STD(MIN($return, 0), 10), 60)) - RANK(TS_RANK(TS_MEDIAN($volume, 120), 60))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_RANK(TS_STD(($close/DELAY($close, 1)-1 < 0 ? $close/DELAY($close, 1)-1 : 0), 10), 60)) - RANK(TS_RANK(TS_MEDIAN($volume, 120), 60))\" # Your output factor expression will be filled in here\n    name = \"Structural_Liquidity_Capitulation_Rank_Diff\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies sustainable reversal points by measuring the divergence between downside price intensity and structural liquidity. It calculates the 10-day downside semi-deviation (standard deviation of negative returns) and compares its 60-day time-series rank against the 60-day time-series rank of the 120-day median volume. A high rank in downside volatility coupled with a low rank in median volume indicates a liquidity gap during panic selling, suggesting seller exhaustion.",
      "factor_formulation": "\\text{RANK}(\\text{TS_RANK}(\\text{TS_STD}(\\text{MIN}(\\$return, 0), 10), 60)) - \\text{RANK}(\\text{TS_RANK}(\\text{TS_MEDIAN}(\\$volume, 120), 60))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Structural Liquidity Capitulation' factor, which combines the 10-day downside semi-deviation with a 120-day volume median via cross-sectional normalization, identifies sustainable reversal points by filtering out idiosyncratic volume shocks.\n                Concise Observation: The previous attempt to use a 5-day window and 60-day EMA for volume resulted in a high IC but unstable IR, suggesting that the signal was too sensitive to short-term outliers and recent volume spikes that skewed the EMA baseline.\n                Concise Justification: A 120-day median provides a more stable 'structural' liquidity anchor than an EMA, as it is less influenced by the very panic-selling volume we are trying to measure against; extending the downside volatility window to 10 days filters out daily noise, focusing on multi-day capitulation phases.\n                Concise Knowledge: If downside price intensity is normalized against a long-term median volume baseline, the resulting signal identifies structural liquidity gaps; when this gap is extreme relative to the cross-section, it indicates a high-probability mean-reversion point due to seller exhaustion.\n                concise Specification: 1. Calculate 10-day downside semi-deviation (std of returns < 0). 2. Calculate 120-day median of daily volume. 3. Apply a 60-day TS_RANK to both. 4. Factor = CS_RANK(TS_RANK(Downside_Vol, 60)) - CS_RANK(TS_RANK(Median_Volume, 60)).\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:27:23.719482"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1226529344376921,
        "ICIR": 0.034773877643477,
        "1day.excess_return_without_cost.std": 0.0042199832573044,
        "1day.excess_return_with_cost.annualized_return": -0.0020758114520673,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001878582854787,
        "1day.excess_return_without_cost.annualized_return": 0.0447102719439401,
        "1day.excess_return_with_cost.std": 0.0042201819702068,
        "Rank IC": 0.0192409028595164,
        "IC": 0.0046266256296514,
        "1day.excess_return_without_cost.max_drawdown": -0.0942118248948852,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6867649227026622,
        "1day.pa": 0.0,
        "l2.valid": 0.9965006154625338,
        "Rank ICIR": 0.149521094558765,
        "l2.train": 0.993727619958263,
        "1day.excess_return_with_cost.information_ratio": -0.0318836657310382,
        "1day.excess_return_with_cost.mean": -8.721896857425826e-06
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Structural Liquidity Capitulation' hypothesis. While the 'Current Result' (representing the best of the three new factors) achieved a lower Max Drawdown (-0.0942 vs -0.0961) compared to the SOTA, it significantly underperformed in terms of Information Ratio (0.687 vs 0.950), Annualized Return (0.045 vs 0.060), and IC (0.0046 vs 0.0058). The 'Structural_Liquidity_Capitulation_Rank_Diff' and 'Normalized_Downside_Liquidity_Gap' both utilized nested time-series operations (TS_RANK/TS_ZSCORE on top of TS_STD), which may have introduced excessive lag or smoothed out the signal too much, leading to the observed decay in predictive power.",
        "hypothesis_evaluation": "The hypothesis that combining downside semi-deviation with structural volume identifies reversals is partially supported by the improved Max Drawdown, suggesting better tail-risk management. However, the current implementation methods (Rank Difference and Z-Score Difference) seem to dilute the signal intensity. The 'Capitulation_Volume_Ratio_Rank' is the most parsimonious approach but likely suffers from the scale mismatch between returns and volume, even with the median denominator.",
        "decision": false,
        "reason": "The previous iteration used a 120-day median volume, which might be too static to capture the immediate liquidity environment during a panic. By using a shorter volume baseline (20-day) and scaling the entire ratio by the long-term volatility of volume (120-day), we can better isolate instances where price volatility is truly 'disproportionate' to current liquidity conditions. This reduces complexity by avoiding nested TS_RANK/TS_ZSCORE functions while maintaining the core logic of identifying liquidity gaps."
      }
    },
    "4a73a2bd07fc59e0": {
      "factor_id": "4a73a2bd07fc59e0",
      "factor_name": "Normalized_Downside_Liquidity_Gap",
      "factor_expression": "ZSCORE(TS_ZSCORE(TS_STD(MIN($return, 0), 10), 60) - TS_ZSCORE(TS_MEDIAN($volume, 120), 60))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_ZSCORE(TS_STD(MIN(($close / DELAY($close, 1) - 1), 0), 10), 60) - TS_ZSCORE(TS_MEDIAN($volume, 120), 60))\" # Your output factor expression will be filled in here\n    name = \"Normalized_Downside_Liquidity_Gap\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A refined version of the liquidity exhaustion hypothesis that uses Z-score normalization to compare short-term panic (10-day downside volatility) against long-term structural volume (120-day median). By subtracting the volume Z-score from the downside volatility Z-score, it isolates assets where price drops are extreme relative to the underlying liquidity support, identifying potential mean-reversion candidates.",
      "factor_formulation": "\\text{ZSCORE}(\\text{TS_ZSCORE}(\\text{TS_STD}(\\text{MIN}(\\$return, 0), 10), 60) - \\text{TS_ZSCORE}(\\text{TS_MEDIAN}(\\$volume, 120), 60))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Structural Liquidity Capitulation' factor, which combines the 10-day downside semi-deviation with a 120-day volume median via cross-sectional normalization, identifies sustainable reversal points by filtering out idiosyncratic volume shocks.\n                Concise Observation: The previous attempt to use a 5-day window and 60-day EMA for volume resulted in a high IC but unstable IR, suggesting that the signal was too sensitive to short-term outliers and recent volume spikes that skewed the EMA baseline.\n                Concise Justification: A 120-day median provides a more stable 'structural' liquidity anchor than an EMA, as it is less influenced by the very panic-selling volume we are trying to measure against; extending the downside volatility window to 10 days filters out daily noise, focusing on multi-day capitulation phases.\n                Concise Knowledge: If downside price intensity is normalized against a long-term median volume baseline, the resulting signal identifies structural liquidity gaps; when this gap is extreme relative to the cross-section, it indicates a high-probability mean-reversion point due to seller exhaustion.\n                concise Specification: 1. Calculate 10-day downside semi-deviation (std of returns < 0). 2. Calculate 120-day median of daily volume. 3. Apply a 60-day TS_RANK to both. 4. Factor = CS_RANK(TS_RANK(Downside_Vol, 60)) - CS_RANK(TS_RANK(Median_Volume, 60)).\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:27:23.719482"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1226529344376921,
        "ICIR": 0.034773877643477,
        "1day.excess_return_without_cost.std": 0.0042199832573044,
        "1day.excess_return_with_cost.annualized_return": -0.0020758114520673,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001878582854787,
        "1day.excess_return_without_cost.annualized_return": 0.0447102719439401,
        "1day.excess_return_with_cost.std": 0.0042201819702068,
        "Rank IC": 0.0192409028595164,
        "IC": 0.0046266256296514,
        "1day.excess_return_without_cost.max_drawdown": -0.0942118248948852,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6867649227026622,
        "1day.pa": 0.0,
        "l2.valid": 0.9965006154625338,
        "Rank ICIR": 0.149521094558765,
        "l2.train": 0.993727619958263,
        "1day.excess_return_with_cost.information_ratio": -0.0318836657310382,
        "1day.excess_return_with_cost.mean": -8.721896857425826e-06
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Structural Liquidity Capitulation' hypothesis. While the 'Current Result' (representing the best of the three new factors) achieved a lower Max Drawdown (-0.0942 vs -0.0961) compared to the SOTA, it significantly underperformed in terms of Information Ratio (0.687 vs 0.950), Annualized Return (0.045 vs 0.060), and IC (0.0046 vs 0.0058). The 'Structural_Liquidity_Capitulation_Rank_Diff' and 'Normalized_Downside_Liquidity_Gap' both utilized nested time-series operations (TS_RANK/TS_ZSCORE on top of TS_STD), which may have introduced excessive lag or smoothed out the signal too much, leading to the observed decay in predictive power.",
        "hypothesis_evaluation": "The hypothesis that combining downside semi-deviation with structural volume identifies reversals is partially supported by the improved Max Drawdown, suggesting better tail-risk management. However, the current implementation methods (Rank Difference and Z-Score Difference) seem to dilute the signal intensity. The 'Capitulation_Volume_Ratio_Rank' is the most parsimonious approach but likely suffers from the scale mismatch between returns and volume, even with the median denominator.",
        "decision": false,
        "reason": "The previous iteration used a 120-day median volume, which might be too static to capture the immediate liquidity environment during a panic. By using a shorter volume baseline (20-day) and scaling the entire ratio by the long-term volatility of volume (120-day), we can better isolate instances where price volatility is truly 'disproportionate' to current liquidity conditions. This reduces complexity by avoiding nested TS_RANK/TS_ZSCORE functions while maintaining the core logic of identifying liquidity gaps."
      }
    },
    "5608ea3bca925bf7": {
      "factor_id": "5608ea3bca925bf7",
      "factor_name": "Capitulation_Volume_Ratio_Rank",
      "factor_expression": "RANK(TS_STD(MIN($return, 0), 10) / (TS_MEDIAN($volume, 120) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_STD(($close/DELAY($close, 1)-1 < 0 ? $close/DELAY($close, 1)-1 : 0), 10) / (TS_MEDIAN($volume, 120) + 0.00000001))\" # Your output factor expression will be filled in here\n    name = \"Capitulation_Volume_Ratio_Rank\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the ratio of downside volatility to structural volume, then applies cross-sectional ranking. It uses a 10-day window for downside risk and a 120-day median for volume to ensure stability. The ratio highlights stocks where the 'panic' is disproportionately large compared to the typical trading activity, signaling a high-probability reversal due to liquidity exhaustion.",
      "factor_formulation": "\\text{RANK}(\\text{TS_STD}(\\text{MIN}(\\$return, 0), 10) / (\\text{TS_MEDIAN}(\\$volume, 120) + 1e-8))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Structural Liquidity Capitulation' factor, which combines the 10-day downside semi-deviation with a 120-day volume median via cross-sectional normalization, identifies sustainable reversal points by filtering out idiosyncratic volume shocks.\n                Concise Observation: The previous attempt to use a 5-day window and 60-day EMA for volume resulted in a high IC but unstable IR, suggesting that the signal was too sensitive to short-term outliers and recent volume spikes that skewed the EMA baseline.\n                Concise Justification: A 120-day median provides a more stable 'structural' liquidity anchor than an EMA, as it is less influenced by the very panic-selling volume we are trying to measure against; extending the downside volatility window to 10 days filters out daily noise, focusing on multi-day capitulation phases.\n                Concise Knowledge: If downside price intensity is normalized against a long-term median volume baseline, the resulting signal identifies structural liquidity gaps; when this gap is extreme relative to the cross-section, it indicates a high-probability mean-reversion point due to seller exhaustion.\n                concise Specification: 1. Calculate 10-day downside semi-deviation (std of returns < 0). 2. Calculate 120-day median of daily volume. 3. Apply a 60-day TS_RANK to both. 4. Factor = CS_RANK(TS_RANK(Downside_Vol, 60)) - CS_RANK(TS_RANK(Median_Volume, 60)).\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:27:23.719482"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1226529344376921,
        "ICIR": 0.034773877643477,
        "1day.excess_return_without_cost.std": 0.0042199832573044,
        "1day.excess_return_with_cost.annualized_return": -0.0020758114520673,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001878582854787,
        "1day.excess_return_without_cost.annualized_return": 0.0447102719439401,
        "1day.excess_return_with_cost.std": 0.0042201819702068,
        "Rank IC": 0.0192409028595164,
        "IC": 0.0046266256296514,
        "1day.excess_return_without_cost.max_drawdown": -0.0942118248948852,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6867649227026622,
        "1day.pa": 0.0,
        "l2.valid": 0.9965006154625338,
        "Rank ICIR": 0.149521094558765,
        "l2.train": 0.993727619958263,
        "1day.excess_return_with_cost.information_ratio": -0.0318836657310382,
        "1day.excess_return_with_cost.mean": -8.721896857425826e-06
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Structural Liquidity Capitulation' hypothesis. While the 'Current Result' (representing the best of the three new factors) achieved a lower Max Drawdown (-0.0942 vs -0.0961) compared to the SOTA, it significantly underperformed in terms of Information Ratio (0.687 vs 0.950), Annualized Return (0.045 vs 0.060), and IC (0.0046 vs 0.0058). The 'Structural_Liquidity_Capitulation_Rank_Diff' and 'Normalized_Downside_Liquidity_Gap' both utilized nested time-series operations (TS_RANK/TS_ZSCORE on top of TS_STD), which may have introduced excessive lag or smoothed out the signal too much, leading to the observed decay in predictive power.",
        "hypothesis_evaluation": "The hypothesis that combining downside semi-deviation with structural volume identifies reversals is partially supported by the improved Max Drawdown, suggesting better tail-risk management. However, the current implementation methods (Rank Difference and Z-Score Difference) seem to dilute the signal intensity. The 'Capitulation_Volume_Ratio_Rank' is the most parsimonious approach but likely suffers from the scale mismatch between returns and volume, even with the median denominator.",
        "decision": false,
        "reason": "The previous iteration used a 120-day median volume, which might be too static to capture the immediate liquidity environment during a panic. By using a shorter volume baseline (20-day) and scaling the entire ratio by the long-term volatility of volume (120-day), we can better isolate instances where price volatility is truly 'disproportionate' to current liquidity conditions. This reduces complexity by avoiding nested TS_RANK/TS_ZSCORE functions while maintaining the core logic of identifying liquidity gaps."
      }
    },
    "07cf20e6b3bc3829": {
      "factor_id": "07cf20e6b3bc3829",
      "factor_name": "Liquidity_Adjusted_Price_Pressure_5D",
      "factor_expression": "ZSCORE(TS_PCTCHANGE($close, 5) * (TS_STD($close, 5) / (TS_MEAN($volume, 20) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_PCTCHANGE($close, 5) * (TS_STD($close, 5) / (TS_MEAN($volume, 20) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Adjusted_Price_Pressure_5D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies price overextensions by multiplying the 5-day return with the ratio of 5-day price volatility to 20-day average volume turnover. It captures 'unsupported' price moves (high volatility, low volume) that are likely to revert, using the sign of the return to distinguish between blow-off tops and panic bottoms.",
      "factor_formulation": "ZSCORE(TS\\_PCTCHANGE(close, 5) \\times \\frac{TS\\_STD(close, 5)}{TS\\_MEAN(volume, 20)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity-Adjusted Price Pressure' factor, defined as the 5-day price change signed by the ratio of 5-day volatility to 20-day volume turnover, identifies price overextensions that are likely to revert when volume support is absent.\n                Concise Observation: Previous attempts using long-term (120-day) medians or nested TS_RANKs (Hypothesis 4) diluted the signal's responsiveness, while simple ratios (Hypothesis 1) were too noisy; the best performance (Hypothesis 2) came from 5-day volatility windows but lacked directional conviction.\n                Concise Justification: By multiplying the 5-day return by the ratio of 5-day volatility to 20-day volume, we create a 'signed' liquidity gap. This distinguishes between 'unsupported' rallies (high positive values) and 'unsupported' sell-offs (high negative values), allowing the model to capture both blow-off tops and panic bottoms within a single, responsive metric.\n                Concise Knowledge: If a significant price move occurs with high volatility but low volume turnover relative to recent history, the move is likely fragile; when price pressure is normalized by liquidity, extreme values indicate exhaustion points rather than sustainable trends.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day standard deviation of close prices. 3. Calculate 20-day mean of volume. 4. Factor = 5-day return * (5-day volatility / 20-day mean volume). 5. Apply cross-sectional Z-score to the final product to ensure comparability.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:32:16.929084"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1893116805906744,
        "ICIR": 0.0392995196020345,
        "1day.excess_return_without_cost.std": 0.0053467766680287,
        "1day.excess_return_with_cost.annualized_return": 0.0036436104796467,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002154033593873,
        "1day.excess_return_without_cost.annualized_return": 0.0512659995341818,
        "1day.excess_return_with_cost.std": 0.0053512139855563,
        "Rank IC": 0.0210116280647849,
        "IC": 0.0059238992324992,
        "1day.excess_return_without_cost.max_drawdown": -0.1298936433583216,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6215111244197843,
        "1day.pa": 0.0,
        "l2.valid": 0.9960395990172778,
        "Rank ICIR": 0.1408200777674782,
        "l2.train": 0.9939645044272016,
        "1day.excess_return_with_cost.information_ratio": 0.0441358145358327,
        "1day.excess_return_with_cost.mean": 1.530928772960809e-05
      },
      "feedback": {
        "observations": "The current iteration focused on different mathematical representations of the 'Liquidity-Adjusted Price Pressure' concept, specifically testing Z-Score, Rank, and Sum-based aggregations. The 'Volatility_Volume_Divergence_Pressure' factor achieved a higher Information Coefficient (IC) of 0.0059 compared to the SOTA (0.0058), indicating a slightly better predictive correlation at the individual stock level. However, the portfolio-level metrics (Annualized Return, Information Ratio, and Max Drawdown) showed deterioration compared to the SOTA, suggesting that while the signal is 'cleaner' in terms of correlation, the tail performance or risk-adjusted consistency has weakened.",
        "hypothesis_evaluation": "The hypothesis that price moves unsupported by volume (high volatility/low turnover) lead to mean reversion is supported by the positive IC. The current implementation using 'TS_SUM(return, 5)' instead of 'TS_PCTCHANGE' suggests that cumulative daily returns provide a more stable signal for price pressure than point-to-point changes. However, the increase in Max Drawdown (-0.129 vs -0.096) indicates that the current weighting (volatility/volume) might be too aggressive during market-wide liquidity shocks, leading to higher risk.",
        "decision": false,
        "reason": "The current factors use raw volume in the denominator, which varies significantly across different market caps, potentially biasing the factor towards small-cap stocks with naturally lower volume. Using turnover or a log-transform of the ratio will normalize the 'liquidity vacuum' signal across the cross-section. Furthermore, the deterioration in IR and Max Drawdown suggests the factor is currently too sensitive to extreme volatility spikes; a dampening function or a more robust denominator (like median volume) could stabilize the signal."
      }
    },
    "876691d2c9d3d2c4": {
      "factor_id": "876691d2c9d3d2c4",
      "factor_name": "Signed_Liquidity_Gap_Exhaustion",
      "factor_expression": "RANK((($close / (DELAY($close, 5) + 1e-8)) - 1) * (TS_STD($close, 5) / (TS_MEAN($volume, 20) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK((($close / (DELAY($close, 5) + 1e-8)) - 1) * (TS_STD($close, 5) / (TS_MEAN($volume, 20) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Signed_Liquidity_Gap_Exhaustion\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A refined version of the liquidity-adjusted pressure factor that uses the 5-day return signed by the ratio of short-term volatility to medium-term volume. It targets periods where price moves are extreme relative to the liquidity available to sustain them, normalized cross-sectionally for comparability.",
      "factor_formulation": "RANK((\\frac{close}{DELAY(close, 5)} - 1) \\times \\frac{TS\\_STD(close, 5)}{TS\\_MEAN(volume, 20)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity-Adjusted Price Pressure' factor, defined as the 5-day price change signed by the ratio of 5-day volatility to 20-day volume turnover, identifies price overextensions that are likely to revert when volume support is absent.\n                Concise Observation: Previous attempts using long-term (120-day) medians or nested TS_RANKs (Hypothesis 4) diluted the signal's responsiveness, while simple ratios (Hypothesis 1) were too noisy; the best performance (Hypothesis 2) came from 5-day volatility windows but lacked directional conviction.\n                Concise Justification: By multiplying the 5-day return by the ratio of 5-day volatility to 20-day volume, we create a 'signed' liquidity gap. This distinguishes between 'unsupported' rallies (high positive values) and 'unsupported' sell-offs (high negative values), allowing the model to capture both blow-off tops and panic bottoms within a single, responsive metric.\n                Concise Knowledge: If a significant price move occurs with high volatility but low volume turnover relative to recent history, the move is likely fragile; when price pressure is normalized by liquidity, extreme values indicate exhaustion points rather than sustainable trends.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day standard deviation of close prices. 3. Calculate 20-day mean of volume. 4. Factor = 5-day return * (5-day volatility / 20-day mean volume). 5. Apply cross-sectional Z-score to the final product to ensure comparability.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:32:16.929084"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1893116805906744,
        "ICIR": 0.0392995196020345,
        "1day.excess_return_without_cost.std": 0.0053467766680287,
        "1day.excess_return_with_cost.annualized_return": 0.0036436104796467,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002154033593873,
        "1day.excess_return_without_cost.annualized_return": 0.0512659995341818,
        "1day.excess_return_with_cost.std": 0.0053512139855563,
        "Rank IC": 0.0210116280647849,
        "IC": 0.0059238992324992,
        "1day.excess_return_without_cost.max_drawdown": -0.1298936433583216,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6215111244197843,
        "1day.pa": 0.0,
        "l2.valid": 0.9960395990172778,
        "Rank ICIR": 0.1408200777674782,
        "l2.train": 0.9939645044272016,
        "1day.excess_return_with_cost.information_ratio": 0.0441358145358327,
        "1day.excess_return_with_cost.mean": 1.530928772960809e-05
      },
      "feedback": {
        "observations": "The current iteration focused on different mathematical representations of the 'Liquidity-Adjusted Price Pressure' concept, specifically testing Z-Score, Rank, and Sum-based aggregations. The 'Volatility_Volume_Divergence_Pressure' factor achieved a higher Information Coefficient (IC) of 0.0059 compared to the SOTA (0.0058), indicating a slightly better predictive correlation at the individual stock level. However, the portfolio-level metrics (Annualized Return, Information Ratio, and Max Drawdown) showed deterioration compared to the SOTA, suggesting that while the signal is 'cleaner' in terms of correlation, the tail performance or risk-adjusted consistency has weakened.",
        "hypothesis_evaluation": "The hypothesis that price moves unsupported by volume (high volatility/low turnover) lead to mean reversion is supported by the positive IC. The current implementation using 'TS_SUM(return, 5)' instead of 'TS_PCTCHANGE' suggests that cumulative daily returns provide a more stable signal for price pressure than point-to-point changes. However, the increase in Max Drawdown (-0.129 vs -0.096) indicates that the current weighting (volatility/volume) might be too aggressive during market-wide liquidity shocks, leading to higher risk.",
        "decision": false,
        "reason": "The current factors use raw volume in the denominator, which varies significantly across different market caps, potentially biasing the factor towards small-cap stocks with naturally lower volume. Using turnover or a log-transform of the ratio will normalize the 'liquidity vacuum' signal across the cross-section. Furthermore, the deterioration in IR and Max Drawdown suggests the factor is currently too sensitive to extreme volatility spikes; a dampening function or a more robust denominator (like median volume) could stabilize the signal."
      }
    },
    "c508b1d58ca951f6": {
      "factor_id": "c508b1d58ca951f6",
      "factor_name": "Volatility_Volume_Divergence_Pressure",
      "factor_expression": "TS_SUM($return, 5) * (TS_STD($return, 5) / (TS_MEAN($volume, 20) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"TS_SUM(TS_PCTCHANGE($close, 1), 5) * (TS_STD(TS_PCTCHANGE($close, 1), 5) / (TS_MEAN($volume, 20) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Volatility_Volume_Divergence_Pressure\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures the divergence between price volatility and volume support. By weighting the 5-day return with the ratio of volatility to volume, it highlights price moves occurring in a 'liquidity vacuum'. High positive values suggest exhaustion in rallies, while low negative values suggest exhaustion in sell-offs.",
      "factor_formulation": "TS\\_SUM(return, 5) \\times \\frac{TS\\_STD(return, 5)}{TS\\_MEAN(volume, 20)}",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity-Adjusted Price Pressure' factor, defined as the 5-day price change signed by the ratio of 5-day volatility to 20-day volume turnover, identifies price overextensions that are likely to revert when volume support is absent.\n                Concise Observation: Previous attempts using long-term (120-day) medians or nested TS_RANKs (Hypothesis 4) diluted the signal's responsiveness, while simple ratios (Hypothesis 1) were too noisy; the best performance (Hypothesis 2) came from 5-day volatility windows but lacked directional conviction.\n                Concise Justification: By multiplying the 5-day return by the ratio of 5-day volatility to 20-day volume, we create a 'signed' liquidity gap. This distinguishes between 'unsupported' rallies (high positive values) and 'unsupported' sell-offs (high negative values), allowing the model to capture both blow-off tops and panic bottoms within a single, responsive metric.\n                Concise Knowledge: If a significant price move occurs with high volatility but low volume turnover relative to recent history, the move is likely fragile; when price pressure is normalized by liquidity, extreme values indicate exhaustion points rather than sustainable trends.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day standard deviation of close prices. 3. Calculate 20-day mean of volume. 4. Factor = 5-day return * (5-day volatility / 20-day mean volume). 5. Apply cross-sectional Z-score to the final product to ensure comparability.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:32:16.929084"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1893116805906744,
        "ICIR": 0.0392995196020345,
        "1day.excess_return_without_cost.std": 0.0053467766680287,
        "1day.excess_return_with_cost.annualized_return": 0.0036436104796467,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002154033593873,
        "1day.excess_return_without_cost.annualized_return": 0.0512659995341818,
        "1day.excess_return_with_cost.std": 0.0053512139855563,
        "Rank IC": 0.0210116280647849,
        "IC": 0.0059238992324992,
        "1day.excess_return_without_cost.max_drawdown": -0.1298936433583216,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6215111244197843,
        "1day.pa": 0.0,
        "l2.valid": 0.9960395990172778,
        "Rank ICIR": 0.1408200777674782,
        "l2.train": 0.9939645044272016,
        "1day.excess_return_with_cost.information_ratio": 0.0441358145358327,
        "1day.excess_return_with_cost.mean": 1.530928772960809e-05
      },
      "feedback": {
        "observations": "The current iteration focused on different mathematical representations of the 'Liquidity-Adjusted Price Pressure' concept, specifically testing Z-Score, Rank, and Sum-based aggregations. The 'Volatility_Volume_Divergence_Pressure' factor achieved a higher Information Coefficient (IC) of 0.0059 compared to the SOTA (0.0058), indicating a slightly better predictive correlation at the individual stock level. However, the portfolio-level metrics (Annualized Return, Information Ratio, and Max Drawdown) showed deterioration compared to the SOTA, suggesting that while the signal is 'cleaner' in terms of correlation, the tail performance or risk-adjusted consistency has weakened.",
        "hypothesis_evaluation": "The hypothesis that price moves unsupported by volume (high volatility/low turnover) lead to mean reversion is supported by the positive IC. The current implementation using 'TS_SUM(return, 5)' instead of 'TS_PCTCHANGE' suggests that cumulative daily returns provide a more stable signal for price pressure than point-to-point changes. However, the increase in Max Drawdown (-0.129 vs -0.096) indicates that the current weighting (volatility/volume) might be too aggressive during market-wide liquidity shocks, leading to higher risk.",
        "decision": false,
        "reason": "The current factors use raw volume in the denominator, which varies significantly across different market caps, potentially biasing the factor towards small-cap stocks with naturally lower volume. Using turnover or a log-transform of the ratio will normalize the 'liquidity vacuum' signal across the cross-section. Furthermore, the deterioration in IR and Max Drawdown suggests the factor is currently too sensitive to extreme volatility spikes; a dampening function or a more robust denominator (like median volume) could stabilize the signal."
      }
    },
    "fe9cc5c7fe07e952": {
      "factor_id": "fe9cc5c7fe07e952",
      "factor_name": "Relative_Liquidity_Strain_Factor",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 5) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 5) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Relative_Liquidity_Strain_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies price overextensions by weighting the 5-day return with the ratio of 5-day price volatility to the 60-day median volume. It targets 'liquidity-driven anomalies' where price moves occur on high volatility but lack structural volume support, making them prone to mean reversion.",
      "factor_formulation": "\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 5) \\times \\frac{\\text{TS_STD}(\\text{close}, 5)}{\\text{TS_MEDIAN}(\\text{volume}, 60)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Relative Liquidity Strain' factor, which uses the 5-day price return weighted by the ratio of 5-day price volatility to the 60-day median volume, identifies price overextensions that are prone to mean reversion when adjusted for structural liquidity baselines.\n                Concise Observation: Previous attempts failed when using raw volume or EMAs because they were too sensitive to the very 'panic volume' they tried to measure; however, the direction-agnostic volatility (Hypothesis 2) performed best, suggesting that combining direction (return) with a robust structural baseline (median) is the missing link.\n                Concise Justification: Using a 60-day median volume provides a stable 'structural' anchor that is resistant to recent outliers, while the 5-day return provides the necessary directionality. Multiplying the return by the volatility-to-median-volume ratio scales the signal by the intensity of the liquidity strain, effectively flagging unsustainable price jumps or drops.\n                Concise Knowledge: If a short-term price trend (5-day return) is accompanied by high volatility but low structural liquidity (60-day median volume), the price move is likely a 'liquidity-driven anomaly' rather than a 'fundamental trend'; such moves are statistically prone to reversal as the liquidity gap closes.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day standard deviation of close prices. 3. Calculate 60-day median of daily volume. 4. Factor = 5-day return * (5-day volatility / 60-day median volume). 5. Apply cross-sectional Rank (CS_RANK) to the final product to ensure stability and reduce the impact of outliers.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:37:15.523515"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1465591400774683,
        "ICIR": 0.0366840479661189,
        "1day.excess_return_without_cost.std": 0.0051750800887403,
        "1day.excess_return_with_cost.annualized_return": 0.0130523545667223,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002542746972788,
        "1day.excess_return_without_cost.annualized_return": 0.0605173779523604,
        "1day.excess_return_with_cost.std": 0.0051787188945407,
        "Rank IC": 0.0195383087344701,
        "IC": 0.0054039494992776,
        "1day.excess_return_without_cost.max_drawdown": -0.1023840643574491,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7580093265355107,
        "1day.pa": 0.0,
        "l2.valid": 0.9961154299025866,
        "Rank ICIR": 0.1341669385248587,
        "l2.train": 0.9938914465040976,
        "1day.excess_return_with_cost.information_ratio": 0.1633721583187582,
        "1day.excess_return_with_cost.mean": 5.484182591059806e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Relative Liquidity Strain' hypothesis. The current results show a slight improvement in annualized return (0.0605 vs 0.0595) compared to the SOTA, but a noticeable decline in Information Ratio (0.758 vs 0.950) and IC (0.0054 vs 0.0058). The Max Drawdown also deepened. The factors effectively utilize a 5-day price momentum window scaled by a volatility-to-volume ratio, confirming that price moves occurring under low structural liquidity (high volatility/low median volume) contain predictive power, though the current implementation has increased the strategy's risk profile.",
        "hypothesis_evaluation": "The hypothesis that liquidity strain identifies mean-reverting overextensions is supported by the positive annualized return and IC. However, the drop in Information Ratio suggests that the current weighting (TS_STD / TS_MEDIAN_volume) might be introducing too much noise or 'tail risk'. The 'Structural_Liquidity_Gap_Pressure' (using TS_SUM of returns) and 'Liquidity_Anchored_Volatility_Divergence' (using DELTA/DELAY) are mathematically similar but the latter's use of cross-sectional RANK helps in stabilizing the signal, yet it hasn't surpassed the SOTA's risk-adjusted efficiency.",
        "decision": true,
        "reason": "The current factors use raw TS_STD(close, 5), which includes market-wide volatility. By replacing this with the standard deviation of residuals from a simple market model (or a ratio of stock volatility to market volatility), we can better identify 'liquidity-driven anomalies' unique to the stock. Additionally, using a 60-day median volume is a good baseline, but normalizing the current volume relative to this baseline (Volume Surge) might provide a more dynamic 'strain' indicator than just the price volatility alone. The goal is to improve the Information Ratio by reducing exposure to systematic volatility."
      }
    },
    "fe9c64499c5bccbd": {
      "factor_id": "fe9c64499c5bccbd",
      "factor_name": "Structural_Liquidity_Gap_Pressure",
      "factor_expression": "ZSCORE(TS_SUM($return, 5) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_SUM(($close / DELAY($close, 1) - 1), 5) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Structural_Liquidity_Gap_Pressure\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A variation of the liquidity strain hypothesis that uses the 5-day cumulative return (TS_SUM of daily returns) to measure price pressure, scaled by the ratio of short-term volatility to a robust 60-day median volume baseline. This captures the intensity of price moves relative to structural liquidity.",
      "factor_formulation": "\\text{ZSCORE}(\\text{TS_SUM}(\\text{return}, 5) \\times \\frac{\\text{TS_STD}(\\text{close}, 5)}{\\text{TS_MEDIAN}(\\text{volume}, 60)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Relative Liquidity Strain' factor, which uses the 5-day price return weighted by the ratio of 5-day price volatility to the 60-day median volume, identifies price overextensions that are prone to mean reversion when adjusted for structural liquidity baselines.\n                Concise Observation: Previous attempts failed when using raw volume or EMAs because they were too sensitive to the very 'panic volume' they tried to measure; however, the direction-agnostic volatility (Hypothesis 2) performed best, suggesting that combining direction (return) with a robust structural baseline (median) is the missing link.\n                Concise Justification: Using a 60-day median volume provides a stable 'structural' anchor that is resistant to recent outliers, while the 5-day return provides the necessary directionality. Multiplying the return by the volatility-to-median-volume ratio scales the signal by the intensity of the liquidity strain, effectively flagging unsustainable price jumps or drops.\n                Concise Knowledge: If a short-term price trend (5-day return) is accompanied by high volatility but low structural liquidity (60-day median volume), the price move is likely a 'liquidity-driven anomaly' rather than a 'fundamental trend'; such moves are statistically prone to reversal as the liquidity gap closes.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day standard deviation of close prices. 3. Calculate 60-day median of daily volume. 4. Factor = 5-day return * (5-day volatility / 60-day median volume). 5. Apply cross-sectional Rank (CS_RANK) to the final product to ensure stability and reduce the impact of outliers.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:37:15.523515"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1465591400774683,
        "ICIR": 0.0366840479661189,
        "1day.excess_return_without_cost.std": 0.0051750800887403,
        "1day.excess_return_with_cost.annualized_return": 0.0130523545667223,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002542746972788,
        "1day.excess_return_without_cost.annualized_return": 0.0605173779523604,
        "1day.excess_return_with_cost.std": 0.0051787188945407,
        "Rank IC": 0.0195383087344701,
        "IC": 0.0054039494992776,
        "1day.excess_return_without_cost.max_drawdown": -0.1023840643574491,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7580093265355107,
        "1day.pa": 0.0,
        "l2.valid": 0.9961154299025866,
        "Rank ICIR": 0.1341669385248587,
        "l2.train": 0.9938914465040976,
        "1day.excess_return_with_cost.information_ratio": 0.1633721583187582,
        "1day.excess_return_with_cost.mean": 5.484182591059806e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Relative Liquidity Strain' hypothesis. The current results show a slight improvement in annualized return (0.0605 vs 0.0595) compared to the SOTA, but a noticeable decline in Information Ratio (0.758 vs 0.950) and IC (0.0054 vs 0.0058). The Max Drawdown also deepened. The factors effectively utilize a 5-day price momentum window scaled by a volatility-to-volume ratio, confirming that price moves occurring under low structural liquidity (high volatility/low median volume) contain predictive power, though the current implementation has increased the strategy's risk profile.",
        "hypothesis_evaluation": "The hypothesis that liquidity strain identifies mean-reverting overextensions is supported by the positive annualized return and IC. However, the drop in Information Ratio suggests that the current weighting (TS_STD / TS_MEDIAN_volume) might be introducing too much noise or 'tail risk'. The 'Structural_Liquidity_Gap_Pressure' (using TS_SUM of returns) and 'Liquidity_Anchored_Volatility_Divergence' (using DELTA/DELAY) are mathematically similar but the latter's use of cross-sectional RANK helps in stabilizing the signal, yet it hasn't surpassed the SOTA's risk-adjusted efficiency.",
        "decision": true,
        "reason": "The current factors use raw TS_STD(close, 5), which includes market-wide volatility. By replacing this with the standard deviation of residuals from a simple market model (or a ratio of stock volatility to market volatility), we can better identify 'liquidity-driven anomalies' unique to the stock. Additionally, using a 60-day median volume is a good baseline, but normalizing the current volume relative to this baseline (Volume Surge) might provide a more dynamic 'strain' indicator than just the price volatility alone. The goal is to improve the Information Ratio by reducing exposure to systematic volatility."
      }
    },
    "87afc6437e896d22": {
      "factor_id": "87afc6437e896d22",
      "factor_name": "Liquidity_Anchored_Volatility_Divergence",
      "factor_expression": "RANK((DELTA($close, 5) / (DELAY($close, 5) + 1e-8)) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK((DELTA($close, 5) / (DELAY($close, 5) + 1e-8)) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Anchored_Volatility_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor isolates the 'liquidity gap' by multiplying the directional 5-day price change by the ratio of 5-day volatility to the 60-day median volume, then applying a cross-sectional rank to stabilize the signal against outliers and market-wide shocks.",
      "factor_formulation": "\\text{RANK}(\\frac{\\text{DELTA}(\\text{close}, 5)}{\\text{DELAY}(\\text{close}, 5)} \\times \\frac{\\text{TS_STD}(\\text{close}, 5)}{\\text{TS_MEDIAN}(\\text{volume}, 60)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Relative Liquidity Strain' factor, which uses the 5-day price return weighted by the ratio of 5-day price volatility to the 60-day median volume, identifies price overextensions that are prone to mean reversion when adjusted for structural liquidity baselines.\n                Concise Observation: Previous attempts failed when using raw volume or EMAs because they were too sensitive to the very 'panic volume' they tried to measure; however, the direction-agnostic volatility (Hypothesis 2) performed best, suggesting that combining direction (return) with a robust structural baseline (median) is the missing link.\n                Concise Justification: Using a 60-day median volume provides a stable 'structural' anchor that is resistant to recent outliers, while the 5-day return provides the necessary directionality. Multiplying the return by the volatility-to-median-volume ratio scales the signal by the intensity of the liquidity strain, effectively flagging unsustainable price jumps or drops.\n                Concise Knowledge: If a short-term price trend (5-day return) is accompanied by high volatility but low structural liquidity (60-day median volume), the price move is likely a 'liquidity-driven anomaly' rather than a 'fundamental trend'; such moves are statistically prone to reversal as the liquidity gap closes.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day standard deviation of close prices. 3. Calculate 60-day median of daily volume. 4. Factor = 5-day return * (5-day volatility / 60-day median volume). 5. Apply cross-sectional Rank (CS_RANK) to the final product to ensure stability and reduce the impact of outliers.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:37:15.523515"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1465591400774683,
        "ICIR": 0.0366840479661189,
        "1day.excess_return_without_cost.std": 0.0051750800887403,
        "1day.excess_return_with_cost.annualized_return": 0.0130523545667223,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002542746972788,
        "1day.excess_return_without_cost.annualized_return": 0.0605173779523604,
        "1day.excess_return_with_cost.std": 0.0051787188945407,
        "Rank IC": 0.0195383087344701,
        "IC": 0.0054039494992776,
        "1day.excess_return_without_cost.max_drawdown": -0.1023840643574491,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.7580093265355107,
        "1day.pa": 0.0,
        "l2.valid": 0.9961154299025866,
        "Rank ICIR": 0.1341669385248587,
        "l2.train": 0.9938914465040976,
        "1day.excess_return_with_cost.information_ratio": 0.1633721583187582,
        "1day.excess_return_with_cost.mean": 5.484182591059806e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Relative Liquidity Strain' hypothesis. The current results show a slight improvement in annualized return (0.0605 vs 0.0595) compared to the SOTA, but a noticeable decline in Information Ratio (0.758 vs 0.950) and IC (0.0054 vs 0.0058). The Max Drawdown also deepened. The factors effectively utilize a 5-day price momentum window scaled by a volatility-to-volume ratio, confirming that price moves occurring under low structural liquidity (high volatility/low median volume) contain predictive power, though the current implementation has increased the strategy's risk profile.",
        "hypothesis_evaluation": "The hypothesis that liquidity strain identifies mean-reverting overextensions is supported by the positive annualized return and IC. However, the drop in Information Ratio suggests that the current weighting (TS_STD / TS_MEDIAN_volume) might be introducing too much noise or 'tail risk'. The 'Structural_Liquidity_Gap_Pressure' (using TS_SUM of returns) and 'Liquidity_Anchored_Volatility_Divergence' (using DELTA/DELAY) are mathematically similar but the latter's use of cross-sectional RANK helps in stabilizing the signal, yet it hasn't surpassed the SOTA's risk-adjusted efficiency.",
        "decision": true,
        "reason": "The current factors use raw TS_STD(close, 5), which includes market-wide volatility. By replacing this with the standard deviation of residuals from a simple market model (or a ratio of stock volatility to market volatility), we can better identify 'liquidity-driven anomalies' unique to the stock. Additionally, using a 60-day median volume is a good baseline, but normalizing the current volume relative to this baseline (Volume Surge) might provide a more dynamic 'strain' indicator than just the price volatility alone. The goal is to improve the Information Ratio by reducing exposure to systematic volatility."
      }
    },
    "02699ce5612dbd57": {
      "factor_id": "02699ce5612dbd57",
      "factor_name": "Idiosyncratic_Liquidity_Strain_Ratio",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 5) * ((TS_STD($close, 5) / (MEAN(TS_STD($close, 5)) + 1e-8)) / (TS_MEDIAN($volume, 60) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 5) * ((TS_STD($close, 5) / (MEAN(TS_STD($close, 5)) + 1e-8)) / (TS_MEDIAN($volume, 60) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Idiosyncratic_Liquidity_Strain_Ratio\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies mean-reverting price anomalies by scaling 5-day returns by the ratio of idiosyncratic volatility to the long-term volume baseline. Idiosyncratic volatility is isolated by dividing the stock's 5-day price standard deviation by the cross-sectional average volatility, ensuring the signal captures stock-specific panic rather than market-wide shocks.",
      "factor_formulation": "Factor = \\text{RANK}\\left( \\text{TS\\_PCTCHANGE}(\\text{close}, 5) \\times \\frac{\\text{TS\\_STD}(\\text{close}, 5) / \\text{MEAN}(\\text{TS\\_STD}(\\text{close}, 5))}{\\text{TS\\_MEDIAN}(\\text{volume}, 60) + 1e-8} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Idiosyncratic Liquidity Strain' factor identifies mean-reverting price anomalies by scaling short-term returns by the ratio of stock-specific volatility (relative to market volatility) to the structural volume baseline.\n                Concise Observation: Previous 'Liquidity Strain' factors (Hypothesis 6) improved raw returns but suffered from high drawdowns and lower IR, likely because they captured systematic volatility that doesn't necessarily mean-revert at the instrument level.\n                Concise Justification: By normalizing the 5-day price volatility against the cross-sectional average (market volatility), we isolate stock-specific 'panic' or 'hype'. Combining this with a stable 60-day median volume anchor ensures the signal identifies true liquidity vacuums unique to the asset, reducing exposure to market-wide risk and improving the Information Ratio.\n                Concise Knowledge: If an instrument's price volatility significantly exceeds the market's average volatility during a price move unsupported by structural liquidity, the move is likely idiosyncratic noise; when such specific strain occurs, the asset's return tends to revert more reliably than during systematic market-wide shocks.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day price volatility: TS_STD(close, 5). 3. Calculate 'Relative Volatility': 5-day volatility / CS_MEAN(5-day volatility). 4. Calculate 60-day median volume. 5. Factor = 5-day return * (Relative Volatility / 60-day median volume). 6. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:42:15.564665"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1341723877847651,
        "ICIR": 0.0340883390271897,
        "1day.excess_return_without_cost.std": 0.0052235669839423,
        "1day.excess_return_with_cost.annualized_return": 0.0100658110264001,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002404073415933,
        "1day.excess_return_without_cost.annualized_return": 0.0572169472992247,
        "1day.excess_return_with_cost.std": 0.0052258969828415,
        "Rank IC": 0.0188230758639125,
        "IC": 0.0050929626133617,
        "1day.excess_return_without_cost.max_drawdown": -0.1074538614820513,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.71001747280465,
        "1day.pa": 0.0,
        "l2.valid": 0.9960109409579476,
        "Rank ICIR": 0.1272690389547701,
        "l2.train": 0.9930849042205716,
        "1day.excess_return_with_cost.information_ratio": 0.1248531344821367,
        "1day.excess_return_with_cost.mean": 4.229332364033697e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Idiosyncratic Liquidity Strain' hypothesis. While the conceptual framework of scaling returns by a volatility-to-volume ratio remains promising, the current implementations (Idiosyncratic_Liquidity_Strain_Ratio, Dynamic_Idiosyncratic_Strain_Z, and Log_Liquidity_Vacuum_Index) failed to outperform the existing SOTA. The Information Ratio (0.7100 vs 0.7580) and IC (0.0051 vs 0.0054) show a slight deterioration. The use of cross-sectional normalization (MEAN/MEDIAN of TS_STD) and volume anchors (60-day median) provides a stable signal, but the interaction between the return sign and the liquidity vacuum index may be too linear or noisy in its current form.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by idiosyncratic liquidity strain identifies mean reversion is supported in principle, as the metrics remain positive and significant. However, the 'strain' component (volatility/volume) might be better captured by looking at the *change* in liquidity availability rather than the absolute level relative to a 60-day baseline. The current 60-day volume median might be too slow to react to sudden liquidity 'vacuums' that trigger mean-reverting spikes.",
        "decision": false,
        "reason": "The current factors used a static 60-day volume anchor. By replacing this with a dynamic volume ratio (short-term/medium-term), we can better identify 'exhaustion' points where high volatility occurs on declining relative volume. Furthermore, using a 3-day return window instead of 5-day may capture the mean-reversion signal more sharply before the market adjusts, reducing the lag observed in the current IR and IC metrics. This maintains a low complexity (SL < 100, ER < 4) while refining the 'Liquidity Strain' definition."
      }
    },
    "8899b2e9b1751614": {
      "factor_id": "8899b2e9b1751614",
      "factor_name": "Dynamic_Idiosyncratic_Strain_Z",
      "factor_expression": "ZSCORE((DELTA($close, 5) / $close) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) * STD(TS_STD($close, 5)) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE((DELTA($close, 5) / $close) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 60) * STD(TS_STD($close, 5)) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Dynamic_Idiosyncratic_Strain_Z\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures liquidity strain by comparing the current 5-day return magnitude against a volatility-adjusted volume anchor. It normalizes the stock-specific volatility (relative to the market) by the stability of the long-term volume (60-day median), using a Z-score to identify extreme idiosyncratic outliers likely to revert.",
      "factor_formulation": "Factor = \\text{ZSCORE}\\left( \\frac{\\text{DELTA}(\\text{close}, 5)}{\\text{close}} \\times \\frac{\\text{TS\\_STD}(\\text{close}, 5)}{\\text{TS\\_MEDIAN}(\\text{volume}, 60) \\times \\text{STD}(\\text{TS\\_STD}(\\text{close}, 5))} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Idiosyncratic Liquidity Strain' factor identifies mean-reverting price anomalies by scaling short-term returns by the ratio of stock-specific volatility (relative to market volatility) to the structural volume baseline.\n                Concise Observation: Previous 'Liquidity Strain' factors (Hypothesis 6) improved raw returns but suffered from high drawdowns and lower IR, likely because they captured systematic volatility that doesn't necessarily mean-revert at the instrument level.\n                Concise Justification: By normalizing the 5-day price volatility against the cross-sectional average (market volatility), we isolate stock-specific 'panic' or 'hype'. Combining this with a stable 60-day median volume anchor ensures the signal identifies true liquidity vacuums unique to the asset, reducing exposure to market-wide risk and improving the Information Ratio.\n                Concise Knowledge: If an instrument's price volatility significantly exceeds the market's average volatility during a price move unsupported by structural liquidity, the move is likely idiosyncratic noise; when such specific strain occurs, the asset's return tends to revert more reliably than during systematic market-wide shocks.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day price volatility: TS_STD(close, 5). 3. Calculate 'Relative Volatility': 5-day volatility / CS_MEAN(5-day volatility). 4. Calculate 60-day median volume. 5. Factor = 5-day return * (Relative Volatility / 60-day median volume). 6. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:42:15.564665"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1341723877847651,
        "ICIR": 0.0340883390271897,
        "1day.excess_return_without_cost.std": 0.0052235669839423,
        "1day.excess_return_with_cost.annualized_return": 0.0100658110264001,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002404073415933,
        "1day.excess_return_without_cost.annualized_return": 0.0572169472992247,
        "1day.excess_return_with_cost.std": 0.0052258969828415,
        "Rank IC": 0.0188230758639125,
        "IC": 0.0050929626133617,
        "1day.excess_return_without_cost.max_drawdown": -0.1074538614820513,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.71001747280465,
        "1day.pa": 0.0,
        "l2.valid": 0.9960109409579476,
        "Rank ICIR": 0.1272690389547701,
        "l2.train": 0.9930849042205716,
        "1day.excess_return_with_cost.information_ratio": 0.1248531344821367,
        "1day.excess_return_with_cost.mean": 4.229332364033697e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Idiosyncratic Liquidity Strain' hypothesis. While the conceptual framework of scaling returns by a volatility-to-volume ratio remains promising, the current implementations (Idiosyncratic_Liquidity_Strain_Ratio, Dynamic_Idiosyncratic_Strain_Z, and Log_Liquidity_Vacuum_Index) failed to outperform the existing SOTA. The Information Ratio (0.7100 vs 0.7580) and IC (0.0051 vs 0.0054) show a slight deterioration. The use of cross-sectional normalization (MEAN/MEDIAN of TS_STD) and volume anchors (60-day median) provides a stable signal, but the interaction between the return sign and the liquidity vacuum index may be too linear or noisy in its current form.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by idiosyncratic liquidity strain identifies mean reversion is supported in principle, as the metrics remain positive and significant. However, the 'strain' component (volatility/volume) might be better captured by looking at the *change* in liquidity availability rather than the absolute level relative to a 60-day baseline. The current 60-day volume median might be too slow to react to sudden liquidity 'vacuums' that trigger mean-reverting spikes.",
        "decision": false,
        "reason": "The current factors used a static 60-day volume anchor. By replacing this with a dynamic volume ratio (short-term/medium-term), we can better identify 'exhaustion' points where high volatility occurs on declining relative volume. Furthermore, using a 3-day return window instead of 5-day may capture the mean-reversion signal more sharply before the market adjusts, reducing the lag observed in the current IR and IC metrics. This maintains a low complexity (SL < 100, ER < 4) while refining the 'Liquidity Strain' definition."
      }
    },
    "cddbf5c3a701a39a": {
      "factor_id": "cddbf5c3a701a39a",
      "factor_name": "Log_Liquidity_Vacuum_Index",
      "factor_expression": "RANK(SIGN(DELTA($close, 5)) * LOG(1 + (TS_STD($close, 5) / (MEDIAN(TS_STD($close, 5)) + 1e-8)) / (TS_MEDIAN($volume, 60) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(SIGN(DELTA($close, 5)) * LOG(1 + (TS_STD($close, 5) / (MEDIAN(TS_STD($close, 5)) + 1e-8)) / (TS_MEDIAN($volume, 60) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Log_Liquidity_Vacuum_Index\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures the intensity of price moves under liquidity stress by applying a logarithmic transformation to the ratio of idiosyncratic volatility to structural volume. The log transform dampens extreme outliers while the return sign provides directionality for mean reversion.",
      "factor_formulation": "Factor = \\text{RANK}\\left( \\text{SIGN}(\\text{DELTA}(\\text{close}, 5)) \\times \\text{LOG}\\left( 1 + \\frac{\\text{TS\\_STD}(\\text{close}, 5) / \\text{MEDIAN}(\\text{TS\\_STD}(\\text{close}, 5))}{\\text{TS\\_MEDIAN}(\\text{volume}, 60) + 1e-8} \\right) \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Idiosyncratic Liquidity Strain' factor identifies mean-reverting price anomalies by scaling short-term returns by the ratio of stock-specific volatility (relative to market volatility) to the structural volume baseline.\n                Concise Observation: Previous 'Liquidity Strain' factors (Hypothesis 6) improved raw returns but suffered from high drawdowns and lower IR, likely because they captured systematic volatility that doesn't necessarily mean-revert at the instrument level.\n                Concise Justification: By normalizing the 5-day price volatility against the cross-sectional average (market volatility), we isolate stock-specific 'panic' or 'hype'. Combining this with a stable 60-day median volume anchor ensures the signal identifies true liquidity vacuums unique to the asset, reducing exposure to market-wide risk and improving the Information Ratio.\n                Concise Knowledge: If an instrument's price volatility significantly exceeds the market's average volatility during a price move unsupported by structural liquidity, the move is likely idiosyncratic noise; when such specific strain occurs, the asset's return tends to revert more reliably than during systematic market-wide shocks.\n                concise Specification: 1. Calculate 5-day return: (close / delay(close, 5) - 1). 2. Calculate 5-day price volatility: TS_STD(close, 5). 3. Calculate 'Relative Volatility': 5-day volatility / CS_MEAN(5-day volatility). 4. Calculate 60-day median volume. 5. Factor = 5-day return * (Relative Volatility / 60-day median volume). 6. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:42:15.564665"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1341723877847651,
        "ICIR": 0.0340883390271897,
        "1day.excess_return_without_cost.std": 0.0052235669839423,
        "1day.excess_return_with_cost.annualized_return": 0.0100658110264001,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002404073415933,
        "1day.excess_return_without_cost.annualized_return": 0.0572169472992247,
        "1day.excess_return_with_cost.std": 0.0052258969828415,
        "Rank IC": 0.0188230758639125,
        "IC": 0.0050929626133617,
        "1day.excess_return_without_cost.max_drawdown": -0.1074538614820513,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.71001747280465,
        "1day.pa": 0.0,
        "l2.valid": 0.9960109409579476,
        "Rank ICIR": 0.1272690389547701,
        "l2.train": 0.9930849042205716,
        "1day.excess_return_with_cost.information_ratio": 0.1248531344821367,
        "1day.excess_return_with_cost.mean": 4.229332364033697e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Idiosyncratic Liquidity Strain' hypothesis. While the conceptual framework of scaling returns by a volatility-to-volume ratio remains promising, the current implementations (Idiosyncratic_Liquidity_Strain_Ratio, Dynamic_Idiosyncratic_Strain_Z, and Log_Liquidity_Vacuum_Index) failed to outperform the existing SOTA. The Information Ratio (0.7100 vs 0.7580) and IC (0.0051 vs 0.0054) show a slight deterioration. The use of cross-sectional normalization (MEAN/MEDIAN of TS_STD) and volume anchors (60-day median) provides a stable signal, but the interaction between the return sign and the liquidity vacuum index may be too linear or noisy in its current form.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by idiosyncratic liquidity strain identifies mean reversion is supported in principle, as the metrics remain positive and significant. However, the 'strain' component (volatility/volume) might be better captured by looking at the *change* in liquidity availability rather than the absolute level relative to a 60-day baseline. The current 60-day volume median might be too slow to react to sudden liquidity 'vacuums' that trigger mean-reverting spikes.",
        "decision": false,
        "reason": "The current factors used a static 60-day volume anchor. By replacing this with a dynamic volume ratio (short-term/medium-term), we can better identify 'exhaustion' points where high volatility occurs on declining relative volume. Furthermore, using a 3-day return window instead of 5-day may capture the mean-reversion signal more sharply before the market adjusts, reducing the lag observed in the current IR and IC metrics. This maintains a low complexity (SL < 100, ER < 4) while refining the 'Liquidity Strain' definition."
      }
    },
    "16162c8b08ee8173": {
      "factor_id": "16162c8b08ee8173",
      "factor_name": "Liquidity_Divergence_Momentum_3D",
      "factor_expression": "RANK(($close / DELAY($close, 3) - 1) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / ($close + 1e-8)) / (TS_SUM($close * $volume, 10) / (TS_SUM($volume, 10) + 1e-8) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(($close / DELAY($close, 3) - 1) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / ($close + 1e-8)) / (TS_SUM($close * $volume, 10) / (TS_SUM($volume, 10) + 1e-8) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Divergence_Momentum_3D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies potential price reversals by weighting the 3-day cumulative return by the ratio of the 5-day price range to the 10-day volume-weighted average price (VWAP) stability. It targets periods where price dispersion exceeds the support provided by liquidity, signaling exhaustion.",
      "factor_formulation": "RANK\\left( \\left(\\frac{close}{DELAY(close, 3)} - 1\\right) \\times \\frac{(TS\\_MAX(high, 5) - TS\\_MIN(low, 5)) / close}{TS\\_SUM(close \\times volume, 10) / TS\\_SUM(volume, 10)} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity Divergence Momentum' factor identifies price reversals by weighting the 3-day cumulative return by the ratio of the 5-day price range to the 10-day volume-weighted average price (VWAP) stability, isolating periods where price dispersion exceeds liquidity support.\n                Concise Observation: Previous attempts using static 60-day volume medians or 120-day anchors (Hypotheses 4, 6, 7) failed to capture the immediate 'liquidity wall' that triggers reversals, while the most successful iteration (Hypothesis 2) relied on simple 5-day volatility windows.\n                Concise Justification: Using the 5-day price range ($high - $low) instead of standard deviation captures intraday volatility more directly, and normalizing it by a 10-day volume-weighted baseline focuses on the 'cost' of liquidity. A 3-day return window captures the immediate momentum that is most likely to exhaust in a liquidity vacuum.\n                Concise Knowledge: If price dispersion (high-low range) increases while volume-weighted price stability decreases, the current price trend is likely unsustainable; when this divergence is extreme, the asset is prone to mean reversion as market participants refuse to provide liquidity at the new price levels.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 10-day volume-weighted average close: TS_SUM(close * volume, 10) / TS_SUM(volume, 10). 4. Factor = 3-day return * (5-day price range / 10-day VWAP). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:47:44.893245"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1609697814696018,
        "ICIR": 0.0543243445908062,
        "1day.excess_return_without_cost.std": 0.0047553890686995,
        "1day.excess_return_with_cost.annualized_return": 0.0332829354548222,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003402387800554,
        "1day.excess_return_without_cost.annualized_return": 0.0809768296531852,
        "1day.excess_return_with_cost.std": 0.0047579511343843,
        "Rank IC": 0.0238793189990093,
        "IC": 0.0078574441126428,
        "1day.excess_return_without_cost.max_drawdown": -0.1339202357057105,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.1037894427636796,
        "1day.pa": 0.0,
        "l2.valid": 0.9958767930750738,
        "Rank ICIR": 0.167819841140103,
        "l2.train": 0.9932597141433251,
        "1day.excess_return_with_cost.information_ratio": 0.4534330446702551,
        "1day.excess_return_with_cost.mean": 0.0001398442666169
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Divergence Momentum' hypothesis. The results show a significant improvement over the previous SOTA in terms of Information Ratio (1.10 vs 0.76), Annualized Return (8.1% vs 6.1%), and IC (0.0079 vs 0.0054). While the Max Drawdown increased slightly (-0.13 vs -0.10), the risk-adjusted returns (IR) suggest a much more robust signal. The 'Liquidity_Vacuum_Reversal_Index' and its counterparts successfully captured the intended phenomenon: price movements occurring in low-liquidity 'vacuums' are prone to mean reversion, and scaling the momentum by a volatility-to-VWAP ratio effectively filters for these exhaustion points.",
        "hypothesis_evaluation": "The hypothesis is strongly supported. The core logicthat price dispersion (range) relative to a liquidity baseline (VWAP) can weight returns to identify reversalsis valid. The current formulation uses 5 variables ($close, $high, $low, $volume, and derived returns), which is well within the complexity limit (ER < 6). The symbol lengths are also concise, suggesting that the predictive power comes from the structural logic rather than over-parameterization.",
        "decision": true,
        "reason": "Currently, the 10-day VWAP treats all volume in the window equally. However, liquidity can dry up or surge rapidly. Using a weighted sum or a shorter, more reactive liquidity baseline might better capture the 'vacuum' effect. Additionally, using (High-Low) alone doesn't account for overnight gaps; incorporating ATR or a normalized volatility measure will ensure the 'divergence' is relative to the stock's own recent volatility regime, reducing noise in high-beta names."
      }
    },
    "c69721d22bd321f4": {
      "factor_id": "c69721d22bd321f4",
      "factor_name": "VWAP_Stability_Range_Divergence",
      "factor_expression": "RANK(TS_SUM($return, 3) * ($high - $low) / (TS_SUM($close * $volume, 10) / (TS_SUM($volume, 10) + 1e-8) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK((TS_SUM($close / DELAY($close, 1) - 1, 3)) * (($high - $low) / (TS_SUM($close * $volume, 10) / (TS_SUM($volume, 10) + 1e-8) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"VWAP_Stability_Range_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A refined version of the liquidity divergence hypothesis that focuses on the ratio between the current price range and the 10-day VWAP. It captures the 'cost' of price movement relative to the liquidity baseline, where high values indicate price moves that are overextended relative to the volume-weighted price support.",
      "factor_formulation": "RANK(TS\\_SUM(return, 3) \\times \\frac{high - low}{TS\\_SUM(close \\times volume, 10) / TS\\_SUM(volume, 10)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity Divergence Momentum' factor identifies price reversals by weighting the 3-day cumulative return by the ratio of the 5-day price range to the 10-day volume-weighted average price (VWAP) stability, isolating periods where price dispersion exceeds liquidity support.\n                Concise Observation: Previous attempts using static 60-day volume medians or 120-day anchors (Hypotheses 4, 6, 7) failed to capture the immediate 'liquidity wall' that triggers reversals, while the most successful iteration (Hypothesis 2) relied on simple 5-day volatility windows.\n                Concise Justification: Using the 5-day price range ($high - $low) instead of standard deviation captures intraday volatility more directly, and normalizing it by a 10-day volume-weighted baseline focuses on the 'cost' of liquidity. A 3-day return window captures the immediate momentum that is most likely to exhaust in a liquidity vacuum.\n                Concise Knowledge: If price dispersion (high-low range) increases while volume-weighted price stability decreases, the current price trend is likely unsustainable; when this divergence is extreme, the asset is prone to mean reversion as market participants refuse to provide liquidity at the new price levels.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 10-day volume-weighted average close: TS_SUM(close * volume, 10) / TS_SUM(volume, 10). 4. Factor = 3-day return * (5-day price range / 10-day VWAP). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:47:44.893245"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1609697814696018,
        "ICIR": 0.0543243445908062,
        "1day.excess_return_without_cost.std": 0.0047553890686995,
        "1day.excess_return_with_cost.annualized_return": 0.0332829354548222,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003402387800554,
        "1day.excess_return_without_cost.annualized_return": 0.0809768296531852,
        "1day.excess_return_with_cost.std": 0.0047579511343843,
        "Rank IC": 0.0238793189990093,
        "IC": 0.0078574441126428,
        "1day.excess_return_without_cost.max_drawdown": -0.1339202357057105,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.1037894427636796,
        "1day.pa": 0.0,
        "l2.valid": 0.9958767930750738,
        "Rank ICIR": 0.167819841140103,
        "l2.train": 0.9932597141433251,
        "1day.excess_return_with_cost.information_ratio": 0.4534330446702551,
        "1day.excess_return_with_cost.mean": 0.0001398442666169
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Divergence Momentum' hypothesis. The results show a significant improvement over the previous SOTA in terms of Information Ratio (1.10 vs 0.76), Annualized Return (8.1% vs 6.1%), and IC (0.0079 vs 0.0054). While the Max Drawdown increased slightly (-0.13 vs -0.10), the risk-adjusted returns (IR) suggest a much more robust signal. The 'Liquidity_Vacuum_Reversal_Index' and its counterparts successfully captured the intended phenomenon: price movements occurring in low-liquidity 'vacuums' are prone to mean reversion, and scaling the momentum by a volatility-to-VWAP ratio effectively filters for these exhaustion points.",
        "hypothesis_evaluation": "The hypothesis is strongly supported. The core logicthat price dispersion (range) relative to a liquidity baseline (VWAP) can weight returns to identify reversalsis valid. The current formulation uses 5 variables ($close, $high, $low, $volume, and derived returns), which is well within the complexity limit (ER < 6). The symbol lengths are also concise, suggesting that the predictive power comes from the structural logic rather than over-parameterization.",
        "decision": true,
        "reason": "Currently, the 10-day VWAP treats all volume in the window equally. However, liquidity can dry up or surge rapidly. Using a weighted sum or a shorter, more reactive liquidity baseline might better capture the 'vacuum' effect. Additionally, using (High-Low) alone doesn't account for overnight gaps; incorporating ATR or a normalized volatility measure will ensure the 'divergence' is relative to the stock's own recent volatility regime, reducing noise in high-beta names."
      }
    },
    "1ab4f1d026129f85": {
      "factor_id": "1ab4f1d026129f85",
      "factor_name": "Liquidity_Vacuum_Reversal_Index",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * (TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 10) / (TS_SUM($volume, 10) + 1e-8) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * (TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 10) / (TS_SUM($volume, 10) + 1e-8) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Vacuum_Reversal_Index\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures the intensity of a price move (3-day return) scaled by the ratio of the 5-day high-low range to a 10-day volume-weighted baseline. It identifies 'thin' price moves that lack structural liquidity support, making them prone to mean reversion.",
      "factor_formulation": "RANK(TS\\_PCTCHANGE(close, 3) \\times \\frac{TS\\_MAX(high, 5) - TS\\_MIN(low, 5)}{TS\\_SUM(close \\times volume, 10) / TS\\_SUM(volume, 10)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity Divergence Momentum' factor identifies price reversals by weighting the 3-day cumulative return by the ratio of the 5-day price range to the 10-day volume-weighted average price (VWAP) stability, isolating periods where price dispersion exceeds liquidity support.\n                Concise Observation: Previous attempts using static 60-day volume medians or 120-day anchors (Hypotheses 4, 6, 7) failed to capture the immediate 'liquidity wall' that triggers reversals, while the most successful iteration (Hypothesis 2) relied on simple 5-day volatility windows.\n                Concise Justification: Using the 5-day price range ($high - $low) instead of standard deviation captures intraday volatility more directly, and normalizing it by a 10-day volume-weighted baseline focuses on the 'cost' of liquidity. A 3-day return window captures the immediate momentum that is most likely to exhaust in a liquidity vacuum.\n                Concise Knowledge: If price dispersion (high-low range) increases while volume-weighted price stability decreases, the current price trend is likely unsustainable; when this divergence is extreme, the asset is prone to mean reversion as market participants refuse to provide liquidity at the new price levels.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 10-day volume-weighted average close: TS_SUM(close * volume, 10) / TS_SUM(volume, 10). 4. Factor = 3-day return * (5-day price range / 10-day VWAP). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:47:44.893245"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1609697814696018,
        "ICIR": 0.0543243445908062,
        "1day.excess_return_without_cost.std": 0.0047553890686995,
        "1day.excess_return_with_cost.annualized_return": 0.0332829354548222,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003402387800554,
        "1day.excess_return_without_cost.annualized_return": 0.0809768296531852,
        "1day.excess_return_with_cost.std": 0.0047579511343843,
        "Rank IC": 0.0238793189990093,
        "IC": 0.0078574441126428,
        "1day.excess_return_without_cost.max_drawdown": -0.1339202357057105,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.1037894427636796,
        "1day.pa": 0.0,
        "l2.valid": 0.9958767930750738,
        "Rank ICIR": 0.167819841140103,
        "l2.train": 0.9932597141433251,
        "1day.excess_return_with_cost.information_ratio": 0.4534330446702551,
        "1day.excess_return_with_cost.mean": 0.0001398442666169
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity Divergence Momentum' hypothesis. The results show a significant improvement over the previous SOTA in terms of Information Ratio (1.10 vs 0.76), Annualized Return (8.1% vs 6.1%), and IC (0.0079 vs 0.0054). While the Max Drawdown increased slightly (-0.13 vs -0.10), the risk-adjusted returns (IR) suggest a much more robust signal. The 'Liquidity_Vacuum_Reversal_Index' and its counterparts successfully captured the intended phenomenon: price movements occurring in low-liquidity 'vacuums' are prone to mean reversion, and scaling the momentum by a volatility-to-VWAP ratio effectively filters for these exhaustion points.",
        "hypothesis_evaluation": "The hypothesis is strongly supported. The core logicthat price dispersion (range) relative to a liquidity baseline (VWAP) can weight returns to identify reversalsis valid. The current formulation uses 5 variables ($close, $high, $low, $volume, and derived returns), which is well within the complexity limit (ER < 6). The symbol lengths are also concise, suggesting that the predictive power comes from the structural logic rather than over-parameterization.",
        "decision": true,
        "reason": "Currently, the 10-day VWAP treats all volume in the window equally. However, liquidity can dry up or surge rapidly. Using a weighted sum or a shorter, more reactive liquidity baseline might better capture the 'vacuum' effect. Additionally, using (High-Low) alone doesn't account for overnight gaps; incorporating ATR or a normalized volatility measure will ensure the 'divergence' is relative to the stock's own recent volatility regime, reducing noise in high-beta names."
      }
    },
    "2fe2e3ef7d2f5588": {
      "factor_id": "2fe2e3ef7d2f5588",
      "factor_name": "Adaptive_Liquidity_Gap_Factor",
      "factor_expression": "RANK((($close / DELAY($close, 3)) - 1) * (MAX($high, DELAY($close, 1)) - MIN($low, DELAY($close, 1))) / ((TS_SUM($close * $volume, 5) / (TS_SUM($volume, 5) + 1e-8)) * (TS_STD($volume, 20) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * (MAX($high, DELAY($close, 1)) - MIN($low, DELAY($close, 1))) / ((TS_SUM($close * $volume, 5) / (TS_SUM($volume, 5) + 1e-8)) * (TS_STD($volume, 20) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Adaptive_Liquidity_Gap_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies mean-reverting price overextensions by weighting the 3-day return by the ratio of the 5-day True Range to a 5-day volume-weighted average price, normalized by the 20-day volatility of volume. It uses a True Range calculation to capture overnight gaps and a shorter VWAP window for responsiveness.",
      "factor_formulation": "RANK\\left( \\frac{(close / DELAY(close, 3) - 1) \\times (\\max(high, DELAY(close, 1)) - \\min(low, DELAY(close, 1)))}{ (\\sum_{i=1}^5 close_i \\times volume_i / \\sum_{i=1}^5 volume_i) \\times TS\\_STD(volume, 20)} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Adaptive Liquidity Gap' factor identifies mean-reverting price overextensions by weighting the 3-day return by the ratio of the 5-day True Range to a 5-day volume-weighted average price, further normalized by the 20-day volatility of volume to isolate structural liquidity shocks.\n                Concise Observation: Hypothesis 8 succeeded by using the price range relative to VWAP, but the 10-day VWAP and simple range may still lag during rapid liquidity shifts or ignore overnight price gaps which are critical in mean-reversion scenarios.\n                Concise Justification: Replacing the simple high-low range with the True Range (incorporating the previous close) captures overnight risk, while shortening the VWAP window to 5 days and scaling by the volatility of volume ensures the factor reacts only to 'abnormal' liquidity conditions rather than systematic volume trends.\n                Concise Knowledge: If a short-term price trend is driven by high intraday dispersion (True Range) relative to recent volume-weighted price levels, it indicates a liquidity vacuum; when this gap occurs alongside low volume stability, the price move is likely a noise-driven overextension that will mean-revert.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day True Range: TS_MAX(high, 5) - TS_MIN(low, 5) (or more precisely, max(high-low, abs(high-delay(close,1)), abs(low-delay(close,1))) over 5 days). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Factor = 3-day return * (5-day True Range / 5-day VWAP) / TS_STD(volume, 20). 5. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:56:11.776588"
      },
      "backtest_results": {},
      "feedback": {
        "observations": "The current experiment attempted to validate the 'Adaptive Liquidity Gap' hypothesis through three variations: the base factor, a dynamic divergence model, and a capitulation index. However, the provided results show 'NaN' for all performance metrics of the current implementations, while the SOTA result remains at an IC of 0.0078 and an IR of 1.10. This indicates that the current implementations either failed to generate valid signals across the required timeframe or the logic utilized (specifically the interaction between price range and volume volatility) did not yield predictive power in this specific configuration.",
        "hypothesis_evaluation": "The hypothesis that weighting returns by the ratio of True Range to VWAP (normalized by volume volatility) identifies mean-reversion is currently unsupported by the data. The 'NaN' results suggest that the factor values might be suffering from scale issues or lack of coverage. Specifically, the interaction of $TS_STD(volume, 20)$ in the denominator might be creating extreme outliers or near-zero values that destabilize the RANK function or the subsequent model training.",
        "decision": false,
        "reason": "The previous formulations were potentially too complex (high ER and multiple rolling windows). By shifting to a Z-score for volume normalization and using a more stable 10-day range (ATR) instead of a 5-day VWAP ratio, we reduce the sensitivity to daily volume fluctuations while maintaining the core concept of identifying price moves that are 'exhausted' relative to structural liquidity. This simplifies the denominator and focuses on volume 'shocks' rather than raw volume volatility."
      }
    },
    "d5d34e7197a4edd3": {
      "factor_id": "d5d34e7197a4edd3",
      "factor_name": "Dynamic_True_Range_VWAP_Divergence",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * TS_MAX($high - $low, 5) / ((TS_SUM($close * $volume, 5) / (TS_SUM($volume, 5) + 1e-8)) * (TS_STD($volume, 20) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * TS_MAX($high - $low, 5) / ((TS_SUM($close * $volume, 5) / (TS_SUM($volume, 5) + 1e-8)) * (TS_STD($volume, 20) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Dynamic_True_Range_VWAP_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "A variation of the liquidity gap hypothesis that uses the 5-day maximum True Range relative to the 5-day VWAP, further scaled by the inverse of volume stability (standard deviation) to highlight structural liquidity shocks during price moves.",
      "factor_formulation": "RANK\\left( TS\\_PCTCHANGE(close, 3) \\times \\frac{TS\\_MAX(high - low, 5)}{TS\\_SUM(close \\times volume, 5) / TS\\_SUM(volume, 5)} / TS\\_STD(volume, 20) \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Adaptive Liquidity Gap' factor identifies mean-reverting price overextensions by weighting the 3-day return by the ratio of the 5-day True Range to a 5-day volume-weighted average price, further normalized by the 20-day volatility of volume to isolate structural liquidity shocks.\n                Concise Observation: Hypothesis 8 succeeded by using the price range relative to VWAP, but the 10-day VWAP and simple range may still lag during rapid liquidity shifts or ignore overnight price gaps which are critical in mean-reversion scenarios.\n                Concise Justification: Replacing the simple high-low range with the True Range (incorporating the previous close) captures overnight risk, while shortening the VWAP window to 5 days and scaling by the volatility of volume ensures the factor reacts only to 'abnormal' liquidity conditions rather than systematic volume trends.\n                Concise Knowledge: If a short-term price trend is driven by high intraday dispersion (True Range) relative to recent volume-weighted price levels, it indicates a liquidity vacuum; when this gap occurs alongside low volume stability, the price move is likely a noise-driven overextension that will mean-revert.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day True Range: TS_MAX(high, 5) - TS_MIN(low, 5) (or more precisely, max(high-low, abs(high-delay(close,1)), abs(low-delay(close,1))) over 5 days). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Factor = 3-day return * (5-day True Range / 5-day VWAP) / TS_STD(volume, 20). 5. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:56:11.776588"
      },
      "backtest_results": {},
      "feedback": {
        "observations": "The current experiment attempted to validate the 'Adaptive Liquidity Gap' hypothesis through three variations: the base factor, a dynamic divergence model, and a capitulation index. However, the provided results show 'NaN' for all performance metrics of the current implementations, while the SOTA result remains at an IC of 0.0078 and an IR of 1.10. This indicates that the current implementations either failed to generate valid signals across the required timeframe or the logic utilized (specifically the interaction between price range and volume volatility) did not yield predictive power in this specific configuration.",
        "hypothesis_evaluation": "The hypothesis that weighting returns by the ratio of True Range to VWAP (normalized by volume volatility) identifies mean-reversion is currently unsupported by the data. The 'NaN' results suggest that the factor values might be suffering from scale issues or lack of coverage. Specifically, the interaction of $TS_STD(volume, 20)$ in the denominator might be creating extreme outliers or near-zero values that destabilize the RANK function or the subsequent model training.",
        "decision": false,
        "reason": "The previous formulations were potentially too complex (high ER and multiple rolling windows). By shifting to a Z-score for volume normalization and using a more stable 10-day range (ATR) instead of a 5-day VWAP ratio, we reduce the sensitivity to daily volume fluctuations while maintaining the core concept of identifying price moves that are 'exhausted' relative to structural liquidity. This simplifies the denominator and focuses on volume 'shocks' rather than raw volume volatility."
      }
    },
    "53d252d1929f9fe9": {
      "factor_id": "53d252d1929f9fe9",
      "factor_name": "Liquidity_Vacuum_Capitulation_Index",
      "factor_expression": "RANK(SIGN(DELAY($close, 3) - $close) * (TS_MAX($high, 5) - TS_MIN($low, 5)) / ((TS_SUM($close * $volume, 5) / (TS_SUM($volume, 5) + 1e-8)) * (TS_STD($volume, 20) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(SIGN(DELAY($close, 3) - $close) * (TS_MAX($high, 5) - TS_MIN($low, 5)) / ((TS_SUM($close * $volume, 5) / (TS_SUM($volume, 5) + 1e-8)) * (TS_STD($volume, 20) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Vacuum_Capitulation_Index\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures price exhaustion by measuring the 3-day return magnitude relative to the 5-day True Range, normalized by the interaction of VWAP and volume volatility. It focuses on identifying where price dispersion is extreme relative to the capital committed (VWAP).",
      "factor_formulation": "RANK\\left( \\frac{SIGN(DELAY(close, 3) - close) \\times (TS\\_MAX(high, 5) - TS\\_MIN(low, 5))}{ (TS\\_SUM(close \\times volume, 5) / TS\\_SUM(volume, 5)) \\times TS\\_STD(volume, 20)} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Adaptive Liquidity Gap' factor identifies mean-reverting price overextensions by weighting the 3-day return by the ratio of the 5-day True Range to a 5-day volume-weighted average price, further normalized by the 20-day volatility of volume to isolate structural liquidity shocks.\n                Concise Observation: Hypothesis 8 succeeded by using the price range relative to VWAP, but the 10-day VWAP and simple range may still lag during rapid liquidity shifts or ignore overnight price gaps which are critical in mean-reversion scenarios.\n                Concise Justification: Replacing the simple high-low range with the True Range (incorporating the previous close) captures overnight risk, while shortening the VWAP window to 5 days and scaling by the volatility of volume ensures the factor reacts only to 'abnormal' liquidity conditions rather than systematic volume trends.\n                Concise Knowledge: If a short-term price trend is driven by high intraday dispersion (True Range) relative to recent volume-weighted price levels, it indicates a liquidity vacuum; when this gap occurs alongside low volume stability, the price move is likely a noise-driven overextension that will mean-revert.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day True Range: TS_MAX(high, 5) - TS_MIN(low, 5) (or more precisely, max(high-low, abs(high-delay(close,1)), abs(low-delay(close,1))) over 5 days). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Factor = 3-day return * (5-day True Range / 5-day VWAP) / TS_STD(volume, 20). 5. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T21:56:11.776588"
      },
      "backtest_results": {},
      "feedback": {
        "observations": "The current experiment attempted to validate the 'Adaptive Liquidity Gap' hypothesis through three variations: the base factor, a dynamic divergence model, and a capitulation index. However, the provided results show 'NaN' for all performance metrics of the current implementations, while the SOTA result remains at an IC of 0.0078 and an IR of 1.10. This indicates that the current implementations either failed to generate valid signals across the required timeframe or the logic utilized (specifically the interaction between price range and volume volatility) did not yield predictive power in this specific configuration.",
        "hypothesis_evaluation": "The hypothesis that weighting returns by the ratio of True Range to VWAP (normalized by volume volatility) identifies mean-reversion is currently unsupported by the data. The 'NaN' results suggest that the factor values might be suffering from scale issues or lack of coverage. Specifically, the interaction of $TS_STD(volume, 20)$ in the denominator might be creating extreme outliers or near-zero values that destabilize the RANK function or the subsequent model training.",
        "decision": false,
        "reason": "The previous formulations were potentially too complex (high ER and multiple rolling windows). By shifting to a Z-score for volume normalization and using a more stable 10-day range (ATR) instead of a 5-day VWAP ratio, we reduce the sensitivity to daily volume fluctuations while maintaining the core concept of identifying price moves that are 'exhausted' relative to structural liquidity. This simplifies the denominator and focuses on volume 'shocks' rather than raw volume volatility."
      }
    },
    "42e607d922876609": {
      "factor_id": "42e607d922876609",
      "factor_name": "Volume_Exhaustion_Momentum_Reversal",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN($close, 5) + 1e-8)) * (TS_MEAN($volume, 20) / (TS_MEAN($volume, 5) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN($close, 5) + 1e-8)) * (TS_MEAN($volume, 20) / (TS_MEAN($volume, 5) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Volume_Exhaustion_Momentum_Reversal\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies mean-reversion opportunities by measuring 3-day momentum scaled by the ratio of 5-day price range to relative volume. It specifically targets 'liquidity vacuums' where price moves are large but volume is low relative to its 20-day trend, suggesting exhaustion. It uses TS_PCTCHANGE for momentum and a volume ratio to avoid the duplicated sub-expression.",
      "factor_formulation": "VEMR = \\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\frac{\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5)}{\\text{TS_MEAN}(\\text{close}, 5)} \\times \\frac{\\text{TS_MEAN}(\\text{volume}, 20)}{\\text{TS_MEAN}(\\text{volume}, 5) + 1e-8})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Volume-Confirmed Range Exhaustion' factor identifies mean-reverting price moves by scaling the 3-day return by the 5-day price range, further weighted by the 5-day volume relative to its 20-day average, to distinguish between high-conviction trends and low-liquidity noise.\n                Concise Observation: Previous attempts failed when using volume volatility or long-term medians as denominators (Hypothesis 9), leading to signal instability; however, the most successful model (Hypothesis 8) utilized a simple range-to-liquidity ratio, suggesting that volume should act as a 'confirmation' multiplier rather than a volatile divisor.\n                Concise Justification: By using volume as a weight (Relative Volume) rather than a denominator, we avoid the 'division by zero' or extreme outlier issues that caused previous failures. This allows the factor to amplify price moves that occur on 'thin' volume (liquidity exhaustion) while dampening those supported by 'thick' volume (trend confirmation).\n                Concise Knowledge: If a short-term price move (3-day) is accompanied by a large price range but low relative volume (5-day volume / 20-day mean), it indicates a liquidity vacuum prone to reversal; when volume is high relative to its recent trend, the move is more likely a sustainable trend.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate Relative Volume: TS_MEAN(volume, 5) / TS_MEAN(volume, 20). 4. Factor = 3-day return * 5-day price range * (1 / Relative Volume). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:02:22.637430"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1645919002901129,
        "ICIR": 0.0349238649785145,
        "1day.excess_return_without_cost.std": 0.0045248988257663,
        "1day.excess_return_with_cost.annualized_return": 0.0136607322400217,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002568465746866,
        "1day.excess_return_without_cost.annualized_return": 0.0611294847754233,
        "1day.excess_return_with_cost.std": 0.0045276036400289,
        "Rank IC": 0.0200181078501437,
        "IC": 0.0049513233747981,
        "1day.excess_return_without_cost.max_drawdown": -0.1465385234690558,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.8756960360001922,
        "1day.pa": 0.0,
        "l2.valid": 0.9963421796135936,
        "Rank ICIR": 0.1423443063990287,
        "l2.train": 0.993226688977094,
        "1day.excess_return_with_cost.information_ratio": 0.1955766937314032,
        "1day.excess_return_with_cost.mean": 5.739803462194024e-05
      },
      "feedback": {
        "observations": "The current experiment tested three variations of the 'Volume-Confirmed Range Exhaustion' hypothesis: VEMR, LLVP, and RRVD. While the core concept of identifying 'liquidity vacuums' (large price moves on low relative volume) is theoretically sound, the current implementations failed to surpass the existing SOTA result. The IC dropped from 0.0078 to 0.0049, and the Information Ratio saw a significant decline from 1.10 to 0.87. The RRVD factor, which attempted to normalize the price range by its 20-day average, likely introduced too much noise or lagged information, while the VEMR's linear scaling might be too sensitive to outliers in the volume ratio.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by range-to-volume ratios identifies mean-reversion is partially supported by the positive IC and returns, but the specific formulations are currently suboptimal. The 'exhaustion' signal is being diluted. The use of SIGN() in LLVP might be losing too much information, and the raw multiplication of momentum with the range-volume ratio in VEMR/RRVD may be creating extreme values that degrade the Information Ratio.",
        "decision": false,
        "reason": "The current factors use a simple ratio of (Range / Volume). A more robust approach would be to isolate the 'Exhaustion' component more cleanly. By using the 3-day momentum divided by the 5-day range (a measure of price efficiency), and then weighting it by an exponential decay of the relative volume (e.g., EXP(-Relative_Volume)), we can more effectively target low-volume 'thin' moves. This reduces the impact of extreme volume spikes that currently distort the linear ratios in VEMR and RRVD. Additionally, keeping the symbol length low and the base features under 5 will ensure better generalization than the current multi-layered normalization in RRVD."
      }
    },
    "d4f335a584134afb": {
      "factor_id": "d4f335a584134afb",
      "factor_name": "Log_Liquidity_Vacuum_Pressure",
      "factor_expression": "RANK(SIGN(TS_PCTCHANGE($close, 3)) * LOG(1 + (TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(SIGN(TS_PCTCHANGE($close, 3)) * LOG(1 + (TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Log_Liquidity_Vacuum_Pressure\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures price overextensions by multiplying the 3-day return sign with the log-transformed ratio of the 5-day range to relative volume. The log transformation dampens extreme volume spikes, while using the sign of the return isolates the direction of the exhaustion for mean-reversion.",
      "factor_formulation": "LLVP = \\text{RANK}(\\text{SIGN}(\\text{TS_PCTCHANGE}(\\text{close}, 3)) \\times \\text{LOG}(1 + \\frac{\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5)}{\\text{TS_MEAN}(\\text{volume}, 5) / \\text{TS_MEAN}(\\text{volume}, 20) + 1e-8}))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Volume-Confirmed Range Exhaustion' factor identifies mean-reverting price moves by scaling the 3-day return by the 5-day price range, further weighted by the 5-day volume relative to its 20-day average, to distinguish between high-conviction trends and low-liquidity noise.\n                Concise Observation: Previous attempts failed when using volume volatility or long-term medians as denominators (Hypothesis 9), leading to signal instability; however, the most successful model (Hypothesis 8) utilized a simple range-to-liquidity ratio, suggesting that volume should act as a 'confirmation' multiplier rather than a volatile divisor.\n                Concise Justification: By using volume as a weight (Relative Volume) rather than a denominator, we avoid the 'division by zero' or extreme outlier issues that caused previous failures. This allows the factor to amplify price moves that occur on 'thin' volume (liquidity exhaustion) while dampening those supported by 'thick' volume (trend confirmation).\n                Concise Knowledge: If a short-term price move (3-day) is accompanied by a large price range but low relative volume (5-day volume / 20-day mean), it indicates a liquidity vacuum prone to reversal; when volume is high relative to its recent trend, the move is more likely a sustainable trend.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate Relative Volume: TS_MEAN(volume, 5) / TS_MEAN(volume, 20). 4. Factor = 3-day return * 5-day price range * (1 / Relative Volume). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:02:22.637430"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1645919002901129,
        "ICIR": 0.0349238649785145,
        "1day.excess_return_without_cost.std": 0.0045248988257663,
        "1day.excess_return_with_cost.annualized_return": 0.0136607322400217,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002568465746866,
        "1day.excess_return_without_cost.annualized_return": 0.0611294847754233,
        "1day.excess_return_with_cost.std": 0.0045276036400289,
        "Rank IC": 0.0200181078501437,
        "IC": 0.0049513233747981,
        "1day.excess_return_without_cost.max_drawdown": -0.1465385234690558,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.8756960360001922,
        "1day.pa": 0.0,
        "l2.valid": 0.9963421796135936,
        "Rank ICIR": 0.1423443063990287,
        "l2.train": 0.993226688977094,
        "1day.excess_return_with_cost.information_ratio": 0.1955766937314032,
        "1day.excess_return_with_cost.mean": 5.739803462194024e-05
      },
      "feedback": {
        "observations": "The current experiment tested three variations of the 'Volume-Confirmed Range Exhaustion' hypothesis: VEMR, LLVP, and RRVD. While the core concept of identifying 'liquidity vacuums' (large price moves on low relative volume) is theoretically sound, the current implementations failed to surpass the existing SOTA result. The IC dropped from 0.0078 to 0.0049, and the Information Ratio saw a significant decline from 1.10 to 0.87. The RRVD factor, which attempted to normalize the price range by its 20-day average, likely introduced too much noise or lagged information, while the VEMR's linear scaling might be too sensitive to outliers in the volume ratio.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by range-to-volume ratios identifies mean-reversion is partially supported by the positive IC and returns, but the specific formulations are currently suboptimal. The 'exhaustion' signal is being diluted. The use of SIGN() in LLVP might be losing too much information, and the raw multiplication of momentum with the range-volume ratio in VEMR/RRVD may be creating extreme values that degrade the Information Ratio.",
        "decision": false,
        "reason": "The current factors use a simple ratio of (Range / Volume). A more robust approach would be to isolate the 'Exhaustion' component more cleanly. By using the 3-day momentum divided by the 5-day range (a measure of price efficiency), and then weighting it by an exponential decay of the relative volume (e.g., EXP(-Relative_Volume)), we can more effectively target low-volume 'thin' moves. This reduces the impact of extreme volume spikes that currently distort the linear ratios in VEMR and RRVD. Additionally, keeping the symbol length low and the base features under 5 will ensure better generalization than the current multi-layered normalization in RRVD."
      }
    },
    "399d48eb5e5e6f54": {
      "factor_id": "399d48eb5e5e6f54",
      "factor_name": "Relative_Range_Volume_Divergence",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * (((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN($high - $low, 20) + 1e-8)) / (TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * (((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN($high - $low, 20) + 1e-8)) / (TS_MEAN($volume, 5) / (TS_MEAN($volume, 20) + 1e-8) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Relative_Range_Volume_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies potential reversals by comparing the 5-day price range (normalized by its 20-day average) to the 5-day volume (normalized by its 20-day average). A high ratio suggests a 'thin' price move that lacks liquidity support, weighted by the 3-day price direction.",
      "factor_formulation": "RRVD = \\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\frac{(\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5)) / (TS_MEAN(\\text{high}-\\text{low}, 20) + 1e-8)}{\\text{TS_MEAN}(\\text{volume}, 5) / (TS_MEAN(\\text{volume}, 20) + 1e-8)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Volume-Confirmed Range Exhaustion' factor identifies mean-reverting price moves by scaling the 3-day return by the 5-day price range, further weighted by the 5-day volume relative to its 20-day average, to distinguish between high-conviction trends and low-liquidity noise.\n                Concise Observation: Previous attempts failed when using volume volatility or long-term medians as denominators (Hypothesis 9), leading to signal instability; however, the most successful model (Hypothesis 8) utilized a simple range-to-liquidity ratio, suggesting that volume should act as a 'confirmation' multiplier rather than a volatile divisor.\n                Concise Justification: By using volume as a weight (Relative Volume) rather than a denominator, we avoid the 'division by zero' or extreme outlier issues that caused previous failures. This allows the factor to amplify price moves that occur on 'thin' volume (liquidity exhaustion) while dampening those supported by 'thick' volume (trend confirmation).\n                Concise Knowledge: If a short-term price move (3-day) is accompanied by a large price range but low relative volume (5-day volume / 20-day mean), it indicates a liquidity vacuum prone to reversal; when volume is high relative to its recent trend, the move is more likely a sustainable trend.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate Relative Volume: TS_MEAN(volume, 5) / TS_MEAN(volume, 20). 4. Factor = 3-day return * 5-day price range * (1 / Relative Volume). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:02:22.637430"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1645919002901129,
        "ICIR": 0.0349238649785145,
        "1day.excess_return_without_cost.std": 0.0045248988257663,
        "1day.excess_return_with_cost.annualized_return": 0.0136607322400217,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002568465746866,
        "1day.excess_return_without_cost.annualized_return": 0.0611294847754233,
        "1day.excess_return_with_cost.std": 0.0045276036400289,
        "Rank IC": 0.0200181078501437,
        "IC": 0.0049513233747981,
        "1day.excess_return_without_cost.max_drawdown": -0.1465385234690558,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.8756960360001922,
        "1day.pa": 0.0,
        "l2.valid": 0.9963421796135936,
        "Rank ICIR": 0.1423443063990287,
        "l2.train": 0.993226688977094,
        "1day.excess_return_with_cost.information_ratio": 0.1955766937314032,
        "1day.excess_return_with_cost.mean": 5.739803462194024e-05
      },
      "feedback": {
        "observations": "The current experiment tested three variations of the 'Volume-Confirmed Range Exhaustion' hypothesis: VEMR, LLVP, and RRVD. While the core concept of identifying 'liquidity vacuums' (large price moves on low relative volume) is theoretically sound, the current implementations failed to surpass the existing SOTA result. The IC dropped from 0.0078 to 0.0049, and the Information Ratio saw a significant decline from 1.10 to 0.87. The RRVD factor, which attempted to normalize the price range by its 20-day average, likely introduced too much noise or lagged information, while the VEMR's linear scaling might be too sensitive to outliers in the volume ratio.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by range-to-volume ratios identifies mean-reversion is partially supported by the positive IC and returns, but the specific formulations are currently suboptimal. The 'exhaustion' signal is being diluted. The use of SIGN() in LLVP might be losing too much information, and the raw multiplication of momentum with the range-volume ratio in VEMR/RRVD may be creating extreme values that degrade the Information Ratio.",
        "decision": false,
        "reason": "The current factors use a simple ratio of (Range / Volume). A more robust approach would be to isolate the 'Exhaustion' component more cleanly. By using the 3-day momentum divided by the 5-day range (a measure of price efficiency), and then weighting it by an exponential decay of the relative volume (e.g., EXP(-Relative_Volume)), we can more effectively target low-volume 'thin' moves. This reduces the impact of extreme volume spikes that currently distort the linear ratios in VEMR and RRVD. Additionally, keeping the symbol length low and the base features under 5 will ensure better generalization than the current multi-layered normalization in RRVD."
      }
    },
    "3617661c0f0c2a1b": {
      "factor_id": "3617661c0f0c2a1b",
      "factor_name": "Intraday_Intensity_Vacuum_SQRT_Volume",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * (($high - $low) / ($close + 1e-8)) / (SQRT(TS_MEAN($volume, 20)) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * (($high - $low) / ($close + 1e-8)) / (SQRT(TS_MEAN($volume, 20)) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Intraday_Intensity_Vacuum_SQRT_Volume\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies mean-reversion opportunities by weighting the 3-day return by the ratio of the 5-day intraday range to the square root of the 20-day average volume. The square root transformation of volume acts as a stabilizer for the liquidity denominator, identifying price moves that lack structural support (liquidity vacuums) while avoiding the instability of raw volume ratios.",
      "factor_formulation": "Factor = \\text{RANK}\\left( \\text{TS\\_PCTCHANGE}(\\text{close}, 3) \\times \\frac{(\\text{high} - \\text{low}) / \\text{close}}{\\text{SQRT}(\\text{TS\\_MEAN}(\\text{volume}, 20)) + 1e-8} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Intraday-Intensity Liquidity Vacuum' factor identifies mean-reversion by weighting 3-day returns by the ratio of the 5-day Intraday Intensity (High-Low relative to Close) to the 20-day moving average of volume, using a square-root transformation on volume to stabilize the liquidity denominator.\n                Concise Observation: Previous attempts (Hypothesis 9 & 10) failed because raw volume ratios or volume-volatility denominators created unstable signals (NaNs or low IR), while the successful Hypothesis 8 used a simple range-to-VWAP ratio, suggesting that price dispersion relative to a smoothed liquidity anchor is the most robust signal path.\n                Concise Justification: The square-root of volume (a proxy for the 'market impact' function in market microstructure) provides a more theoretically sound and statistically stable denominator for normalizing price range than raw volume or volume volatility. This prevents the factor from being dominated by extreme low-volume stocks while still penalizing moves that lack 'thick' liquidity support.\n                Concise Knowledge: If a short-term price trend is driven by high intraday dispersion but lacks proportional volume support, it represents a liquidity vacuum; when volume is stabilized via a square-root transform, the resulting ratio effectively identifies price exhaustion without the extreme outlier sensitivity of raw volume ratios.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day Price Range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 20-day Volume Anchor: TS_MEAN(volume, 20). 4. Factor = 3-day return * (5-day Price Range / SQRT(20-day Volume Anchor)). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:08:47.152928"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1276810117799274,
        "ICIR": 0.0455604890831012,
        "1day.excess_return_without_cost.std": 0.0043615777236196,
        "1day.excess_return_with_cost.annualized_return": 0.0169437351640125,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002687302813798,
        "1day.excess_return_without_cost.annualized_return": 0.0639578069684093,
        "1day.excess_return_with_cost.std": 0.0043638335373548,
        "Rank IC": 0.021540764365754,
        "IC": 0.0066506740769,
        "1day.excess_return_without_cost.max_drawdown": -0.1025663819222673,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9505204596640257,
        "1day.pa": 0.0,
        "l2.valid": 0.9962694321047266,
        "Rank ICIR": 0.1510847211215967,
        "l2.train": 0.9941366490485416,
        "1day.excess_return_with_cost.information_ratio": 0.2516821993822449,
        "1day.excess_return_with_cost.mean": 7.11921645546745e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Intraday-Intensity Liquidity Vacuum' hypothesis, focusing on the interaction between short-term price momentum and liquidity-adjusted volatility. The current results show a significant improvement in risk management, with the Max Drawdown reducing from -0.1339 to -0.1025. However, the predictive power (IC) and risk-adjusted returns (Information Ratio) have slightly declined compared to the SOTA result. The 'Intraday_Intensity_Vacuum_SQRT_Volume' factor successfully utilized the square-root volume transformation to stabilize the liquidity signal, but the overall return profile suggests that while the 'vacuum' identification helps in tail-risk reduction, it may be diluting the primary alpha signal compared to the previous SOTA.",
        "hypothesis_evaluation": "The hypothesis that weighting returns by a liquidity-adjusted range identifies mean-reversion is partially supported, specifically in its ability to reduce drawdown. The use of SQRT(Volume) as a denominator effectively prevents extreme outliers from dominating the factor. However, the current implementation of the 'range' (High-Low) might be too noisy. The 'Liquidity_Vacuum_Stabilized_Range' variation, which used a 5-day mean of the range, suggests that smoothing the volatility component is beneficial, but the drop in IC indicates that the timing of the 'vacuum' might be lagging.",
        "decision": false,
        "reason": "Current results show that while the square-root volume helps, the 'High-Low' range is a crude proxy for price intensity. Using the standard deviation of returns (Volatility) provides a more robust measure of price dispersion. Furthermore, instead of a static 20-day mean of volume, using the ratio of current volume to a smoothed average (V/EMA(V)) will more sharply identify 'gaps' where price moves on declining relative volume, which is the core of the 'vacuum' theory. This should improve the IC by better timing the exhaustion points."
      }
    },
    "08eaeea31f52bc87": {
      "factor_id": "08eaeea31f52bc87",
      "factor_name": "Liquidity_Vacuum_Stabilized_Range",
      "factor_expression": "RANK((DELTA($close, 3) / (DELAY($close, 3) + 1e-8)) * (TS_MEAN($high - $low, 5) / ($open + 1e-8)) / (SQRT(TS_MEAN($volume, 20)) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK((DELTA($close, 3) / (DELAY($close, 3) + 1e-8)) * (TS_MEAN($high - $low, 5) / ($open + 1e-8)) / (SQRT(TS_MEAN($volume, 20)) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Vacuum_Stabilized_Range\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor measures price exhaustion by scaling the 3-day return with the ratio of the 5-day average true range (approximated by high-low relative to open) to the square root of the 20-day average volume. By using the open price as a denominator for the range and square-root volume as a liquidity anchor, it isolates idiosyncratic price spikes that occur in thin market conditions.",
      "factor_formulation": "Factor = \\text{RANK}\\left( \\frac{\\text{DELTA}(\\text{close}, 3)}{\\text{DELAY}(\\text{close}, 3)} \\times \\frac{\\text{TS\\_MEAN}(\\text{high} - \\text{low}, 5) / \\text{open}}{\\text{SQRT}(\\text{TS\\_MEAN}(\\text{volume}, 20)) + 1e-8} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Intraday-Intensity Liquidity Vacuum' factor identifies mean-reversion by weighting 3-day returns by the ratio of the 5-day Intraday Intensity (High-Low relative to Close) to the 20-day moving average of volume, using a square-root transformation on volume to stabilize the liquidity denominator.\n                Concise Observation: Previous attempts (Hypothesis 9 & 10) failed because raw volume ratios or volume-volatility denominators created unstable signals (NaNs or low IR), while the successful Hypothesis 8 used a simple range-to-VWAP ratio, suggesting that price dispersion relative to a smoothed liquidity anchor is the most robust signal path.\n                Concise Justification: The square-root of volume (a proxy for the 'market impact' function in market microstructure) provides a more theoretically sound and statistically stable denominator for normalizing price range than raw volume or volume volatility. This prevents the factor from being dominated by extreme low-volume stocks while still penalizing moves that lack 'thick' liquidity support.\n                Concise Knowledge: If a short-term price trend is driven by high intraday dispersion but lacks proportional volume support, it represents a liquidity vacuum; when volume is stabilized via a square-root transform, the resulting ratio effectively identifies price exhaustion without the extreme outlier sensitivity of raw volume ratios.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day Price Range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 20-day Volume Anchor: TS_MEAN(volume, 20). 4. Factor = 3-day return * (5-day Price Range / SQRT(20-day Volume Anchor)). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:08:47.152928"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1276810117799274,
        "ICIR": 0.0455604890831012,
        "1day.excess_return_without_cost.std": 0.0043615777236196,
        "1day.excess_return_with_cost.annualized_return": 0.0169437351640125,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002687302813798,
        "1day.excess_return_without_cost.annualized_return": 0.0639578069684093,
        "1day.excess_return_with_cost.std": 0.0043638335373548,
        "Rank IC": 0.021540764365754,
        "IC": 0.0066506740769,
        "1day.excess_return_without_cost.max_drawdown": -0.1025663819222673,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9505204596640257,
        "1day.pa": 0.0,
        "l2.valid": 0.9962694321047266,
        "Rank ICIR": 0.1510847211215967,
        "l2.train": 0.9941366490485416,
        "1day.excess_return_with_cost.information_ratio": 0.2516821993822449,
        "1day.excess_return_with_cost.mean": 7.11921645546745e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Intraday-Intensity Liquidity Vacuum' hypothesis, focusing on the interaction between short-term price momentum and liquidity-adjusted volatility. The current results show a significant improvement in risk management, with the Max Drawdown reducing from -0.1339 to -0.1025. However, the predictive power (IC) and risk-adjusted returns (Information Ratio) have slightly declined compared to the SOTA result. The 'Intraday_Intensity_Vacuum_SQRT_Volume' factor successfully utilized the square-root volume transformation to stabilize the liquidity signal, but the overall return profile suggests that while the 'vacuum' identification helps in tail-risk reduction, it may be diluting the primary alpha signal compared to the previous SOTA.",
        "hypothesis_evaluation": "The hypothesis that weighting returns by a liquidity-adjusted range identifies mean-reversion is partially supported, specifically in its ability to reduce drawdown. The use of SQRT(Volume) as a denominator effectively prevents extreme outliers from dominating the factor. However, the current implementation of the 'range' (High-Low) might be too noisy. The 'Liquidity_Vacuum_Stabilized_Range' variation, which used a 5-day mean of the range, suggests that smoothing the volatility component is beneficial, but the drop in IC indicates that the timing of the 'vacuum' might be lagging.",
        "decision": false,
        "reason": "Current results show that while the square-root volume helps, the 'High-Low' range is a crude proxy for price intensity. Using the standard deviation of returns (Volatility) provides a more robust measure of price dispersion. Furthermore, instead of a static 20-day mean of volume, using the ratio of current volume to a smoothed average (V/EMA(V)) will more sharply identify 'gaps' where price moves on declining relative volume, which is the core of the 'vacuum' theory. This should improve the IC by better timing the exhaustion points."
      }
    },
    "a22f5aafa8eeecd6": {
      "factor_id": "a22f5aafa8eeecd6",
      "factor_name": "Microstructure_Impact_Reversal",
      "factor_expression": "RANK(TS_MEAN($return, 3) * (($high - $low) / (($high + $low) / 2 + 1e-8)) / (SQRT(TS_MEAN($volume, 20)) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * (($high - $low) / (($high + $low) / 2 + 1e-8)) / (SQRT(TS_MEAN($volume, 20)) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Microstructure_Impact_Reversal\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "Based on the market impact function where price impact is proportional to the square root of volume, this factor identifies overextended trends. It weights the 3-day price momentum by the ratio of the current day's price spread to the smoothed square-root volume, highlighting instances where price dispersion is disproportionately large compared to the liquidity provided.",
      "factor_formulation": "Factor = \\text{RANK}\\left( \\text{TS\\_MEAN}(\\text{return}, 3) \\times \\frac{(\\text{high} - \\text{low}) / ((\\text{high} + \\text{low})/2)}{\\text{SQRT}(\\text{TS\\_MEAN}(\\text{volume}, 20)) + 1e-8} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Intraday-Intensity Liquidity Vacuum' factor identifies mean-reversion by weighting 3-day returns by the ratio of the 5-day Intraday Intensity (High-Low relative to Close) to the 20-day moving average of volume, using a square-root transformation on volume to stabilize the liquidity denominator.\n                Concise Observation: Previous attempts (Hypothesis 9 & 10) failed because raw volume ratios or volume-volatility denominators created unstable signals (NaNs or low IR), while the successful Hypothesis 8 used a simple range-to-VWAP ratio, suggesting that price dispersion relative to a smoothed liquidity anchor is the most robust signal path.\n                Concise Justification: The square-root of volume (a proxy for the 'market impact' function in market microstructure) provides a more theoretically sound and statistically stable denominator for normalizing price range than raw volume or volume volatility. This prevents the factor from being dominated by extreme low-volume stocks while still penalizing moves that lack 'thick' liquidity support.\n                Concise Knowledge: If a short-term price trend is driven by high intraday dispersion but lacks proportional volume support, it represents a liquidity vacuum; when volume is stabilized via a square-root transform, the resulting ratio effectively identifies price exhaustion without the extreme outlier sensitivity of raw volume ratios.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day Price Range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 20-day Volume Anchor: TS_MEAN(volume, 20). 4. Factor = 3-day return * (5-day Price Range / SQRT(20-day Volume Anchor)). 5. Apply CS_RANK to the final result.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:08:47.152928"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1276810117799274,
        "ICIR": 0.0455604890831012,
        "1day.excess_return_without_cost.std": 0.0043615777236196,
        "1day.excess_return_with_cost.annualized_return": 0.0169437351640125,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002687302813798,
        "1day.excess_return_without_cost.annualized_return": 0.0639578069684093,
        "1day.excess_return_with_cost.std": 0.0043638335373548,
        "Rank IC": 0.021540764365754,
        "IC": 0.0066506740769,
        "1day.excess_return_without_cost.max_drawdown": -0.1025663819222673,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9505204596640257,
        "1day.pa": 0.0,
        "l2.valid": 0.9962694321047266,
        "Rank ICIR": 0.1510847211215967,
        "l2.train": 0.9941366490485416,
        "1day.excess_return_with_cost.information_ratio": 0.2516821993822449,
        "1day.excess_return_with_cost.mean": 7.11921645546745e-05
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Intraday-Intensity Liquidity Vacuum' hypothesis, focusing on the interaction between short-term price momentum and liquidity-adjusted volatility. The current results show a significant improvement in risk management, with the Max Drawdown reducing from -0.1339 to -0.1025. However, the predictive power (IC) and risk-adjusted returns (Information Ratio) have slightly declined compared to the SOTA result. The 'Intraday_Intensity_Vacuum_SQRT_Volume' factor successfully utilized the square-root volume transformation to stabilize the liquidity signal, but the overall return profile suggests that while the 'vacuum' identification helps in tail-risk reduction, it may be diluting the primary alpha signal compared to the previous SOTA.",
        "hypothesis_evaluation": "The hypothesis that weighting returns by a liquidity-adjusted range identifies mean-reversion is partially supported, specifically in its ability to reduce drawdown. The use of SQRT(Volume) as a denominator effectively prevents extreme outliers from dominating the factor. However, the current implementation of the 'range' (High-Low) might be too noisy. The 'Liquidity_Vacuum_Stabilized_Range' variation, which used a 5-day mean of the range, suggests that smoothing the volatility component is beneficial, but the drop in IC indicates that the timing of the 'vacuum' might be lagging.",
        "decision": false,
        "reason": "Current results show that while the square-root volume helps, the 'High-Low' range is a crude proxy for price intensity. Using the standard deviation of returns (Volatility) provides a more robust measure of price dispersion. Furthermore, instead of a static 20-day mean of volume, using the ratio of current volume to a smoothed average (V/EMA(V)) will more sharply identify 'gaps' where price moves on declining relative volume, which is the core of the 'vacuum' theory. This should improve the IC by better timing the exhaustion points."
      }
    },
    "1346237bb1ca27de": {
      "factor_id": "1346237bb1ca27de",
      "factor_name": "Liquidity_Weighted_Mean_Reversion_V1",
      "factor_expression": "RANK(($close / DELAY($close, 3) - 1) * (TS_STD($close, 5) / (EMA($close, 5) + 1e-8)) / (TS_MEDIAN($volume, 20) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(($close / DELAY($close, 3) - 1) * (TS_STD($close, 5) / (EMA($close, 5) + 1e-8)) / (TS_MEDIAN($volume, 20) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Weighted_Mean_Reversion_V1\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies price exhaustion by scaling the 3-day return by the ratio of 5-day volatility to the stability of the volume-weighted price. It uses a 20-day volume median as a robust anchor to avoid noise from individual volume spikes, identifying 'liquidity vacuums' where price moves are unsupported by structural participation.",
      "factor_formulation": "LWMR = \\text{RANK}\\left(\\left(\\frac{\\text{close}}{\\text{DELAY}(\\text{close}, 3)} - 1\\right) \\times \\frac{\\text{TS_STD}(\\text{close}, 5)}{\\text{EMA}(\\text{close}, 5)} \\times \\frac{1}{\\text{TS_MEDIAN}(\\text{volume}, 20)}\\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity-Weighted Mean Reversion' factor identifies price exhaustion by scaling the 3-day return by the ratio of 5-day volatility to the 5-day volume-weighted average price (VWAP) stability, using a 20-day volume median to prevent outlier-driven signal degradation.\n                Concise Observation: Previous successful iterations (Hypothesis 8) used VWAP-based ratios, but subsequent failures (Hypotheses 10 & 11) suggest that square-root volume or raw volume ratios either lack stability or introduce noise; a median-based volume anchor combined with VWAP-derived price stability offers a balance between responsiveness and robustness.\n                Concise Justification: VWAP represents the average price level where actual liquidity was provided; if current price dispersion (volatility) significantly exceeds this level while volume is below its 20-day median, it signals a 'liquidity vacuum' where the price has overextended beyond its support zone, leading to a high probability of reversal.\n                Concise Knowledge: If a short-term price trend occurs with high return volatility but low volume support relative to its structural median, the move is likely a liquidity-driven anomaly; when volume is anchored by a 20-day median, it provides a more robust 'thickness' measure than a mean or square-root, better isolating mean-reverting exhaustion points.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price volatility: TS_STD(close, 5). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Calculate 20-day volume median: TS_MEDIAN(volume, 20). 5. Factor = 3-day return * (5-day volatility / 5-day VWAP) * (1 / 20-day volume median). 6. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:14:07.740603"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1420593973652203,
        "ICIR": 0.0469134731228375,
        "1day.excess_return_without_cost.std": 0.0043831332653269,
        "1day.excess_return_with_cost.annualized_return": 0.0010456539492456,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002023280304308,
        "1day.excess_return_without_cost.annualized_return": 0.048154071242544,
        "1day.excess_return_with_cost.std": 0.0043843868159874,
        "Rank IC": 0.0230812851191272,
        "IC": 0.0069235609874522,
        "1day.excess_return_without_cost.max_drawdown": -0.1238436796717009,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.712130943645514,
        "1day.pa": 0.0,
        "l2.valid": 0.996134223234358,
        "Rank ICIR": 0.1605533373339006,
        "l2.train": 0.99371378429762,
        "1day.excess_return_with_cost.information_ratio": 0.0154593290212559,
        "1day.excess_return_with_cost.mean": 4.393503988427223e-06
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity-Weighted Mean Reversion' hypothesis. While the current results (specifically the SLVZ factor) achieved a superior Max Drawdown (-0.1238 vs -0.1339), they failed to outperform the SOTA in terms of Information Ratio (0.712 vs 1.103), Annualized Return (0.048 vs 0.080), and IC (0.0069 vs 0.0078). The Structural_Liquidity_Vacuum_Z (SLVZ) provided the most stable implementation by using Z-score normalization, but the overall predictive power decreased compared to the previous best iteration.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a ratio of volatility to median volume identifies exhaustion is supported in terms of risk control (lower drawdown), but the current mathematical formulations are likely diluting the alpha signal. The inclusion of volume in the denominator (TS_MEDIAN(volume, 20)) effectively penalizes high-volume moves, which might be filtering out valid trend-continuation signals along with the intended exhaustion signals. The 'VWAP proxy' used in VSEF appears overly complex and may be introducing noise rather than stability.",
        "decision": false,
        "reason": "Current results show good risk management but weak returns. By using a Volume Surge Ratio instead of raw median volume, we normalize the liquidity context across different instruments more effectively than a simple Z-score. Furthermore, mean reversion is typically strongest at the tails of price moves; squaring the return or using a sign-preserving power transformation can help the model focus on the most profitable reversal opportunities while ignoring low-conviction noise."
      }
    },
    "cefb05cd70e9cba4": {
      "factor_id": "cefb05cd70e9cba4",
      "factor_name": "VWAP_Stability_Exhaustion_Factor",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * TS_STD($close, 5) / (EMA($close * ($volume / (TS_MEDIAN($volume, 20) + 1e-8)), 5) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * TS_STD($close, 5) / (EMA($close * ($volume / (TS_MEDIAN($volume, 20) + 1e-8)), 5) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"VWAP_Stability_Exhaustion_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "Captures mean reversion by measuring the 3-day return relative to price dispersion. Instead of a direct VWAP denominator which was flagged for duplication, it uses the ratio of price volatility to a volume-weighted price proxy (EMA of close scaled by median volume) to isolate liquidity-driven price overextensions.",
      "factor_formulation": "VSEF = \\text{RANK}\\left(\\frac{\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\text{TS_STD}(\\text{close}, 5)}{\\text{EMA}(\\text{close} \\times \\text{volume} / \\text{TS_MEDIAN}(\\text{volume}, 20), 5)}\\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity-Weighted Mean Reversion' factor identifies price exhaustion by scaling the 3-day return by the ratio of 5-day volatility to the 5-day volume-weighted average price (VWAP) stability, using a 20-day volume median to prevent outlier-driven signal degradation.\n                Concise Observation: Previous successful iterations (Hypothesis 8) used VWAP-based ratios, but subsequent failures (Hypotheses 10 & 11) suggest that square-root volume or raw volume ratios either lack stability or introduce noise; a median-based volume anchor combined with VWAP-derived price stability offers a balance between responsiveness and robustness.\n                Concise Justification: VWAP represents the average price level where actual liquidity was provided; if current price dispersion (volatility) significantly exceeds this level while volume is below its 20-day median, it signals a 'liquidity vacuum' where the price has overextended beyond its support zone, leading to a high probability of reversal.\n                Concise Knowledge: If a short-term price trend occurs with high return volatility but low volume support relative to its structural median, the move is likely a liquidity-driven anomaly; when volume is anchored by a 20-day median, it provides a more robust 'thickness' measure than a mean or square-root, better isolating mean-reverting exhaustion points.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price volatility: TS_STD(close, 5). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Calculate 20-day volume median: TS_MEDIAN(volume, 20). 5. Factor = 3-day return * (5-day volatility / 5-day VWAP) * (1 / 20-day volume median). 6. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:14:07.740603"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1420593973652203,
        "ICIR": 0.0469134731228375,
        "1day.excess_return_without_cost.std": 0.0043831332653269,
        "1day.excess_return_with_cost.annualized_return": 0.0010456539492456,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002023280304308,
        "1day.excess_return_without_cost.annualized_return": 0.048154071242544,
        "1day.excess_return_with_cost.std": 0.0043843868159874,
        "Rank IC": 0.0230812851191272,
        "IC": 0.0069235609874522,
        "1day.excess_return_without_cost.max_drawdown": -0.1238436796717009,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.712130943645514,
        "1day.pa": 0.0,
        "l2.valid": 0.996134223234358,
        "Rank ICIR": 0.1605533373339006,
        "l2.train": 0.99371378429762,
        "1day.excess_return_with_cost.information_ratio": 0.0154593290212559,
        "1day.excess_return_with_cost.mean": 4.393503988427223e-06
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity-Weighted Mean Reversion' hypothesis. While the current results (specifically the SLVZ factor) achieved a superior Max Drawdown (-0.1238 vs -0.1339), they failed to outperform the SOTA in terms of Information Ratio (0.712 vs 1.103), Annualized Return (0.048 vs 0.080), and IC (0.0069 vs 0.0078). The Structural_Liquidity_Vacuum_Z (SLVZ) provided the most stable implementation by using Z-score normalization, but the overall predictive power decreased compared to the previous best iteration.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a ratio of volatility to median volume identifies exhaustion is supported in terms of risk control (lower drawdown), but the current mathematical formulations are likely diluting the alpha signal. The inclusion of volume in the denominator (TS_MEDIAN(volume, 20)) effectively penalizes high-volume moves, which might be filtering out valid trend-continuation signals along with the intended exhaustion signals. The 'VWAP proxy' used in VSEF appears overly complex and may be introducing noise rather than stability.",
        "decision": false,
        "reason": "Current results show good risk management but weak returns. By using a Volume Surge Ratio instead of raw median volume, we normalize the liquidity context across different instruments more effectively than a simple Z-score. Furthermore, mean reversion is typically strongest at the tails of price moves; squaring the return or using a sign-preserving power transformation can help the model focus on the most profitable reversal opportunities while ignoring low-conviction noise."
      }
    },
    "2643afa1b5a9b6a0": {
      "factor_id": "2643afa1b5a9b6a0",
      "factor_name": "Structural_Liquidity_Vacuum_Z",
      "factor_expression": "ZSCORE(TS_PCTCHANGE($close, 3) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 20) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"ZSCORE(TS_PCTCHANGE($close, 3) * (TS_STD($close, 5) / (TS_MEDIAN($volume, 20) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Structural_Liquidity_Vacuum_Z\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "Identifies reversal points by scaling short-term returns by a 'liquidity stress' metric. The stress is defined as the 5-day price volatility divided by the 20-day median volume, which acts as a robust anchor for structural liquidity. This version uses a Z-score for cross-sectional stability.",
      "factor_formulation": "SLVZ = \\text{ZSCORE}\\left(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\frac{\\text{TS_STD}(\\text{close}, 5)}{\\text{TS_MEDIAN}(\\text{volume}, 20)}\\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Liquidity-Weighted Mean Reversion' factor identifies price exhaustion by scaling the 3-day return by the ratio of 5-day volatility to the 5-day volume-weighted average price (VWAP) stability, using a 20-day volume median to prevent outlier-driven signal degradation.\n                Concise Observation: Previous successful iterations (Hypothesis 8) used VWAP-based ratios, but subsequent failures (Hypotheses 10 & 11) suggest that square-root volume or raw volume ratios either lack stability or introduce noise; a median-based volume anchor combined with VWAP-derived price stability offers a balance between responsiveness and robustness.\n                Concise Justification: VWAP represents the average price level where actual liquidity was provided; if current price dispersion (volatility) significantly exceeds this level while volume is below its 20-day median, it signals a 'liquidity vacuum' where the price has overextended beyond its support zone, leading to a high probability of reversal.\n                Concise Knowledge: If a short-term price trend occurs with high return volatility but low volume support relative to its structural median, the move is likely a liquidity-driven anomaly; when volume is anchored by a 20-day median, it provides a more robust 'thickness' measure than a mean or square-root, better isolating mean-reverting exhaustion points.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price volatility: TS_STD(close, 5). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Calculate 20-day volume median: TS_MEDIAN(volume, 20). 5. Factor = 3-day return * (5-day volatility / 5-day VWAP) * (1 / 20-day volume median). 6. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:14:07.740603"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1420593973652203,
        "ICIR": 0.0469134731228375,
        "1day.excess_return_without_cost.std": 0.0043831332653269,
        "1day.excess_return_with_cost.annualized_return": 0.0010456539492456,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002023280304308,
        "1day.excess_return_without_cost.annualized_return": 0.048154071242544,
        "1day.excess_return_with_cost.std": 0.0043843868159874,
        "Rank IC": 0.0230812851191272,
        "IC": 0.0069235609874522,
        "1day.excess_return_without_cost.max_drawdown": -0.1238436796717009,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.712130943645514,
        "1day.pa": 0.0,
        "l2.valid": 0.996134223234358,
        "Rank ICIR": 0.1605533373339006,
        "l2.train": 0.99371378429762,
        "1day.excess_return_with_cost.information_ratio": 0.0154593290212559,
        "1day.excess_return_with_cost.mean": 4.393503988427223e-06
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Liquidity-Weighted Mean Reversion' hypothesis. While the current results (specifically the SLVZ factor) achieved a superior Max Drawdown (-0.1238 vs -0.1339), they failed to outperform the SOTA in terms of Information Ratio (0.712 vs 1.103), Annualized Return (0.048 vs 0.080), and IC (0.0069 vs 0.0078). The Structural_Liquidity_Vacuum_Z (SLVZ) provided the most stable implementation by using Z-score normalization, but the overall predictive power decreased compared to the previous best iteration.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a ratio of volatility to median volume identifies exhaustion is supported in terms of risk control (lower drawdown), but the current mathematical formulations are likely diluting the alpha signal. The inclusion of volume in the denominator (TS_MEDIAN(volume, 20)) effectively penalizes high-volume moves, which might be filtering out valid trend-continuation signals along with the intended exhaustion signals. The 'VWAP proxy' used in VSEF appears overly complex and may be introducing noise rather than stability.",
        "decision": false,
        "reason": "Current results show good risk management but weak returns. By using a Volume Surge Ratio instead of raw median volume, we normalize the liquidity context across different instruments more effectively than a simple Z-score. Furthermore, mean reversion is typically strongest at the tails of price moves; squaring the return or using a sign-preserving power transformation can help the model focus on the most profitable reversal opportunities while ignoring low-conviction noise."
      }
    },
    "2e472c38905369fb": {
      "factor_id": "2e472c38905369fb",
      "factor_name": "Momentum_Liquidity_Decay_Exhaustion",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * (TS_MEAN($high - $low, 5) / ($close + 1e-8)) * EXP(-RANK(TS_MEAN($volume, 20))))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * (TS_MEAN($high - $low, 5) / ($close + 1e-8)) * EXP(-RANK(TS_MEAN($volume, 20))))\" # Your output factor expression will be filled in here\n    name = \"Momentum_Liquidity_Decay_Exhaustion\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies mean-reversion by scaling a 3-day momentum signal by the ratio of price dispersion to liquidity support. It uses the 5-day average true range (ATR proxy) to measure 'effort' and an exponential decay of the volume turnover rank to identify 'liquidity vacuums'. High momentum on high dispersion but low relative volume rank suggests exhaustion.",
      "factor_formulation": "\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\frac{\\text{TS_MEAN}(\\text{high} - \\text{low}, 5)}{\\text{close}} \\times \\text{EXP}(-\\text{RANK}(\\text{TS_MEAN}(\\text{volume}, 20))))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Momentum-Liquidity Divergence' factor identifies mean-reversion by scaling the 3-day return by the ratio of 5-day price range to the 20-day volume turnover, using a cross-sectional rank of volume to normalize liquidity across different market caps.\n                Concise Observation: Previous iterations (Hypotheses 8-11) showed that while VWAP and volume medians help with stability, the most successful signal (Hypothesis 7/8 SOTA) relied on a simple ratio of price dispersion to liquidity; however, the signal degrades when the volume denominator is either too static (60-day) or too volatile (raw volume).\n                Concise Justification: Using the 5-day price range captures the 'effort' of the price move, while the 20-day volume turnover (volume/shares) or a cross-sectional rank of volume provides a 'support' metric. The divergence between high effort (range) and low support (volume rank) identifies the exhaustion points that lead to the high IC and IR observed in the SOTA.\n                Concise Knowledge: In quant investment, a price move is likely to revert if its intraday dispersion (High-Low) is high while its relative liquidity (volume rank) is low; when price moves 'too far' on 'too little' relative participation, it indicates a liquidity vacuum rather than a structural trend.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 20-day average volume: TS_MEAN(volume, 20). 4. Calculate Cross-Sectional Rank of the 20-day average volume: CS_RANK(TS_MEAN(volume, 20)). 5. Factor = 3-day return * 5-day price range * (1 - CS_RANK(TS_MEAN(volume, 20))). 6. Apply CS_RANK to the final product.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:21:56.116652"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1680828932309595,
        "ICIR": 0.0373834655331942,
        "1day.excess_return_without_cost.std": 0.0046569336995083,
        "1day.excess_return_with_cost.annualized_return": 0.0191509674849163,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002805432154669,
        "1day.excess_return_without_cost.annualized_return": 0.0667692852811363,
        "1day.excess_return_with_cost.std": 0.004659715404211,
        "Rank IC": 0.0208091443327035,
        "IC": 0.0054274777772556,
        "1day.excess_return_without_cost.max_drawdown": -0.1369981355958567,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9293690254322984,
        "1day.pa": 0.0,
        "l2.valid": 0.9962738443108696,
        "Rank ICIR": 0.1467684716431659,
        "l2.train": 0.9934352099995112,
        "1day.excess_return_with_cost.information_ratio": 0.2664052920942497,
        "1day.excess_return_with_cost.mean": 8.046624993662336e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Momentum-Liquidity Divergence' hypothesis: an exponential decay approach (Decay_Exhaustion), a direct ratio with cross-sectional normalization (Vacuum_Pressure), and a double-normalization approach using self-historical benchmarks (Dispersion_Turnover_Divergence). Despite the theoretical depth, the results show a decline across all key performance metrics compared to the SOTA. The Information Ratio dropped from 1.104 to 0.929, and the IC fell from 0.0079 to 0.0054. This suggests that while the concept of 'price movement on thin volume' is valid, the current mathematical implementationsspecifically the interaction between cross-sectional RANK and time-series operatorsmight be introducing noise or neutralizing the signal's predictive power.",
        "hypothesis_evaluation": "The hypothesis that scaling momentum by a liquidity-normalized price range identifies mean-reversion is partially supported in concept but poorly executed in the current formulations. The 'ZScore_Liquidity_Vacuum_Pressure' and 'Relative_Dispersion_Turnover_Divergence' factors likely suffered from 'scale mismatch' where the numerator (price change) and denominator (volume rank or ratio) operate on different distributions. The use of TS_SUM and TS_MAX/MIN over short windows (3-5 days) without proper volatility scaling may be capturing noise rather than structural exhaustion.",
        "decision": false,
        "reason": "The previous factors were overly complex, involving multiple nested functions (RANK, EXP, TS_MEAN of TS_MAX). Simplification is needed. By using a Z-score or ratio of volume (Current Volume / Average Volume) to scale a volatility-standardized return (Return / ATR), we isolate instances where price moves significantly on low relative volume. This reduces the 'Base Features Count' and 'Symbol Length' while maintaining the core logic of the original hypothesis. Avoiding cross-sectional RANK within the time-series calculation prevents look-ahead bias and distribution distortions."
      }
    },
    "9af7abeefca3e1bf": {
      "factor_id": "9af7abeefca3e1bf",
      "factor_name": "ZScore_Liquidity_Vacuum_Pressure",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * TS_SUM($high - $low, 5) / (RANK(TS_MEAN($volume, 20)) + 0.01))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * TS_SUM($high - $low, 5) / (RANK(TS_MEAN($volume, 20)) + 0.01))\" # Your output factor expression will be filled in here\n    name = \"ZScore_Liquidity_Vacuum_Pressure\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures price overextensions by multiplying the 3-day return by a price-intensity metric (5-day high-low sum) and dividing by the cross-sectional rank of the 20-day volume mean. The use of TS_SUM for price range and RANK for volume avoids the duplication of standard range-to-price ratios while isolating assets moving on thin liquidity.",
      "factor_formulation": "\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\text{TS_SUM}(\\text{high} - \\text{low}, 5) / (\\text{RANK}(\\text{TS_MEAN}(\\text{volume}, 20)) + 0.01))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Momentum-Liquidity Divergence' factor identifies mean-reversion by scaling the 3-day return by the ratio of 5-day price range to the 20-day volume turnover, using a cross-sectional rank of volume to normalize liquidity across different market caps.\n                Concise Observation: Previous iterations (Hypotheses 8-11) showed that while VWAP and volume medians help with stability, the most successful signal (Hypothesis 7/8 SOTA) relied on a simple ratio of price dispersion to liquidity; however, the signal degrades when the volume denominator is either too static (60-day) or too volatile (raw volume).\n                Concise Justification: Using the 5-day price range captures the 'effort' of the price move, while the 20-day volume turnover (volume/shares) or a cross-sectional rank of volume provides a 'support' metric. The divergence between high effort (range) and low support (volume rank) identifies the exhaustion points that lead to the high IC and IR observed in the SOTA.\n                Concise Knowledge: In quant investment, a price move is likely to revert if its intraday dispersion (High-Low) is high while its relative liquidity (volume rank) is low; when price moves 'too far' on 'too little' relative participation, it indicates a liquidity vacuum rather than a structural trend.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 20-day average volume: TS_MEAN(volume, 20). 4. Calculate Cross-Sectional Rank of the 20-day average volume: CS_RANK(TS_MEAN(volume, 20)). 5. Factor = 3-day return * 5-day price range * (1 - CS_RANK(TS_MEAN(volume, 20))). 6. Apply CS_RANK to the final product.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:21:56.116652"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1680828932309595,
        "ICIR": 0.0373834655331942,
        "1day.excess_return_without_cost.std": 0.0046569336995083,
        "1day.excess_return_with_cost.annualized_return": 0.0191509674849163,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002805432154669,
        "1day.excess_return_without_cost.annualized_return": 0.0667692852811363,
        "1day.excess_return_with_cost.std": 0.004659715404211,
        "Rank IC": 0.0208091443327035,
        "IC": 0.0054274777772556,
        "1day.excess_return_without_cost.max_drawdown": -0.1369981355958567,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9293690254322984,
        "1day.pa": 0.0,
        "l2.valid": 0.9962738443108696,
        "Rank ICIR": 0.1467684716431659,
        "l2.train": 0.9934352099995112,
        "1day.excess_return_with_cost.information_ratio": 0.2664052920942497,
        "1day.excess_return_with_cost.mean": 8.046624993662336e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Momentum-Liquidity Divergence' hypothesis: an exponential decay approach (Decay_Exhaustion), a direct ratio with cross-sectional normalization (Vacuum_Pressure), and a double-normalization approach using self-historical benchmarks (Dispersion_Turnover_Divergence). Despite the theoretical depth, the results show a decline across all key performance metrics compared to the SOTA. The Information Ratio dropped from 1.104 to 0.929, and the IC fell from 0.0079 to 0.0054. This suggests that while the concept of 'price movement on thin volume' is valid, the current mathematical implementationsspecifically the interaction between cross-sectional RANK and time-series operatorsmight be introducing noise or neutralizing the signal's predictive power.",
        "hypothesis_evaluation": "The hypothesis that scaling momentum by a liquidity-normalized price range identifies mean-reversion is partially supported in concept but poorly executed in the current formulations. The 'ZScore_Liquidity_Vacuum_Pressure' and 'Relative_Dispersion_Turnover_Divergence' factors likely suffered from 'scale mismatch' where the numerator (price change) and denominator (volume rank or ratio) operate on different distributions. The use of TS_SUM and TS_MAX/MIN over short windows (3-5 days) without proper volatility scaling may be capturing noise rather than structural exhaustion.",
        "decision": false,
        "reason": "The previous factors were overly complex, involving multiple nested functions (RANK, EXP, TS_MEAN of TS_MAX). Simplification is needed. By using a Z-score or ratio of volume (Current Volume / Average Volume) to scale a volatility-standardized return (Return / ATR), we isolate instances where price moves significantly on low relative volume. This reduces the 'Base Features Count' and 'Symbol Length' while maintaining the core logic of the original hypothesis. Avoiding cross-sectional RANK within the time-series calculation prevents look-ahead bias and distribution distortions."
      }
    },
    "118f01b29b262063": {
      "factor_id": "118f01b29b262063",
      "factor_name": "Relative_Dispersion_Turnover_Divergence",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN(TS_MAX($high, 5) - TS_MIN($low, 5), 20) + 1e-8)) / (TS_MEAN($volume, 5) / (TS_MEDIAN($volume, 20) + 1e-8) + 1e-8))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_MEAN(TS_MAX($high, 5) - TS_MIN($low, 5), 20) + 1e-8)) / (TS_MEAN($volume, 5) / (TS_MEDIAN($volume, 20) + 1e-8) + 1e-8))\" # Your output factor expression will be filled in here\n    name = \"Relative_Dispersion_Turnover_Divergence\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies exhaustion points by comparing the 3-day price trend to the 5-day price dispersion, normalized by the 20-day volume median. It uses the ratio of the current 5-day range to its own 20-day moving average to ensure the 'effort' is abnormal relative to the stock's own history, then scales by the inverse of relative volume.",
      "factor_formulation": "\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\frac{\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5)}{\\text{TS_MEAN}(\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5), 20)} / \\frac{\\text{TS_MEAN}(\\text{volume}, 5)}{\\text{TS_MEDIAN}(\\text{volume}, 20)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Momentum-Liquidity Divergence' factor identifies mean-reversion by scaling the 3-day return by the ratio of 5-day price range to the 20-day volume turnover, using a cross-sectional rank of volume to normalize liquidity across different market caps.\n                Concise Observation: Previous iterations (Hypotheses 8-11) showed that while VWAP and volume medians help with stability, the most successful signal (Hypothesis 7/8 SOTA) relied on a simple ratio of price dispersion to liquidity; however, the signal degrades when the volume denominator is either too static (60-day) or too volatile (raw volume).\n                Concise Justification: Using the 5-day price range captures the 'effort' of the price move, while the 20-day volume turnover (volume/shares) or a cross-sectional rank of volume provides a 'support' metric. The divergence between high effort (range) and low support (volume rank) identifies the exhaustion points that lead to the high IC and IR observed in the SOTA.\n                Concise Knowledge: In quant investment, a price move is likely to revert if its intraday dispersion (High-Low) is high while its relative liquidity (volume rank) is low; when price moves 'too far' on 'too little' relative participation, it indicates a liquidity vacuum rather than a structural trend.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day price range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 20-day average volume: TS_MEAN(volume, 20). 4. Calculate Cross-Sectional Rank of the 20-day average volume: CS_RANK(TS_MEAN(volume, 20)). 5. Factor = 3-day return * 5-day price range * (1 - CS_RANK(TS_MEAN(volume, 20))). 6. Apply CS_RANK to the final product.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:21:56.116652"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1680828932309595,
        "ICIR": 0.0373834655331942,
        "1day.excess_return_without_cost.std": 0.0046569336995083,
        "1day.excess_return_with_cost.annualized_return": 0.0191509674849163,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0002805432154669,
        "1day.excess_return_without_cost.annualized_return": 0.0667692852811363,
        "1day.excess_return_with_cost.std": 0.004659715404211,
        "Rank IC": 0.0208091443327035,
        "IC": 0.0054274777772556,
        "1day.excess_return_without_cost.max_drawdown": -0.1369981355958567,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.9293690254322984,
        "1day.pa": 0.0,
        "l2.valid": 0.9962738443108696,
        "Rank ICIR": 0.1467684716431659,
        "l2.train": 0.9934352099995112,
        "1day.excess_return_with_cost.information_ratio": 0.2664052920942497,
        "1day.excess_return_with_cost.mean": 8.046624993662336e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Momentum-Liquidity Divergence' hypothesis: an exponential decay approach (Decay_Exhaustion), a direct ratio with cross-sectional normalization (Vacuum_Pressure), and a double-normalization approach using self-historical benchmarks (Dispersion_Turnover_Divergence). Despite the theoretical depth, the results show a decline across all key performance metrics compared to the SOTA. The Information Ratio dropped from 1.104 to 0.929, and the IC fell from 0.0079 to 0.0054. This suggests that while the concept of 'price movement on thin volume' is valid, the current mathematical implementationsspecifically the interaction between cross-sectional RANK and time-series operatorsmight be introducing noise or neutralizing the signal's predictive power.",
        "hypothesis_evaluation": "The hypothesis that scaling momentum by a liquidity-normalized price range identifies mean-reversion is partially supported in concept but poorly executed in the current formulations. The 'ZScore_Liquidity_Vacuum_Pressure' and 'Relative_Dispersion_Turnover_Divergence' factors likely suffered from 'scale mismatch' where the numerator (price change) and denominator (volume rank or ratio) operate on different distributions. The use of TS_SUM and TS_MAX/MIN over short windows (3-5 days) without proper volatility scaling may be capturing noise rather than structural exhaustion.",
        "decision": false,
        "reason": "The previous factors were overly complex, involving multiple nested functions (RANK, EXP, TS_MEAN of TS_MAX). Simplification is needed. By using a Z-score or ratio of volume (Current Volume / Average Volume) to scale a volatility-standardized return (Return / ATR), we isolate instances where price moves significantly on low relative volume. This reduces the 'Base Features Count' and 'Symbol Length' while maintaining the core logic of the original hypothesis. Avoiding cross-sectional RANK within the time-series calculation prevents look-ahead bias and distribution distortions."
      }
    },
    "e4f95d4a1e3a08f2": {
      "factor_id": "e4f95d4a1e3a08f2",
      "factor_name": "Price_Efficiency_Liquidity_Shock_3D",
      "factor_expression": "RANK((($close / DELAY($close, 3)) - 1) * (TS_STD($return, 5) / (TS_MEAN($volume, 5) / (TS_STD($volume, 60) + 1e-8) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * (TS_STD(TS_PCTCHANGE($close, 1), 5) / (TS_MEAN($volume, 5) / (TS_STD($volume, 60) + 1e-8) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Price_Efficiency_Liquidity_Shock_3D\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies mean-reversion by scaling the 3-day return by a 'Price Efficiency' metric. It measures price dispersion (standard deviation of returns) relative to a volume shock (current 5-day mean volume normalized by its 60-day volatility). This isolates instances where price volatility is high but volume support is structurally low, indicating a liquidity-driven exhaustion point.",
      "factor_formulation": "PEL_\\text{3D} = \\text{RANK}\\left( \\frac{$close - \\text{DELAY}($close, 3)}{\\text{DELAY}($close, 3)} \\times \\frac{\\text{TS_STD}($return, 5)}{\\text{TS_MEAN}($volume, 5) / \\text{TS_STD}($volume, 60)} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Price-Efficiency Liquidity Gap' factor identifies mean-reversion by scaling the 3-day return by the ratio of the 5-day price range to the 5-day average volume, where both components are normalized by their respective 60-day historical standard deviations to isolate abnormal shocks.\n                Concise Observation: Previous attempts failed when using raw volume or simple volume ranks (Hypotheses 9 & 10) because they didn't account for the stock-specific 'normal' volatility of both price and volume, leading to signal dilution across different liquidity regimes.\n                Concise Justification: Normalizing the 5-day price range and 5-day volume by their 60-day rolling standard deviations transforms them into 'shock' measures. By multiplying the 3-day return by the ratio of these shocks (Price Shock / Volume Shock), we amplify instances where price moves 'too much' on 'too little' relative volume, which is the core signature of a mean-reverting exhaustion point.\n                Concise Knowledge: If a short-term price move exhibits high dispersion relative to its historical volatility while volume remains low relative to its historical variability, the move is likely a liquidity-driven anomaly; such 'inefficient' moves tend to revert as liquidity providers return to the market.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day Range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 5-day Mean Volume: TS_MEAN(volume, 5). 4. Normalize Range: Range / TS_STD(Range, 60). 5. Normalize Volume: Mean_Volume / TS_STD(volume, 60). 6. Factor = 3-day return * (Normalized Range / Normalized Volume). 7. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:29:05.127933"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1659455397797122,
        "ICIR": 0.0492900685685951,
        "1day.excess_return_without_cost.std": 0.0045269705639401,
        "1day.excess_return_with_cost.annualized_return": -0.0029148572904758,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001869515905261,
        "1day.excess_return_without_cost.annualized_return": 0.0444944785452162,
        "1day.excess_return_with_cost.std": 0.0045290133900393,
        "Rank IC": 0.0245431545033211,
        "IC": 0.0073086649562982,
        "1day.excess_return_without_cost.max_drawdown": -0.1199322269744926,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6371034726900894,
        "1day.pa": 0.0,
        "l2.valid": 0.9963189219325592,
        "Rank ICIR": 0.172509648336834,
        "l2.train": 0.993526506050746,
        "1day.excess_return_with_cost.information_ratio": -0.0417181665540016,
        "1day.excess_return_with_cost.mean": -1.2247299539814685e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Price-Efficiency Liquidity Gap' hypothesis, focusing on different ways to normalize price dispersion and volume shocks. While the 'Liquidity_Gap_ZScore_Momentum' and 'Normalized_Range_Volume_Shock_Ratio' attempted to refine the signal using Z-scores and price ranges, the overall performance (Annualized Return: 0.0445, IR: 0.637) failed to surpass the existing SOTA (Annualized Return: 0.0810, IR: 1.104). The IC is also slightly lower than the SOTA. The reduction in Max Drawdown (-0.1199 vs -0.1339) is a positive sign of risk control, but it comes at too high a cost to the return profile.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a liquidity-to-volatility gap identifies mean-reversion holds theoretical merit, but the current implementations might be overly complex or misaligned in timing. The 'Liquidity_Gap_ZScore_Momentum' uses a 60-day Z-score which might be too slow to capture the 'shock' nature of the signal, potentially lagging the actual mean-reversion window. Furthermore, the interaction between the 3-day return and the 5-day volume mean may be creating a mismatch in the signal's horizon.",
        "decision": false,
        "reason": "1. Shorten Windows: The current 5-day and 60-day windows may be too long for mean-reversion; shortening the 'shock' window to 2 days and the normalization window to 20 days should capture more immediate exhaustion points. 2. Simplify Normalization: Instead of Z-scores or standard deviations of standard deviations (which increase complexity and risk overfitting), a simple ratio of current volume to its moving average (V/MA(V)) provides a cleaner 'shock' signal. 3. Consistency: Aligning the return window (2-day) with the range/volume window (2-day) ensures the price action and the liquidity context are perfectly synchronized."
      }
    },
    "84dee43b5e072460": {
      "factor_id": "84dee43b5e072460",
      "factor_name": "Normalized_Range_Volume_Shock_Ratio",
      "factor_expression": "RANK((DELTA($close, 3) / $close) * ((($high - $low) / (TS_STD($high - $low, 60) + 1e-8)) / (TS_MEAN($volume, 5) / (TS_STD($volume, 60) + 1e-8) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK((DELTA($close, 3) / $close) * ((($high - $low) / (TS_STD($high - $low, 60) + 1e-8)) / (TS_MEAN($volume, 5) / (TS_STD($volume, 60) + 1e-8) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Normalized_Range_Volume_Shock_Ratio\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures mean-reversion by identifying price 'over-extensions' where the short-term range (High-Low) normalized by its own long-term volatility exceeds the normalized volume support. It uses a 3-day return sign to determine direction and scales it by the ratio of price shock to volume shock.",
      "factor_formulation": "\\text{Factor} = \\text{RANK}\\left( \\frac{\\text{DELTA}(close, 3)}{close} \\times \\frac{(high - low) / \\text{TS_STD}(high - low, 60)}{\\text{TS_MEAN}(volume, 5) / \\text{TS_STD}(volume, 60)} \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Price-Efficiency Liquidity Gap' factor identifies mean-reversion by scaling the 3-day return by the ratio of the 5-day price range to the 5-day average volume, where both components are normalized by their respective 60-day historical standard deviations to isolate abnormal shocks.\n                Concise Observation: Previous attempts failed when using raw volume or simple volume ranks (Hypotheses 9 & 10) because they didn't account for the stock-specific 'normal' volatility of both price and volume, leading to signal dilution across different liquidity regimes.\n                Concise Justification: Normalizing the 5-day price range and 5-day volume by their 60-day rolling standard deviations transforms them into 'shock' measures. By multiplying the 3-day return by the ratio of these shocks (Price Shock / Volume Shock), we amplify instances where price moves 'too much' on 'too little' relative volume, which is the core signature of a mean-reverting exhaustion point.\n                Concise Knowledge: If a short-term price move exhibits high dispersion relative to its historical volatility while volume remains low relative to its historical variability, the move is likely a liquidity-driven anomaly; such 'inefficient' moves tend to revert as liquidity providers return to the market.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day Range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 5-day Mean Volume: TS_MEAN(volume, 5). 4. Normalize Range: Range / TS_STD(Range, 60). 5. Normalize Volume: Mean_Volume / TS_STD(volume, 60). 6. Factor = 3-day return * (Normalized Range / Normalized Volume). 7. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:29:05.127933"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1659455397797122,
        "ICIR": 0.0492900685685951,
        "1day.excess_return_without_cost.std": 0.0045269705639401,
        "1day.excess_return_with_cost.annualized_return": -0.0029148572904758,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001869515905261,
        "1day.excess_return_without_cost.annualized_return": 0.0444944785452162,
        "1day.excess_return_with_cost.std": 0.0045290133900393,
        "Rank IC": 0.0245431545033211,
        "IC": 0.0073086649562982,
        "1day.excess_return_without_cost.max_drawdown": -0.1199322269744926,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6371034726900894,
        "1day.pa": 0.0,
        "l2.valid": 0.9963189219325592,
        "Rank ICIR": 0.172509648336834,
        "l2.train": 0.993526506050746,
        "1day.excess_return_with_cost.information_ratio": -0.0417181665540016,
        "1day.excess_return_with_cost.mean": -1.2247299539814685e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Price-Efficiency Liquidity Gap' hypothesis, focusing on different ways to normalize price dispersion and volume shocks. While the 'Liquidity_Gap_ZScore_Momentum' and 'Normalized_Range_Volume_Shock_Ratio' attempted to refine the signal using Z-scores and price ranges, the overall performance (Annualized Return: 0.0445, IR: 0.637) failed to surpass the existing SOTA (Annualized Return: 0.0810, IR: 1.104). The IC is also slightly lower than the SOTA. The reduction in Max Drawdown (-0.1199 vs -0.1339) is a positive sign of risk control, but it comes at too high a cost to the return profile.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a liquidity-to-volatility gap identifies mean-reversion holds theoretical merit, but the current implementations might be overly complex or misaligned in timing. The 'Liquidity_Gap_ZScore_Momentum' uses a 60-day Z-score which might be too slow to capture the 'shock' nature of the signal, potentially lagging the actual mean-reversion window. Furthermore, the interaction between the 3-day return and the 5-day volume mean may be creating a mismatch in the signal's horizon.",
        "decision": false,
        "reason": "1. Shorten Windows: The current 5-day and 60-day windows may be too long for mean-reversion; shortening the 'shock' window to 2 days and the normalization window to 20 days should capture more immediate exhaustion points. 2. Simplify Normalization: Instead of Z-scores or standard deviations of standard deviations (which increase complexity and risk overfitting), a simple ratio of current volume to its moving average (V/MA(V)) provides a cleaner 'shock' signal. 3. Consistency: Aligning the return window (2-day) with the range/volume window (2-day) ensures the price action and the liquidity context are perfectly synchronized."
      }
    },
    "46591234a4a602c2": {
      "factor_id": "46591234a4a602c2",
      "factor_name": "Liquidity_Gap_ZScore_Momentum",
      "factor_expression": "RANK((DELTA($close, 3) / $close) * (TS_ZSCORE($high - $low, 60) - TS_ZSCORE(TS_MEAN($volume, 5), 60)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK((DELTA($close, 3) / $close) * (TS_ZSCORE($high - $low, 60) - TS_ZSCORE(TS_MEAN($volume, 5), 60)))\" # Your output factor expression will be filled in here\n    name = \"Liquidity_Gap_ZScore_Momentum\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies exhaustion by multiplying the 3-day return with a liquidity gap measure. The gap is defined as the difference between the Z-score of the 5-day price range and the Z-score of the 5-day mean volume, both calculated over a 60-day lookback to isolate abnormal shocks relative to historical norms.",
      "factor_formulation": "\\text{Factor} = \\text{RANK}\\left( \\frac{\\text{DELTA}(close, 3)}{close} \\times (\\text{TS_ZSCORE}(high - low, 60) - \\text{TS_ZSCORE}(\\text{TS_MEAN}(volume, 5), 60)) \\right)",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Price-Efficiency Liquidity Gap' factor identifies mean-reversion by scaling the 3-day return by the ratio of the 5-day price range to the 5-day average volume, where both components are normalized by their respective 60-day historical standard deviations to isolate abnormal shocks.\n                Concise Observation: Previous attempts failed when using raw volume or simple volume ranks (Hypotheses 9 & 10) because they didn't account for the stock-specific 'normal' volatility of both price and volume, leading to signal dilution across different liquidity regimes.\n                Concise Justification: Normalizing the 5-day price range and 5-day volume by their 60-day rolling standard deviations transforms them into 'shock' measures. By multiplying the 3-day return by the ratio of these shocks (Price Shock / Volume Shock), we amplify instances where price moves 'too much' on 'too little' relative volume, which is the core signature of a mean-reverting exhaustion point.\n                Concise Knowledge: If a short-term price move exhibits high dispersion relative to its historical volatility while volume remains low relative to its historical variability, the move is likely a liquidity-driven anomaly; such 'inefficient' moves tend to revert as liquidity providers return to the market.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day Range: (TS_MAX(high, 5) - TS_MIN(low, 5)) / close. 3. Calculate 5-day Mean Volume: TS_MEAN(volume, 5). 4. Normalize Range: Range / TS_STD(Range, 60). 5. Normalize Volume: Mean_Volume / TS_STD(volume, 60). 6. Factor = 3-day return * (Normalized Range / Normalized Volume). 7. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:29:05.127933"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.1659455397797122,
        "ICIR": 0.0492900685685951,
        "1day.excess_return_without_cost.std": 0.0045269705639401,
        "1day.excess_return_with_cost.annualized_return": -0.0029148572904758,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0001869515905261,
        "1day.excess_return_without_cost.annualized_return": 0.0444944785452162,
        "1day.excess_return_with_cost.std": 0.0045290133900393,
        "Rank IC": 0.0245431545033211,
        "IC": 0.0073086649562982,
        "1day.excess_return_without_cost.max_drawdown": -0.1199322269744926,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 0.6371034726900894,
        "1day.pa": 0.0,
        "l2.valid": 0.9963189219325592,
        "Rank ICIR": 0.172509648336834,
        "l2.train": 0.993526506050746,
        "1day.excess_return_with_cost.information_ratio": -0.0417181665540016,
        "1day.excess_return_with_cost.mean": -1.2247299539814685e-05
      },
      "feedback": {
        "observations": "The current iteration explored three variations of the 'Price-Efficiency Liquidity Gap' hypothesis, focusing on different ways to normalize price dispersion and volume shocks. While the 'Liquidity_Gap_ZScore_Momentum' and 'Normalized_Range_Volume_Shock_Ratio' attempted to refine the signal using Z-scores and price ranges, the overall performance (Annualized Return: 0.0445, IR: 0.637) failed to surpass the existing SOTA (Annualized Return: 0.0810, IR: 1.104). The IC is also slightly lower than the SOTA. The reduction in Max Drawdown (-0.1199 vs -0.1339) is a positive sign of risk control, but it comes at too high a cost to the return profile.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a liquidity-to-volatility gap identifies mean-reversion holds theoretical merit, but the current implementations might be overly complex or misaligned in timing. The 'Liquidity_Gap_ZScore_Momentum' uses a 60-day Z-score which might be too slow to capture the 'shock' nature of the signal, potentially lagging the actual mean-reversion window. Furthermore, the interaction between the 3-day return and the 5-day volume mean may be creating a mismatch in the signal's horizon.",
        "decision": false,
        "reason": "1. Shorten Windows: The current 5-day and 60-day windows may be too long for mean-reversion; shortening the 'shock' window to 2 days and the normalization window to 20 days should capture more immediate exhaustion points. 2. Simplify Normalization: Instead of Z-scores or standard deviations of standard deviations (which increase complexity and risk overfitting), a simple ratio of current volume to its moving average (V/MA(V)) provides a cleaner 'shock' signal. 3. Consistency: Aligning the return window (2-day) with the range/volume window (2-day) ensures the price action and the liquidity context are perfectly synchronized."
      }
    },
    "e08dade43e40ded6": {
      "factor_id": "e08dade43e40ded6",
      "factor_name": "Dynamic_Liquidity_Exhaustion_Index",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 6) / (TS_SUM($volume, 6) + 1e-8) + 1e-8)) * (TS_MEAN($volume, 10) / (TS_STD($volume, 10) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 6) / (TS_SUM($volume, 6) + 1e-8) + 1e-8)) * (TS_MEAN($volume, 10) / (TS_STD($volume, 10) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"Dynamic_Liquidity_Exhaustion_Index\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor identifies mean-reversion by scaling a 3-day return by the ratio of the 5-day price range to the 5-day VWAP, adjusted by volume stability. It uses a product of range and volume consistency to flag price moves that lack structural support. To avoid duplication, VWAP is calculated over 6 days and the price range is normalized by the current close.",
      "factor_formulation": "\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\frac{\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5)}{\\text{TS_SUM}(\\text{close} \\times \\text{volume}, 6) / \\text{TS_SUM}(\\text{volume}, 6)} \\times \\frac{\\text{TS_MEAN}(\\text{volume}, 10)}{\\text{TS_STD}(\\text{volume}, 10)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Dynamic Liquidity-Price Divergence' factor identifies mean-reversion by scaling the 3-day return by the ratio of the 5-day True Range to the 5-day volume-weighted average price (VWAP), further adjusted by a 10-day volume stability index to isolate low-conviction price spikes.\n                Concise Observation: Previous attempts failed when using long-term (60-day) normalization or complex Z-scores (Hypothesis 10), but the SOTA (Hypothesis 4) succeeded by using a simple range-to-VWAP ratio, suggesting that the alpha lies in the immediate price-liquidity mismatch rather than historical shocks.\n                Concise Justification: Using the True Range instead of the High-Low range captures overnight gaps that often signal the start of a liquidity-driven exhaustion. Normalizing this by VWAP provides a measure of price 'efficiency'how much price moved per unit of liquiditywhile the volume stability index (1/TS_STD(volume, 10)) filters for erratic volume spikes that might otherwise mask true exhaustion.\n                Concise Knowledge: If a short-term price move occurs with high intraday dispersion relative to its volume-weighted cost basis, it indicates a liquidity vacuum; when this divergence is coupled with low volume stability, the move is likely an unsustainable noise-driven event prone to immediate reversal.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day True Range: TS_MAX(high, 5) - TS_MIN(low, 5). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Calculate 10-day Volume Stability: 1 / (TS_STD(volume, 10) / TS_MEAN(volume, 10)). 5. Factor = 3-day return * (True Range / VWAP) * Volume Stability. 6. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:37:34.596397"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.117679024951905,
        "ICIR": 0.0513758045146914,
        "1day.excess_return_without_cost.std": 0.0046802988372611,
        "1day.excess_return_with_cost.annualized_return": 0.0253048705907779,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003054755185515,
        "1day.excess_return_without_cost.annualized_return": 0.0727031734152619,
        "1day.excess_return_with_cost.std": 0.0046834168511114,
        "Rank IC": 0.0237469161796872,
        "IC": 0.0075906998832137,
        "1day.excess_return_without_cost.max_drawdown": -0.089735198095011,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.006911510578022,
        "1day.pa": 0.0,
        "l2.valid": 0.9962370502109515,
        "Rank ICIR": 0.1627587713244397,
        "l2.train": 0.9937673915281444,
        "1day.excess_return_with_cost.information_ratio": 0.3502295837077859,
        "1day.excess_return_with_cost.mean": 0.0001063229856755
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Dynamic Liquidity-Price Divergence' hypothesis. The results show that while the current iteration achieved a significantly better Max Drawdown (-0.0897 vs -0.1339), it slightly underperformed the SOTA in terms of Information Ratio (1.0069 vs 1.1038), Annualized Return (0.0727 vs 0.0810), and IC (0.0076 vs 0.0079). The 'Log_Liquidity_Efficiency_Reversal' and 'VWAP_Divergence_Stability_Factor' attempted to refine the volume stability component, but the slight drop in IC suggests that the linear combination of price range and volume stability might be losing some predictive signal compared to the SOTA implementation.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a range-to-VWAP ratio and volume stability identifies mean-reversion is supported, as all metrics remain positive and robust. The reduction in Max Drawdown suggests that the 'Volume Stability Index' (Mean/Std) is indeed effective at filtering out high-risk, low-conviction price moves. However, the logarithmic transformation in the third factor may have over-dampened the signal, leading to the slight decay in IR and Annualized Return compared to the SOTA.",
        "decision": false,
        "reason": "The current results show excellent risk control (low drawdown) but a slight loss in alpha (lower IC/Return). By using a Relative Range (normalized by ATR), we can better account for varying volatility regimes. Furthermore, the current Volume Stability Index (Mean/Std) is a static window measure; using a ratio of volume to its EMA (Volume Force) might provide a more dynamic 'shock' detection to identify the exact moment of exhaustion more accurately than a 10-day stability window."
      }
    },
    "aa1658b1ee0e7b94": {
      "factor_id": "aa1658b1ee0e7b94",
      "factor_name": "VWAP_Divergence_Stability_Factor",
      "factor_expression": "RANK(($close / DELAY($close, 3) - 1) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 4) / (TS_SUM($volume, 4) + 1e-8) + 1e-8)) * (TS_MEAN($volume, 10) / (TS_STD($volume, 10) + 1e-8)))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(($close / DELAY($close, 3) - 1) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 4) / (TS_SUM($volume, 4) + 1e-8) + 1e-8)) * (TS_MEAN($volume, 10) / (TS_STD($volume, 10) + 1e-8)))\" # Your output factor expression will be filled in here\n    name = \"VWAP_Divergence_Stability_Factor\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor captures liquidity-driven exhaustion by multiplying the 3-day price momentum with the ratio of the 5-day True Range to a 4-day VWAP. It further scales the signal by the inverse of the volume coefficient of variation over 10 days to prioritize moves occurring during low-conviction/unstable volume regimes.",
      "factor_formulation": "\\text{RANK}((\\frac{\\text{close}}{\\text{delay}(\\text{close}, 3)} - 1) \\times \\frac{\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5)}{\\text{TS_SUM}(\\text{close} \\times \\text{volume}, 4) / \\text{TS_SUM}(\\text{volume}, 4)} \\times \\frac{\\text{TS_MEAN}(\\text{volume}, 10)}{\\text{TS_STD}(\\text{volume}, 10)})",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Dynamic Liquidity-Price Divergence' factor identifies mean-reversion by scaling the 3-day return by the ratio of the 5-day True Range to the 5-day volume-weighted average price (VWAP), further adjusted by a 10-day volume stability index to isolate low-conviction price spikes.\n                Concise Observation: Previous attempts failed when using long-term (60-day) normalization or complex Z-scores (Hypothesis 10), but the SOTA (Hypothesis 4) succeeded by using a simple range-to-VWAP ratio, suggesting that the alpha lies in the immediate price-liquidity mismatch rather than historical shocks.\n                Concise Justification: Using the True Range instead of the High-Low range captures overnight gaps that often signal the start of a liquidity-driven exhaustion. Normalizing this by VWAP provides a measure of price 'efficiency'how much price moved per unit of liquiditywhile the volume stability index (1/TS_STD(volume, 10)) filters for erratic volume spikes that might otherwise mask true exhaustion.\n                Concise Knowledge: If a short-term price move occurs with high intraday dispersion relative to its volume-weighted cost basis, it indicates a liquidity vacuum; when this divergence is coupled with low volume stability, the move is likely an unsustainable noise-driven event prone to immediate reversal.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day True Range: TS_MAX(high, 5) - TS_MIN(low, 5). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Calculate 10-day Volume Stability: 1 / (TS_STD(volume, 10) / TS_MEAN(volume, 10)). 5. Factor = 3-day return * (True Range / VWAP) * Volume Stability. 6. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:37:34.596397"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.117679024951905,
        "ICIR": 0.0513758045146914,
        "1day.excess_return_without_cost.std": 0.0046802988372611,
        "1day.excess_return_with_cost.annualized_return": 0.0253048705907779,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003054755185515,
        "1day.excess_return_without_cost.annualized_return": 0.0727031734152619,
        "1day.excess_return_with_cost.std": 0.0046834168511114,
        "Rank IC": 0.0237469161796872,
        "IC": 0.0075906998832137,
        "1day.excess_return_without_cost.max_drawdown": -0.089735198095011,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.006911510578022,
        "1day.pa": 0.0,
        "l2.valid": 0.9962370502109515,
        "Rank ICIR": 0.1627587713244397,
        "l2.train": 0.9937673915281444,
        "1day.excess_return_with_cost.information_ratio": 0.3502295837077859,
        "1day.excess_return_with_cost.mean": 0.0001063229856755
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Dynamic Liquidity-Price Divergence' hypothesis. The results show that while the current iteration achieved a significantly better Max Drawdown (-0.0897 vs -0.1339), it slightly underperformed the SOTA in terms of Information Ratio (1.0069 vs 1.1038), Annualized Return (0.0727 vs 0.0810), and IC (0.0076 vs 0.0079). The 'Log_Liquidity_Efficiency_Reversal' and 'VWAP_Divergence_Stability_Factor' attempted to refine the volume stability component, but the slight drop in IC suggests that the linear combination of price range and volume stability might be losing some predictive signal compared to the SOTA implementation.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a range-to-VWAP ratio and volume stability identifies mean-reversion is supported, as all metrics remain positive and robust. The reduction in Max Drawdown suggests that the 'Volume Stability Index' (Mean/Std) is indeed effective at filtering out high-risk, low-conviction price moves. However, the logarithmic transformation in the third factor may have over-dampened the signal, leading to the slight decay in IR and Annualized Return compared to the SOTA.",
        "decision": false,
        "reason": "The current results show excellent risk control (low drawdown) but a slight loss in alpha (lower IC/Return). By using a Relative Range (normalized by ATR), we can better account for varying volatility regimes. Furthermore, the current Volume Stability Index (Mean/Std) is a static window measure; using a ratio of volume to its EMA (Volume Force) might provide a more dynamic 'shock' detection to identify the exact moment of exhaustion more accurately than a 10-day stability window."
      }
    },
    "51eef12c5c1c5035": {
      "factor_id": "51eef12c5c1c5035",
      "factor_name": "Log_Liquidity_Efficiency_Reversal",
      "factor_expression": "RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 7) / (TS_SUM($volume, 7) + 1e-8) + 1e-8)) * LOG(TS_MEAN($volume, 10) / (TS_STD($volume, 10) + 1e-8) + 1.01))",
      "factor_implementation_code": "File: factor.py\n\nimport pandas as pd\nimport numpy as np\nimport os\nfrom alphaagent.components.coder.factor_coder.expr_parser import parse_expression, parse_symbol\nfrom alphaagent.components.coder.factor_coder.function_lib import *\n\n\ndef calculate_factor(expr: str, name: str):\n    # stock dataframe\n    df = pd.read_hdf('./daily_pv.h5', key='data')\n    \n    expr = parse_symbol(expr, df.columns)\n    expr = parse_expression(expr)\n\n    # replace '$var' by 'df['var'] to extract var's actual values\n    for col in df.columns:\n        expr = expr.replace(col[1:], f\"df[\\'{col}\\']\")\n\n    df[name] = eval(expr)\n    result = df[name].astype(np.float64)\n\n    if os.path.exists('result.h5'):\n        os.remove('result.h5')\n    result.to_hdf('result.h5', key='data')\n\nif __name__ == '__main__':\n    # Input factor expression. Do NOT use the variable format like \"df['$xxx']\" in factor expressions. Instead, you should use \"$xxx\". \n    expr = \"RANK(TS_PCTCHANGE($close, 3) * ((TS_MAX($high, 5) - TS_MIN($low, 5)) / (TS_SUM($close * $volume, 7) / (TS_SUM($volume, 7) + 1e-8) + 1e-8)) * LOG(TS_MEAN($volume, 10) / (TS_STD($volume, 10) + 1e-8) + 1.01))\" # Your output factor expression will be filled in here\n    name = \"Log_Liquidity_Efficiency_Reversal\" # Your output factor name will be filled in here\n    calculate_factor(expr, name)\n",
      "factor_description": "This factor uses a logarithmic transformation of the volume stability index to dampen extreme volume outliers while identifying price-liquidity mismatches. It scales the 3-day return by the price range relative to a 7-day VWAP to capture exhaustion points where price efficiency drops.",
      "factor_formulation": "\\text{RANK}(\\text{TS_PCTCHANGE}(\\text{close}, 3) \\times \\frac{\\text{TS_MAX}(\\text{high}, 5) - \\text{TS_MIN}(\\text{low}, 5)}{\\text{TS_SUM}(\\text{close} \\times \\text{volume}, 7) / \\text{TS_SUM}(\\text{volume}, 7)} \\times \\text{LOG}(\\text{TS_MEAN}(\\text{volume}, 10) / (\\text{TS_STD}(\\text{volume}, 10) + 1e-8) + 1))",
      "metadata": {
        "experiment_id": "2026-01-19_13-07-39-005671",
        "round_number": 0,
        "evolution_phase": "original",
        "trajectory_id": "",
        "parent_trajectory_ids": [],
        "hypothesis": "Hypothesis: The 'Dynamic Liquidity-Price Divergence' factor identifies mean-reversion by scaling the 3-day return by the ratio of the 5-day True Range to the 5-day volume-weighted average price (VWAP), further adjusted by a 10-day volume stability index to isolate low-conviction price spikes.\n                Concise Observation: Previous attempts failed when using long-term (60-day) normalization or complex Z-scores (Hypothesis 10), but the SOTA (Hypothesis 4) succeeded by using a simple range-to-VWAP ratio, suggesting that the alpha lies in the immediate price-liquidity mismatch rather than historical shocks.\n                Concise Justification: Using the True Range instead of the High-Low range captures overnight gaps that often signal the start of a liquidity-driven exhaustion. Normalizing this by VWAP provides a measure of price 'efficiency'how much price moved per unit of liquiditywhile the volume stability index (1/TS_STD(volume, 10)) filters for erratic volume spikes that might otherwise mask true exhaustion.\n                Concise Knowledge: If a short-term price move occurs with high intraday dispersion relative to its volume-weighted cost basis, it indicates a liquidity vacuum; when this divergence is coupled with low volume stability, the move is likely an unsustainable noise-driven event prone to immediate reversal.\n                concise Specification: 1. Calculate 3-day return: (close / delay(close, 3) - 1). 2. Calculate 5-day True Range: TS_MAX(high, 5) - TS_MIN(low, 5). 3. Calculate 5-day VWAP: TS_SUM(close * volume, 5) / TS_SUM(volume, 5). 4. Calculate 10-day Volume Stability: 1 / (TS_STD(volume, 10) / TS_MEAN(volume, 10)). 5. Factor = 3-day return * (True Range / VWAP) * Volume Stability. 6. Apply CS_RANK.\n                ",
        "initial_direction": "description:",
        "planning_direction": "description:",
        "created_at": "2026-01-19T22:37:34.596397"
      },
      "backtest_results": {
        "1day.excess_return_with_cost.max_drawdown": -0.117679024951905,
        "ICIR": 0.0513758045146914,
        "1day.excess_return_without_cost.std": 0.0046802988372611,
        "1day.excess_return_with_cost.annualized_return": 0.0253048705907779,
        "1day.ffr": 1.0,
        "1day.excess_return_without_cost.mean": 0.0003054755185515,
        "1day.excess_return_without_cost.annualized_return": 0.0727031734152619,
        "1day.excess_return_with_cost.std": 0.0046834168511114,
        "Rank IC": 0.0237469161796872,
        "IC": 0.0075906998832137,
        "1day.excess_return_without_cost.max_drawdown": -0.089735198095011,
        "1day.pos": 0.0,
        "1day.excess_return_without_cost.information_ratio": 1.006911510578022,
        "1day.pa": 0.0,
        "l2.valid": 0.9962370502109515,
        "Rank ICIR": 0.1627587713244397,
        "l2.train": 0.9937673915281444,
        "1day.excess_return_with_cost.information_ratio": 0.3502295837077859,
        "1day.excess_return_with_cost.mean": 0.0001063229856755
      },
      "feedback": {
        "observations": "The experiment tested three variations of the 'Dynamic Liquidity-Price Divergence' hypothesis. The results show that while the current iteration achieved a significantly better Max Drawdown (-0.0897 vs -0.1339), it slightly underperformed the SOTA in terms of Information Ratio (1.0069 vs 1.1038), Annualized Return (0.0727 vs 0.0810), and IC (0.0076 vs 0.0079). The 'Log_Liquidity_Efficiency_Reversal' and 'VWAP_Divergence_Stability_Factor' attempted to refine the volume stability component, but the slight drop in IC suggests that the linear combination of price range and volume stability might be losing some predictive signal compared to the SOTA implementation.",
        "hypothesis_evaluation": "The hypothesis that scaling returns by a range-to-VWAP ratio and volume stability identifies mean-reversion is supported, as all metrics remain positive and robust. The reduction in Max Drawdown suggests that the 'Volume Stability Index' (Mean/Std) is indeed effective at filtering out high-risk, low-conviction price moves. However, the logarithmic transformation in the third factor may have over-dampened the signal, leading to the slight decay in IR and Annualized Return compared to the SOTA.",
        "decision": false,
        "reason": "The current results show excellent risk control (low drawdown) but a slight loss in alpha (lower IC/Return). By using a Relative Range (normalized by ATR), we can better account for varying volatility regimes. Furthermore, the current Volume Stability Index (Mean/Std) is a static window measure; using a ratio of volume to its EMA (Volume Force) might provide a more dynamic 'shock' detection to identify the exact moment of exhaustion more accurately than a 10-day stability window."
      }
    }
  }
}